{"ast":null,"code":"import _objectSpread from\"D:\\\\PROJEKTY\\\\APKI\\\\dj-truck\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"D:\\\\PROJEKTY\\\\APKI\\\\dj-truck\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"D:\\\\PROJEKTY\\\\APKI\\\\dj-truck\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"D:\\\\PROJEKTY\\\\APKI\\\\dj-truck\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"D:\\\\PROJEKTY\\\\APKI\\\\dj-truck\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";import _inherits from\"D:\\\\PROJEKTY\\\\APKI\\\\dj-truck\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";// Spec \n// witout any option Knob is standard with value from 0 to 100 and on inti value is 0\n// -initValue:number allow to set init value\n// -showValue props allows to display numeric value on knob\n// -diplayFormula : a callbac function with will be used to show value on knob\n// -scale:number allow to scale value eg. 10 give range from 0 to 10 \n// -symetric:boolean if this props is present knob havse valeu from -100 to 100 * scale \n// -unsymetric:{negative:number, positive:number} allows to set unsymetric range value : \n//  {positive : 5 } means that values bigger than 0 are divided by 5 range is from -100 to 20 * scale\n// -quantize:number switch knob to quantize mode in witch returned values are quantize to parametr \n//       eg: 2 returns value 100, 98 , 96 ... quantize:0.05 returns values 100, 99.95.... \n// -qunatize:{negative:number, positive:number} allows to set diffrent qunatizes for negative and positives values.\n// -responseFactor if is present adjust knob response on a mouse move // default= 1 eg responseFactor 2 will increase response two times\n// -alt if is present when mouse is over and knob is not draggin it will display alt value \nimport React from\"react\";import style from\"./knob.scss\";var Knob=/*#__PURE__*/function(_React$PureComponent){_inherits(Knob,_React$PureComponent);function Knob(){var _this;_classCallCheck(this,Knob);_this=_possibleConstructorReturn(this,_getPrototypeOf(Knob).call(this));_this.state={value:0,position:0,snapShotPostion:0,idDragged:false,isMouseOver:false};_this.html={bigCircle:React.createRef(),leftHalf:React.createRef(),rightHalf:React.createRef(),value:React.createRef(),smallCircle:React.createRef(),dot:React.createRef()};return _this;}_createClass(Knob,[{key:\"snap\",value:function snap(){this.setState(_objectSpread({},this.state,{snapShotPostion:this.state.position}));}},{key:\"normalizePostion\",value:function normalizePostion(position){if(this.props.symetric||this.props.unsymetric){return Math.min(Math.max(position,-100),100);}return Math.min(Math.max(position,0),100);}},{key:\"quantizePosition\",value:function quantizePosition(position){if(!this.props.quantize)return position;// value is quantaized \nreturn this.valueToPosition(this.evalValue(position));}},{key:\"valueToPosition\",value:function valueToPosition(value){var position=value;if(this.props.scale){position=value*100/this.props.scale;}if(this.props.unsymetric){if(this.props.unsymetric.positive&&value>0){var scale=this.props.unsymetric.positive;position=position*scale;}if(this.props.unsymetric.negative&&value<0){var _scale=this.props.unsymetric.negative;position=position*_scale;}}return position;}},{key:\"evalValue\",value:function evalValue(position){var value=position;if(this.props.scale){value=this.props.scale*position/100;}if(this.props.unsymetric){if(this.props.unsymetric.positive&&position>0){var scale=this.props.unsymetric.positive;value=value/scale;}if(this.props.unsymetric.negative&&position<0){var _scale2=this.props.unsymetric.negative;value=value/_scale2;}}if(this.props.quantize){var factor;if(typeof this.props.quantize===\"object\"){if(this.props.quantize.positive&&value>=0){factor=this.props.quantize.positive;}if(this.props.quantize.negative&&value<0){factor=this.props.quantize.negative;}}else if(typeof this.props.quantize===\"number\"){factor=this.props.quantize;}var rest=value%factor;value=value-rest;}//rounding \nreturn Math.floor(value*1000000)/1000000;}},{key:\"setPostion\",value:function setPostion(position){var _this2=this;position=this.normalizePostion(position);var value=this.evalValue(position);this.setState(_objectSpread({},this.state,{position:position,value:value}),function(){_this2.mapPostionToArms(_this2.state.position);});this.props.onChange&&this.props.onChange(this.state.value);}},{key:\"mapPostionToArms\",value:function mapPostionToArms(position){var rightArm,leftArm,dotAngle;var reversArm=false;position=this.quantizePosition(position);if(this.props.symetric||this.props.unsymetric){rightArm=88;leftArm=92;dotAngle=position*1.4;if(position<-2){rightArm=90-Math.abs(position)*1.5;leftArm=90;}else if(position>2){rightArm=90;leftArm=90+position*1.5;}}else{rightArm=-60;leftArm=-60;dotAngle=-150+position*2.95;leftArm+=position*3;if(position>60){reversArm=true;leftArm=-240+(position-60)*3;rightArm=-240;}}this.updateStyle({rightArm:rightArm,leftArm:leftArm,dotAngle:dotAngle,reversArm:reversArm});this.updateValue();}},{key:\"updateValue\",value:function updateValue(){var value=\"\";if(this.isMouseOver&&!this.state.isDragged&&this.props.alt){value=this.props.alt.substr(0,4).toUpperCase();}else{if(this.props.showValue){value=this.evalValue(this.state.position);}if(this.props.displayFormula){value=this.props.displayFormula(value);}}this.html.value.current.textContent=value.toString().substr(0,6);}},{key:\"updateStyle\",value:function updateStyle(_ref){var rightArm=_ref.rightArm,leftArm=_ref.leftArm,dotAngle=_ref.dotAngle,reversArm=_ref.reversArm;this.html.bigCircle.current.style.backgroundImage=\"linear-gradient(\"+(180+leftArm)+\"deg, \"+style.primaryDark+\" 50%, transparent 50%),\\n             linear-gradient(\"+(180+rightArm)+\"deg, transparent 50%, \"+style.primaryDark+\" 50%)\";this.html.rightHalf.current.style.transform=\"rotate(\"+leftArm+\"deg)\";this.html.leftHalf.current.style.transform=\"rotate(\"+rightArm+\"deg)\";if(reversArm){this.html.leftHalf.current.classList.add(\"half--reverse\");}else{this.html.leftHalf.current.classList.remove(\"half--reverse\");}this.html.dot.current.style.transform='rotate('+dotAngle+'deg)';}},{key:\"setActive\",value:function setActive(value){if(value){this.html.value.current.classList.add(\"knob--focus\");this.html.bigCircle.current.classList.add(\"big-circle--focus\");}else{this.html.value.current.classList.remove(\"knob--focus\");this.html.bigCircle.current.classList.remove(\"big-circle--focus\");}}// -------------- events below\n},{key:\"mouseDown\",value:function mouseDown(event){var _this3=this;var startY=event.clientY;var mouseMove=this.mouseMove.bind(this,startY);this.snap();var removeListener=function removeListener(){document.body.removeEventListener('mousemove',mouseMove);document.body.removeEventListener('mouseup',removeListener);document.body.removeEventListener('mouseleave',removeListener);_this3.setState(_objectSpread({},_this3.setState,{isDragged:false}),function(){if(!_this3.state.isDragged&&!_this3.isMouseOver){_this3.setActive(false);}});};document.body.addEventListener('mousemove',mouseMove);document.body.addEventListener('mouseup',removeListener);document.body.addEventListener('mouseleave',removeListener);this.setState(_objectSpread({},this.setState,{isDragged:true}));this.setActive(true);}},{key:\"mouseMove\",value:function mouseMove(startY,event){event.stopPropagation();var responsFactor=this.props.responsFactor||1;var position=this.state.snapShotPostion-(event.clientY-startY)*responsFactor;this.setPostion(position);}},{key:\"mouseEnter\",value:function mouseEnter(){this.isMouseOver=true;if(this.state.isDragged||this.isMouseOver){this.setActive(true);}}},{key:\"mouseLeve\",value:function mouseLeve(){this.isMouseOver=false;if(!this.state.isDragged&&!this.isMouseOver){this.setActive(false);}}},{key:\"mouseDoubelClick\",value:function mouseDoubelClick(){var _this4=this;if(this.props.dobuleClickInit){var value=this.props.initValue||0;var position=this.valueToPosition(value);this.setState(_objectSpread({},this.state,{value:value}),function(){_this4.setPostion(position);});}}//----------------compontent metod\n},{key:\"componentDidMount\",value:function componentDidMount(){var _this5=this;var position=this.state.position;if(this.props.initValue){position=this.valueToPosition(this.props.initValue);}this.setState(_objectSpread({},this.state,{position:position}),function(){_this5.mapPostionToArms(position);});}},{key:\"componentDidUpdate\",value:function componentDidUpdate(oldProps){if(this.props.value!==oldProps.value){var postion=this.valueToPosition(this.props.value);this.setPostion(postion);}}},{key:\"render\",value:function render(){return React.createElement(\"div\",{className:\"knob \"+this.props.className,onMouseDown:this.mouseDown.bind(this),onDragStart:function onDragStart(e){return e.preventDefault();},onDoubleClick:this.mouseDoubelClick.bind(this),onMouseEnter:this.mouseEnter.bind(this),onMouseLeave:this.mouseLeve.bind(this)},React.createElement(\"div\",{className:\"knob-big-circle\",ref:this.html.bigCircle},React.createElement(\"div\",{ref:this.html.rightHalf,className:\"half-circle half-right\"}),React.createElement(\"div\",{ref:this.html.leftHalf,className:\"half-circle half-left \"}),this.props.showValue&&React.createElement(\"div\",{ref:this.html.value,className:\"knob-value \"+(this.props.showValue===\"always\"?\"knob--focus\":\"\")})),React.createElement(\"div\",{ref:this.html.smallCircle,className:\"knob-small-circle \"}),React.createElement(\"div\",{ref:this.html.dot,className:\"knob-dot\"}));}}]);return Knob;}(React.PureComponent);export default Knob;","map":{"version":3,"sources":["D:/PROJEKTY/APKI/dj-truck/src/pages/console/components/common/Knob/Knob.js"],"names":["React","style","Knob","state","value","position","snapShotPostion","idDragged","isMouseOver","html","bigCircle","createRef","leftHalf","rightHalf","smallCircle","dot","setState","props","symetric","unsymetric","Math","min","max","quantize","valueToPosition","evalValue","scale","positive","negative","factor","rest","floor","normalizePostion","mapPostionToArms","onChange","rightArm","leftArm","dotAngle","reversArm","quantizePosition","abs","updateStyle","updateValue","isDragged","alt","substr","toUpperCase","showValue","displayFormula","current","textContent","toString","backgroundImage","primaryDark","transform","classList","add","remove","event","startY","clientY","mouseMove","bind","snap","removeListener","document","body","removeEventListener","setActive","addEventListener","stopPropagation","responsFactor","setPostion","dobuleClickInit","initValue","oldProps","postion","className","mouseDown","e","preventDefault","mouseDoubelClick","mouseEnter","mouseLeve","PureComponent"],"mappings":"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","sourcesContent":["\r\n\r\n// Spec \r\n// witout any option Knob is standard with value from 0 to 100 and on inti value is 0\r\n// -initValue:number allow to set init value\r\n// -showValue props allows to display numeric value on knob\r\n// -diplayFormula : a callbac function with will be used to show value on knob\r\n// -scale:number allow to scale value eg. 10 give range from 0 to 10 \r\n// -symetric:boolean if this props is present knob havse valeu from -100 to 100 * scale \r\n// -unsymetric:{negative:number, positive:number} allows to set unsymetric range value : \r\n//  {positive : 5 } means that values bigger than 0 are divided by 5 range is from -100 to 20 * scale\r\n// -quantize:number switch knob to quantize mode in witch returned values are quantize to parametr \r\n//       eg: 2 returns value 100, 98 , 96 ... quantize:0.05 returns values 100, 99.95.... \r\n// -qunatize:{negative:number, positive:number} allows to set diffrent qunatizes for negative and positives values.\r\n// -responseFactor if is present adjust knob response on a mouse move // default= 1 eg responseFactor 2 will increase response two times\r\n// -alt if is present when mouse is over and knob is not draggin it will display alt value \r\n\r\nimport React from \"react\";\r\nimport style from \"./knob.scss\";\r\n\r\n\r\nclass Knob extends React.PureComponent{\r\n\r\n    constructor(){\r\n        super();\r\n        this.html = {\r\n            bigCircle : React.createRef(),\r\n            leftHalf : React.createRef(),\r\n            rightHalf : React.createRef(),\r\n            value : React.createRef(),\r\n            smallCircle : React.createRef(),\r\n            dot : React.createRef()\r\n        }\r\n    }\r\n\r\n    state = {\r\n        value: 0,\r\n        position: 0, \r\n        snapShotPostion: 0,\r\n\r\n        idDragged: false,\r\n        isMouseOver: false,\r\n    }\r\n\r\n    snap(){\r\n        this.setState({...this.state, snapShotPostion: this.state.position})\r\n    }\r\n\r\n    normalizePostion(position){\r\n        if(this.props.symetric || this.props.unsymetric){\r\n            return Math.min(Math.max(position, -100), 100)\r\n        } \r\n        return Math.min(Math.max(position, 0), 100)\r\n    }\r\n\r\n    quantizePosition(position){\r\n        if(!this.props.quantize) \r\n            return position;\r\n\r\n         // value is quantaized \r\n         return this.valueToPosition(this.evalValue(position));\r\n\r\n    }\r\n\r\n    valueToPosition(value){\r\n        let position = value;\r\n        if(this.props.scale){\r\n            position = value * 100 / this.props.scale;\r\n        }\r\n\r\n        if(this.props.unsymetric){\r\n            if(this.props.unsymetric.positive && value > 0 ){\r\n                let scale = this.props.unsymetric.positive;\r\n                position = position * scale;\r\n            } \r\n            if(this.props.unsymetric.negative &&  value < 0){\r\n                let scale = this.props.unsymetric.negative;\r\n                position = position * scale;\r\n            }\r\n        }\r\n        return position;\r\n    }\r\n\r\n    evalValue(position){\r\n        let value = position;\r\n        \r\n        if(this.props.scale){\r\n            value = this.props.scale * position / 100 ;\r\n        } \r\n        \r\n        if(this.props.unsymetric){\r\n            if(this.props.unsymetric.positive && position > 0 ){\r\n                let scale = this.props.unsymetric.positive;\r\n                value = value / scale;\r\n            } \r\n            if(this.props.unsymetric.negative && position < 0){\r\n                let scale = this.props.unsymetric.negative;\r\n                value = value / scale;\r\n            }\r\n        }\r\n\r\n        if(this.props.quantize){\r\n            let factor; \r\n            if(typeof this.props.quantize === \"object\"){\r\n                if(this.props.quantize.positive && value >= 0 ){\r\n                    factor = this.props.quantize.positive;\r\n                } if(this.props.quantize.negative && value < 0){\r\n                    factor = this.props.quantize.negative;\r\n                }\r\n            } else if (typeof this.props.quantize === \"number\") {\r\n                factor = this.props.quantize;\r\n            }\r\n            const rest = value % factor;\r\n            value = value - rest;\r\n        }\r\n\r\n        //rounding \r\n        return Math.floor(value * 1000000) / 1000000;\r\n    }\r\n\r\n    setPostion(position){\r\n        position =  this.normalizePostion(position);\r\n        const value = this.evalValue(position);\r\n\r\n        this.setState({...this.state, position, value}, ()=>{\r\n            this.mapPostionToArms(this.state.position)\r\n        });\r\n\r\n        (this.props.onChange && this.props.onChange(this.state.value))\r\n    }\r\n\r\n    mapPostionToArms(position){\r\n        let rightArm, leftArm, dotAngle;\r\n        let reversArm = false;\r\n        position = this.quantizePosition(position); \r\n\r\n        if(this.props.symetric || this.props.unsymetric){\r\n            rightArm = 88;\r\n            leftArm = 92; \r\n            dotAngle = position  * 1.4 ;     \r\n            \r\n            if(position < -2 ) {\r\n                rightArm = 90 - Math.abs(position) * 1.5;\r\n                leftArm = 90;\r\n            } else if(position > 2 ){\r\n                rightArm = 90;\r\n                leftArm = 90 + position * 1.5;\r\n            }\r\n        } else {\r\n            rightArm = -60;\r\n            leftArm = -60; \r\n            dotAngle = -150 + position * 2.95;\r\n            leftArm += position * 3;\r\n            if(position > 60) {\r\n                reversArm = true;\r\n                leftArm =  -240 + (position - 60) * 3;\r\n                rightArm =  -240 ;\r\n            }\r\n        }\r\n        this.updateStyle({rightArm, leftArm, dotAngle, reversArm});\r\n        this.updateValue();\r\n    }\r\n\r\n    updateValue(){\r\n        let value = \"\"\r\n        if(this.isMouseOver && !this.state.isDragged && this.props.alt){\r\n            value = this.props.alt.substr(0,4).toUpperCase();\r\n        } else {\r\n            if(this.props.showValue){\r\n                value = this.evalValue(this.state.position)\r\n            }\r\n            if(this.props.displayFormula){\r\n                value = this.props.displayFormula(value);\r\n            }\r\n        }\r\n\r\n        this.html.value.current.textContent = value.toString().substr(0,6);\r\n    }\r\n\r\n    updateStyle({rightArm, leftArm, dotAngle, reversArm}){\r\n        this.html.bigCircle.current.style.backgroundImage = \r\n            `linear-gradient(`+ (180 + leftArm)  +`deg, `+style.primaryDark+` 50%, transparent 50%),\r\n             linear-gradient(`+ (180 + rightArm) +`deg, transparent 50%, `+style.primaryDark+` 50%)`;\r\n\r\n        this.html.rightHalf.current.style.transform = `rotate(`+ leftArm +`deg)`;\r\n        this.html.leftHalf.current.style.transform = `rotate(`+ rightArm +`deg)`;\r\n        if(reversArm){\r\n            this.html.leftHalf.current.classList.add(\"half--reverse\")\r\n        } else {\r\n            this.html.leftHalf.current.classList.remove(\"half--reverse\")\r\n        }\r\n\r\n        this.html.dot.current.style.transform= 'rotate('+ dotAngle + 'deg)';\r\n    }\r\n\r\n    setActive(value){\r\n        if(value){\r\n            this.html.value.current.classList.add(\"knob--focus\")\r\n            this.html.bigCircle.current.classList.add(\"big-circle--focus\");\r\n        }else {\r\n            this.html.value.current.classList.remove(\"knob--focus\");\r\n            this.html.bigCircle.current.classList.remove(\"big-circle--focus\");\r\n        }\r\n    }\r\n\r\n    // -------------- events below\r\n\r\n    mouseDown(event){\r\n\r\n        const startY = event.clientY;\r\n        let mouseMove = this.mouseMove.bind(this, startY);\r\n        this.snap();\r\n\r\n        const removeListener = () =>{\r\n            document.body.removeEventListener('mousemove', mouseMove);\r\n            document.body.removeEventListener('mouseup', removeListener);\r\n            document.body.removeEventListener('mouseleave', removeListener);\r\n            this.setState({...this.setState, isDragged: false}, ()=>{\r\n                if(!this.state.isDragged &&  !this.isMouseOver){\r\n                    this.setActive(false);\r\n                }\r\n            })\r\n            \r\n        }\r\n\r\n        document.body.addEventListener('mousemove', mouseMove)\r\n        document.body.addEventListener('mouseup', removeListener);\r\n        document.body.addEventListener('mouseleave', removeListener);\r\n        this.setState({...this.setState, isDragged: true})\r\n        this.setActive(true);\r\n    }\r\n\r\n    mouseMove(startY, event){\r\n        event.stopPropagation();\r\n        let responsFactor = this.props.responsFactor || 1;\r\n        let position = this.state.snapShotPostion - (event.clientY  - startY) * responsFactor;\r\n        this.setPostion(position);\r\n    }\r\n\r\n    mouseEnter(){\r\n        this.isMouseOver = true;\r\n        if(this.state.isDragged ||  this.isMouseOver){\r\n            this.setActive(true);\r\n        }\r\n    }\r\n\r\n    mouseLeve(){\r\n        this.isMouseOver = false;\r\n        if(!this.state.isDragged &&  !this.isMouseOver){\r\n            this.setActive(false)\r\n        }\r\n    }\r\n\r\n    mouseDoubelClick(){\r\n        if(this.props.dobuleClickInit){\r\n            const value = this.props.initValue || 0;\r\n            const position = this.valueToPosition(value);\r\n            this.setState({...this.state, value : value}, ()=>{\r\n                this.setPostion(position)\r\n            })\r\n        }\r\n    }\r\n\r\n    //----------------compontent metod\r\n    componentDidMount(){\r\n        let position = this.state.position;\r\n        if(this.props.initValue){\r\n            position = this.valueToPosition(this.props.initValue)\r\n        }\r\n\r\n        this.setState({...this.state, position : position}, ()=>{\r\n            this.mapPostionToArms(position);\r\n        })\r\n    }\r\n\r\n    componentDidUpdate(oldProps){\r\n        if(this.props.value !== oldProps.value){\r\n            const postion = this.valueToPosition(this.props.value);\r\n            this.setPostion(postion);\r\n        }\r\n    }\r\n\r\n\r\n    render(){\r\n\r\n        return (\r\n            <div \r\n                className={\"knob \" + this.props.className} \r\n                onMouseDown={this.mouseDown.bind(this)}\r\n                onDragStart={ e => e.preventDefault()}\r\n                onDoubleClick={this.mouseDoubelClick.bind(this)}\r\n                onMouseEnter={ this.mouseEnter.bind(this)}\r\n                onMouseLeave={ this.mouseLeve.bind(this)}\r\n                >\r\n                <div \r\n                    className=\"knob-big-circle\"\r\n                    ref={this.html.bigCircle}>\r\n                    <div \r\n                        ref = {this.html.rightHalf}\r\n                        className=\"half-circle half-right\"\r\n                        />\r\n                    <div \r\n                        ref = {this.html.leftHalf} \r\n                        className=\"half-circle half-left \"\r\n                       />\r\n                    {( this.props.showValue && \r\n                        <div\r\n                            ref={this.html.value} \r\n                            className={\"knob-value \" + ((this.props.showValue === \"always\") ? \"knob--focus\" : \"\")}\r\n                           >\r\n                        </div>\r\n                    )}\r\n                </div>\r\n                <div \r\n                    ref={this.html.smallCircle}\r\n                    className={\"knob-small-circle \"}\r\n       \r\n                    />\r\n                <div \r\n                    ref={this.html.dot}\r\n                    className=\"knob-dot\"\r\n                  />\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default Knob;"]},"metadata":{},"sourceType":"module"}