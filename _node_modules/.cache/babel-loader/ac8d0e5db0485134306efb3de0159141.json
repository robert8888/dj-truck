{"ast":null,"code":"var _jsxFileName = \"D:\\\\PROJEKTY\\\\APKI\\\\dj-truck\\\\src\\\\pages\\\\userRecords\\\\UserRecords.js\";\nimport React, { useEffect, useContext, useState, useRef, useCallback } from \"react\";\nimport { connect } from \"react-redux\";\nimport { reqRecOfUser } from \"./../../actions\";\nimport RecordsList from \"./../common/components/RecordList/RecordList\";\nimport { useRecordPlayer } from \"./../common/Hooks/useRecordPlayer\";\nimport PlayerControls from \"./../common/components/PlayerControls/PlayerControls\";\nimport LayoutContext from \"./../common/Layout/LayoutContext\";\nimport Pagin from \"./../common/components/Pagin/Pagin\";\nimport { DropdownButton, Dropdown } from \"react-bootstrap\";\nimport { useParams, useHistory, useLocation } from \"react-router-dom\";\nimport queryString from \"querystring\";\nimport \"./user-records.scss\";\n\nconst UserRecords = ({\n  requestList,\n  userId,\n  recordsList,\n  countAll\n}) => {\n  const [controls, player] = useRecordPlayer(); //-------------------------\n\n  const history = useHistory();\n  let {\n    pageSize,\n    page\n  } = queryString.parse(useLocation()); //let { pageSize, page } = useParams();\n\n  const [_pageSize, setPageSize] = useState(20);\n  const [_page, setPage] = useState(0);\n  const timeoutRef = useRef();\n  useEffect(() => {\n    console.log(search);\n\n    if (!userId) {\n      timeoutRef.current = setTimeout(() => {\n        history.replace(\"/\");\n      }, 3000);\n      return;\n    }\n\n    if (userId) {\n      clearTimeout(timeoutRef.current);\n    }\n\n    if (!pageSize && !page) {\n      requestList(userId, _pageSize, 0);\n      return;\n    }\n\n    if (pageSize && !page) {\n      requestList(userId, _pageSize, pageSize);\n      return;\n    }\n\n    if (pageSize && page) {\n      requestList(userId, pageSize, page);\n      setPageSize(pageSize);\n      setPage(page);\n    }\n  }, [userId, requestList, _pageSize, history, page, pageSize]);\n  const layoutContext = useContext(LayoutContext);\n  useEffect(() => {\n    layoutContext.setFooter(false);\n  }, [layoutContext]);\n  const changeTo = useCallback(pageSize => {\n    if (!userId) {\n      return;\n    }\n\n    history.push('/my/records?pageSize=' + pageSize + \"&page=\" + _page);\n    requestList(userId, pageSize, _page);\n  }, [history, _page, userId, requestList]);\n  const goTo = useCallback(page => {\n    if (!userId) {\n      return;\n    }\n\n    history.push('/my/records?pageSize=' + _pageSize + \"&page=\" + page);\n  }, [history, userId, _pageSize]);\n  return React.createElement(\"div\", {\n    className: \"user-records\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"user-records-top-bar\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78\n    },\n    __self: this\n  }, React.createElement(\"h2\", {\n    className: \"title\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79\n    },\n    __self: this\n  }, \"Your records\"), React.createElement(DropdownButton, {\n    alignRight: true,\n    className: \"btn-pagger\",\n    title: _pageSize + \" on page \",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80\n    },\n    __self: this\n  }, React.createElement(Dropdown.Item, {\n    onClick: changeTo.bind(null, 10),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84\n    },\n    __self: this\n  }, \" 10 \"), React.createElement(Dropdown.Item, {\n    onClick: changeTo.bind(null, 20),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85\n    },\n    __self: this\n  }, \" 20 \"), React.createElement(Dropdown.Item, {\n    onClick: changeTo.bind(null, 30),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86\n    },\n    __self: this\n  }, \" 30 \"), React.createElement(Dropdown.Item, {\n    onClick: changeTo.bind(null, 50),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87\n    },\n    __self: this\n  }, \" 50 \"), React.createElement(Dropdown.Item, {\n    onClick: changeTo.bind(null, 75),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88\n    },\n    __self: this\n  }, \" 75 \"), React.createElement(Dropdown.Item, {\n    onClick: changeTo.bind(null, 100),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89\n    },\n    __self: this\n  }, \" 100 \"))), React.createElement(RecordsList, {\n    list: recordsList,\n    controls: controls,\n    player: player,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93\n    },\n    __self: this\n  }), React.createElement(Pagin, {\n    current: _page,\n    call: goTo,\n    all: Math.floor(countAll / _pageSize) - 1,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97\n    },\n    __self: this\n  }), React.createElement(PlayerControls, {\n    list: recordsList,\n    controls: controls,\n    player: player,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101\n    },\n    __self: this\n  }));\n};\n\nconst mapStateToProps = state => ({\n  recordsList: state.records.list,\n  countAll: state.records.countAll,\n  userId: state.user.dbId\n});\n\nconst mapDispatchToProps = dispatch => ({\n  requestList: (userId, pageSize, page) => dispatch(reqRecOfUser(userId, pageSize, page))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(UserRecords);","map":{"version":3,"sources":["D:/PROJEKTY/APKI/dj-truck/src/pages/userRecords/UserRecords.js"],"names":["React","useEffect","useContext","useState","useRef","useCallback","connect","reqRecOfUser","RecordsList","useRecordPlayer","PlayerControls","LayoutContext","Pagin","DropdownButton","Dropdown","useParams","useHistory","useLocation","queryString","UserRecords","requestList","userId","recordsList","countAll","controls","player","history","pageSize","page","parse","_pageSize","setPageSize","_page","setPage","timeoutRef","console","log","search","current","setTimeout","replace","clearTimeout","layoutContext","setFooter","changeTo","push","goTo","bind","Math","floor","mapStateToProps","state","records","list","user","dbId","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React, { useEffect, useContext, useState, useRef, useCallback } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { reqRecOfUser } from \"./../../actions\"\r\nimport RecordsList from \"./../common/components/RecordList/RecordList\";\r\nimport { useRecordPlayer } from \"./../common/Hooks/useRecordPlayer\";\r\nimport PlayerControls from \"./../common/components/PlayerControls/PlayerControls\";\r\nimport LayoutContext from \"./../common/Layout/LayoutContext\";\r\nimport Pagin from \"./../common/components/Pagin/Pagin\";\r\nimport { DropdownButton, Dropdown } from \"react-bootstrap\";\r\nimport { useParams, useHistory , useLocation} from \"react-router-dom\";\r\nimport queryString from \"querystring\";\r\nimport \"./user-records.scss\"\r\n\r\nconst UserRecords = ({ requestList, userId, recordsList, countAll }) => {\r\n    const [controls, player] = useRecordPlayer();\r\n    //-------------------------\r\n    const history = useHistory();\r\n    let {pageSize, page } = queryString.parse(useLocation())\r\n    //let { pageSize, page } = useParams();\r\n    const [_pageSize, setPageSize] = useState(20);\r\n    const [_page, setPage] = useState(0);\r\n\r\n    const timeoutRef = useRef();\r\n\r\n    useEffect(() => {\r\n        console.log(search)\r\n        if(!userId){\r\n            timeoutRef.current = setTimeout(()=>{\r\n                history.replace(\"/\")\r\n            }, 3000)\r\n            \r\n            return;\r\n        }\r\n        if(userId){\r\n            clearTimeout(timeoutRef.current);\r\n        }\r\n        if(!pageSize && !page){\r\n            requestList(userId, _pageSize, 0);\r\n            return;\r\n        }\r\n        if(pageSize && !page){\r\n            requestList(userId, _pageSize, pageSize);\r\n            return;\r\n        } \r\n\r\n        if(pageSize && page){\r\n            requestList(userId, pageSize, page);\r\n            setPageSize(pageSize);\r\n            setPage(page)\r\n        }\r\n\r\n\r\n    }, [userId, requestList, _pageSize, history, page, pageSize])\r\n\r\n    const layoutContext = useContext(LayoutContext);\r\n\r\n    useEffect(() => {\r\n        layoutContext.setFooter(false);\r\n    }, [layoutContext])\r\n\r\n    const changeTo = useCallback((pageSize)=>{\r\n        if(!userId){\r\n            return;\r\n        }\r\n        history.push('/my/records?pageSize=' + pageSize + \"&page=\" + _page);\r\n        requestList(userId, pageSize, _page);\r\n    }, [history, _page, userId, requestList])\r\n\r\n    const goTo = useCallback((page) => {\r\n        if(!userId){\r\n            return;\r\n        }\r\n        history.push('/my/records?pageSize=' + _pageSize + \"&page=\" + page);\r\n    }, [history, userId, _pageSize])\r\n\r\n    return (\r\n        <div className=\"user-records\">\r\n            <div className=\"user-records-top-bar\">\r\n                <h2 className=\"title\">Your records</h2>\r\n                <DropdownButton\r\n                    alignRight\r\n                    className=\"btn-pagger\"\r\n                    title={_pageSize + \" on page \"}>\r\n                    <Dropdown.Item onClick={changeTo.bind(null, 10)}> 10 </Dropdown.Item>\r\n                    <Dropdown.Item onClick={changeTo.bind(null, 20)}> 20 </Dropdown.Item>\r\n                    <Dropdown.Item onClick={changeTo.bind(null, 30)}> 30 </Dropdown.Item>\r\n                    <Dropdown.Item onClick={changeTo.bind(null, 50)}> 50 </Dropdown.Item>\r\n                    <Dropdown.Item onClick={changeTo.bind(null, 75)}> 75 </Dropdown.Item>\r\n                    <Dropdown.Item onClick={changeTo.bind(null, 100)}> 100 </Dropdown.Item>\r\n                </DropdownButton>\r\n            </div>\r\n\r\n            <RecordsList\r\n                list={recordsList}\r\n                controls={controls}\r\n                player={player} />\r\n            <Pagin\r\n                current={_page}\r\n                call={goTo}\r\n                all={Math.floor(countAll / _pageSize) - 1}/>\r\n            <PlayerControls\r\n                list={recordsList}\r\n                controls={controls}\r\n                player={player} />\r\n        </div>\r\n    )\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n    recordsList: state.records.list,\r\n    countAll: state.records.countAll,\r\n    userId: state.user.dbId,\r\n})\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n    requestList: (userId, pageSize, page) => dispatch(reqRecOfUser(userId, pageSize, page))\r\n})\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(UserRecords)\r\n"]},"metadata":{},"sourceType":"module"}