{"ast":null,"code":"import _slicedToArray from\"D:\\\\PROJEKTY\\\\APKI\\\\dj-truck\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useCallback,useEffect,useMemo,useRef,useState}from\"react\";import{Button,Form}from\"react-bootstrap\";import{connect}from\"react-redux\";import{useHistory}from\"react-router-dom\";import useAutoHeightTextarea from\"../../Hooks/useAutoHeightTextarea\";import{reqDeleteRec,reqUpdateRec,setRecDeleteStatus}from\"./../../../../actions\";import{getApi}from\"./.././../../../apis/apiProvider\";import IconBar from\"./../IconBar/IconBar\";import ErrorBoundary from\"./../ErrorBoundary/ErrorBoundary\";import\"./record-details.scss\";var RecordDetails=function RecordDetails(_ref){var record=_ref.record,userId=_ref.userId,requestUpdate=_ref.requestUpdate,requestDelete=_ref.requestDelete,deleteStatus=_ref.deleteStatus,resetDeleteStatus=_ref.resetDeleteStatus;var getDownloadLink=useMemo(function(){return getApi('RecordsStore').getDownloadLink;},[]);var history=useHistory();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),editMode=_useState2[0],setEditMode=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),editable=_useState4[0],setEditable=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),userNickname=_useState6[0],setUserNickname=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),title=_useState8[0],setTitle=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),description=_useState10[0],setDescription=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),genres=_useState12[0],setGenres=_useState12[1];var descriptionTextArea=useRef();var _useAutoHeightTextare=useAutoHeightTextarea(),_useAutoHeightTextare2=_slicedToArray(_useAutoHeightTextare,1),autoResizeTextArea=_useAutoHeightTextare2[0];var setFromRecord=useCallback(function(record){if(record.user.id===userId){setEditable(true);}setUserNickname(record.user.nickname||\"\");setTitle(record.title||\"\");setDescription(record.description||\"\");setGenres(record.genres.map(function(genre){return genre.name;}).join(\", \")||[]);},[userId,setEditable,setTitle,setDescription,setGenres,setUserNickname]);useEffect(function(){if(!record)return;setFromRecord(record);},[record,setFromRecord]);var toggleMode=useCallback(function(){var mode=!editMode;setEditMode(mode);if(!mode){setFromRecord(record);}},[record,editMode,setEditMode,setFromRecord]);var updateTitle=useCallback(function(event){if(event.target.value.indexOf(\"_\")!==-1){event.target.setCustomValidity(\"Using underscore in sets name is \\n                not allowed. You can use eg \\\"-\\\". Pleas change name of your record\");}else{event.target.setCustomValidity('');}setTitle(event.target.value);},[setTitle]);var updateDescription=useCallback(function(event){setDescription(event.target.value);},[setDescription]);var updateGenres=useCallback(function(event){setGenres(event.target.value);},[setGenres]);var updateRecordDetails=useCallback(function(event){event.preventDefault();var title=event.target.elements.title.value;var description=event.target.elements.description.value;var genres=event.target.elements.genres.value||\"\";var genresArr=genres.split(\",\").filter(function(str){return str!==\"\";}).map(function(str){return str.trim().toLowerCase();});requestUpdate(record.id,{title:title,description:description,genres:genresArr});setEditMode(false);},[record,setEditMode,requestUpdate]);var deleteCurrent=useCallback(function(){requestDelete(record.id);},[record,requestDelete]);var downloadCurrent=useCallback(function(){var a=document.createElement('a');a.href=getDownloadLink(record===null||record===void 0?void 0:record.id,record===null||record===void 0?void 0:record.title);a.setAttribute('download',record===null||record===void 0?void 0:record.title);a.click();},[record,getDownloadLink]);useEffect(function(){if(deleteStatus===\"SUCCESS\"){history.goBack();resetDeleteStatus();}},[deleteStatus,resetDeleteStatus,history]);return React.createElement(ErrorBoundary,null,React.createElement(Form,{className:\"record-details\",onSubmit:updateRecordDetails},editable&&React.createElement(IconBar,{className:\"record-details-icons\",items:{edit:toggleMode,download:downloadCurrent,delete:deleteCurrent}}),React.createElement(Form.Group,{className:\"record-title\"},React.createElement(Form.Label,null,\"User: \"),React.createElement(Form.Control,{name:\"user\",type:\"text\",value:userNickname,disabled:true})),React.createElement(Form.Group,{className:\"record-title\"},React.createElement(Form.Label,null,\"Title: \"),React.createElement(Form.Control,{name:\"title\",type:\"text\",value:title,onChange:updateTitle,disabled:!editMode})),React.createElement(Form.Group,{className:\"record-description\"},React.createElement(Form.Label,null,\"Description: \"),React.createElement(Form.Control,{name:\"description\",as:\"textarea\",ref:function ref(_ref2){return descriptionTextArea.current=autoResizeTextArea(_ref2);},value:description,onChange:updateDescription,disabled:!editMode})),React.createElement(Form.Group,{className:\"genre-list\"},React.createElement(Form.Label,null,\"Genres: \"),React.createElement(Form.Control,{type:\"text\",name:\"genres\",value:genres,onChange:updateGenres,pattern:\"^(?:[A-Za-z&]{1,25}(?:,\\\\s*)?)+$\",disabled:!editMode})),editMode&&React.createElement(Button,{type:\"submit\"},\" Save \")));};var mapStateToProps=function mapStateToProps(state){return{userId:state.user.dbId,deleteStatus:state.records.deleteStatus};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{requestUpdate:function requestUpdate(recordId,dataChanges){return dispatch(reqUpdateRec(recordId,dataChanges));},requestDelete:function requestDelete(recordId){return dispatch(reqDeleteRec(recordId));},resetDeleteStatus:function resetDeleteStatus(){return dispatch(setRecDeleteStatus(\"IDLE\"));}};};export default connect(mapStateToProps,mapDispatchToProps)(RecordDetails);","map":{"version":3,"sources":["D:/PROJEKTY/APKI/dj-truck/src/pages/common/components/RecordDetails/RecordDetails.js"],"names":["React","useCallback","useEffect","useMemo","useRef","useState","Button","Form","connect","useHistory","useAutoHeightTextarea","reqDeleteRec","reqUpdateRec","setRecDeleteStatus","getApi","IconBar","ErrorBoundary","RecordDetails","record","userId","requestUpdate","requestDelete","deleteStatus","resetDeleteStatus","getDownloadLink","history","editMode","setEditMode","editable","setEditable","userNickname","setUserNickname","title","setTitle","description","setDescription","genres","setGenres","descriptionTextArea","autoResizeTextArea","setFromRecord","user","id","nickname","map","genre","name","join","toggleMode","mode","updateTitle","event","target","value","indexOf","setCustomValidity","updateDescription","updateGenres","updateRecordDetails","preventDefault","elements","genresArr","split","filter","str","trim","toLowerCase","deleteCurrent","downloadCurrent","a","document","createElement","href","setAttribute","click","goBack","edit","download","delete","ref","current","mapStateToProps","state","dbId","records","mapDispatchToProps","dispatch","recordId","dataChanges"],"mappings":"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","sourcesContent":["import React, { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\r\nimport { Button, Form } from \"react-bootstrap\";\r\nimport { connect } from \"react-redux\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport useAutoHeightTextarea from \"../../Hooks/useAutoHeightTextarea\";\r\nimport { reqDeleteRec, reqUpdateRec, setRecDeleteStatus } from \"./../../../../actions\";\r\nimport { getApi } from \"./.././../../../apis/apiProvider\";\r\nimport IconBar from \"./../IconBar/IconBar\";\r\nimport ErrorBoundary from \"./../ErrorBoundary/ErrorBoundary\"\r\nimport \"./record-details.scss\";\r\n\r\nconst RecordDetails = ({ record, userId, requestUpdate, requestDelete, deleteStatus, resetDeleteStatus }) => {\r\n    const getDownloadLink = useMemo(() => getApi('RecordsStore').getDownloadLink, [])\r\n    const history = useHistory();\r\n    const [editMode, setEditMode] = useState(false);\r\n    const [editable, setEditable] = useState(false);\r\n\r\n    const [userNickname, setUserNickname] = useState(\"\")\r\n    const [title, setTitle] = useState(\"\");\r\n    const [description, setDescription] = useState(\"\");\r\n    const [genres, setGenres] = useState([]);\r\n\r\n    const descriptionTextArea = useRef();\r\n    const [autoResizeTextArea] = useAutoHeightTextarea();\r\n\r\n\r\n    const setFromRecord = useCallback((record) => {\r\n        if (record.user.id === userId) {\r\n            setEditable(true);\r\n        }\r\n        setUserNickname(record.user.nickname || \"\");\r\n        setTitle(record.title || \"\")\r\n        setDescription(record.description || \"\")\r\n        setGenres(record.genres.map(genre => genre.name).join(\", \") || []);\r\n    }, [userId,\r\n        setEditable,\r\n        setTitle,\r\n        setDescription,\r\n        setGenres,\r\n        setUserNickname])\r\n\r\n    useEffect(() => {\r\n        if (!record) return;\r\n        setFromRecord(record)\r\n    }, [record, setFromRecord])\r\n\r\n\r\n    const toggleMode = useCallback(() => {\r\n        const mode = !editMode;\r\n        setEditMode(mode)\r\n        if (!mode) {\r\n            setFromRecord(record)\r\n        }\r\n\r\n    }, [record, editMode, setEditMode, setFromRecord])\r\n\r\n    const updateTitle = useCallback((event) => {\r\n        if (event.target.value.indexOf(\"_\") !== -1) {\r\n            event.target.setCustomValidity(`Using underscore in sets name is \r\n                not allowed. You can use eg \"-\". Pleas change name of your record`)\r\n        } else {\r\n            event.target.setCustomValidity('')\r\n        }\r\n        setTitle(event.target.value);\r\n    }, [setTitle])\r\n\r\n    const updateDescription = useCallback(event => {\r\n\r\n        setDescription(event.target.value)\r\n    }, [setDescription])\r\n\r\n\r\n    const updateGenres = useCallback(event => {\r\n        setGenres(event.target.value)\r\n    }, [setGenres])\r\n\r\n    const updateRecordDetails = useCallback(event => {\r\n        event.preventDefault();\r\n        const title = event.target.elements.title.value;\r\n        const description = event.target.elements.description.value;\r\n        const genres = event.target.elements.genres.value || \"\";\r\n        const genresArr = genres.split(\",\").filter(str => str !== \"\").map(str => str.trim().toLowerCase());\r\n        requestUpdate(record.id, {\r\n            title,\r\n            description,\r\n            genres: genresArr\r\n        })\r\n        setEditMode(false)\r\n    }, [record, setEditMode, requestUpdate])\r\n\r\n    const deleteCurrent = useCallback(() => {\r\n        requestDelete(record.id);\r\n    }, [record, requestDelete])\r\n\r\n    const downloadCurrent = useCallback(() => {\r\n        const a = document.createElement('a');\r\n        a.href = getDownloadLink(record?.id, record?.title);\r\n        a.setAttribute('download', record?.title);\r\n        a.click();\r\n    }, [record, getDownloadLink])\r\n\r\n    useEffect(() => {\r\n        if (deleteStatus === \"SUCCESS\") {\r\n            history.goBack();\r\n            resetDeleteStatus();\r\n        }\r\n    }, [deleteStatus, resetDeleteStatus, history])\r\n\r\n    return (\r\n        <ErrorBoundary>\r\n            <Form className=\"record-details\" onSubmit={updateRecordDetails}>\r\n                {editable && <IconBar className=\"record-details-icons\" items={{\r\n                    edit: toggleMode,\r\n                    download: downloadCurrent,\r\n                    delete: deleteCurrent,\r\n\r\n                }} />}\r\n                <Form.Group className=\"record-title\">\r\n                    <Form.Label>User: </Form.Label>\r\n                    <Form.Control name=\"user\" type=\"text\" value={userNickname} disabled />\r\n                </Form.Group>\r\n\r\n                <Form.Group className=\"record-title\">\r\n                    <Form.Label>Title: </Form.Label>\r\n                    <Form.Control\r\n                        name=\"title\"\r\n                        type=\"text\"\r\n                        value={title}\r\n                        onChange={updateTitle}\r\n                        disabled={!editMode} />\r\n                </Form.Group>\r\n                <Form.Group className=\"record-description\">\r\n                    <Form.Label>Description: </Form.Label>\r\n                    <Form.Control\r\n                        name=\"description\"\r\n                        as=\"textarea\"\r\n                        ref={ref => descriptionTextArea.current = autoResizeTextArea(ref)}\r\n                        value={description}\r\n                        onChange={updateDescription}\r\n                        disabled={!editMode} />\r\n                </Form.Group>\r\n                <Form.Group className=\"genre-list\">\r\n                    <Form.Label>Genres: </Form.Label>\r\n                    <Form.Control\r\n                        type=\"text\"\r\n                        name=\"genres\"\r\n                        value={genres}\r\n                        onChange={updateGenres}\r\n                        pattern=\"^(?:[A-Za-z&]{1,25}(?:,\\s*)?)+$\"\r\n                        disabled={!editMode} />\r\n                </Form.Group>\r\n                {editMode && <Button type=\"submit\"> Save </Button>}\r\n            </Form>\r\n        </ErrorBoundary>\r\n    )\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n    userId: state.user.dbId,\r\n    deleteStatus: state.records.deleteStatus,\r\n})\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n    requestUpdate: (recordId, dataChanges) => dispatch(reqUpdateRec(recordId, dataChanges)),\r\n    requestDelete: (recordId) => dispatch(reqDeleteRec(recordId)),\r\n    resetDeleteStatus: () => dispatch(setRecDeleteStatus(\"IDLE\")),\r\n})\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(RecordDetails)"]},"metadata":{},"sourceType":"module"}