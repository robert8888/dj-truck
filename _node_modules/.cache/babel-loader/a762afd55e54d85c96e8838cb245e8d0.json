{"ast":null,"code":"var _jsxFileName = \"D:\\\\PROJEKTY\\\\APKI\\\\DjTruck\\\\djtruck\\\\src\\\\components\\\\Deck\\\\PitchSlider\\\\Slider\\\\Slider.js\";\nimport React from \"react\";\nimport \"./slider.scss\";\n\nclass Slider extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      sliderRange: null,\n      sliderCurrnetPosition: null,\n      sliderPrevPosition: null,\n      isDragged: false,\n      thumbHeight: 0,\n      sliderAreaTopOffset: 0\n    };\n\n    this.evalValue = () => {\n      const {\n        from,\n        to,\n        range\n      } = Slider.getRange(this.props.from, this.props.to);\n      const progress = (this.state.sliderCurrnetPosition - this.state.thumbHeight / 2) / this.state.sliderRange;\n      let value = range * progress + from;\n\n      if (this.props.quantize !== undefined) {\n        console.log(this.state.sliderCurrnetPosition);\n        const rest = value % this.props.quantize;\n        return value === from || value === to ? value : value - rest;\n      }\n\n      return value;\n    };\n\n    this.setValue = value => {\n      const {\n        from,\n        range\n      } = Slider.getRange(this.props.from, this.props.to);\n      const progress = (value - from) / range;\n      const position = progress * this.state.sliderRange;\n      this.setPosition(position + this.state.thumbHeight / 2);\n    };\n\n    this.setPosition = (currentPosition, prevPosition) => {\n      this.setState({ ...this.state,\n        sliderCurrnetPosition: currentPosition,\n        sliderPrevPosition: prevPosition || this.state.sliderPrevPosition\n      }, () => {\n        if (this.props.onChange) {\n          console.log(\"sending change\", this.evalValue());\n          this.props.onChange(this.evalValue());\n          console.log(\"and value is\", this.props.value);\n        }\n      });\n    };\n\n    this.mouseDownHandle = event => {\n      if (event.target === this.sliderAreaElement.current || event.target === this.sliderRangeElement.current) {\n        //temporary\n        let clickY = event.clientY - this.sliderAreaElement.current.getBoundingClientRect().top;\n        let prevPosition = this.state.currentPosition;\n\n        if (this.state.sliderCurrnetPositionFromProps !== this.state.currentPosition) {\n          prevPosition = this.state.sliderCurrnetPositionFromProps;\n        }\n\n        this.setPosition(clickY, prevPosition);\n      } else // dragging \n        if (event.target === this.sliderThumbElement.current) {\n          this.setState({ ...this.state,\n            isDragged: true\n          });\n          const shiftY = event.clientY - this.sliderThumbElement.current.getBoundingClientRect().top;\n          document.addEventListener('mousemove', e => this.mouseMoveHandler.call(this, e, shiftY));\n          document.addEventListener('dragstart', e => e.preventDefault());\n        }\n\n      document.addEventListener('mouseup', this.mouseUpHandler);\n      document.addEventListener('dragend', this.mouseUpHandler);\n    };\n\n    this.mouseUpHandler = event => {\n      if (this.state.isDragged) {\n        this.setState({ ...this.state,\n          isDragged: false\n        });\n      } else {\n        this.setPosition(this.state.sliderPrevPosition);\n      }\n\n      document.removeEventListener('mousemove', this.mouseMoveHandler.bind(this));\n      document.removeEventListener('mouseup', this.mouseUpHandler);\n      document.removeEventListener('dragend', this.mouseUpHandler);\n    };\n\n    this.mouseMoveHandler = (event, shiftY) => {\n      if (!this.state.isDragged) return;\n      let position = event.clientY - this.state.sliderAreaTopOffset - shiftY + this.state.thumbHeight / 2;\n      position = Math.min(Math.max(position, this.state.thumbHeight / 2), this.state.sliderRange + this.state.thumbHeight / 2);\n      this.setPosition(position);\n    };\n\n    this.sliderRangeElement = React.createRef();\n    this.sliderThumbElement = React.createRef();\n    this.sliderAreaElement = React.createRef();\n  }\n\n  static getDerivedStateFromProps(props, state) {\n    const getPostion = value => {\n      const {\n        from,\n        range\n      } = Slider.getRange(props.from, props.to);\n      const progress = (value - from) / range;\n      const position = progress * state.sliderRange;\n      return position + state.thumbHeight / 2;\n    };\n\n    if (props.value > props.to || props.value < props.from) {\n      return null;\n    }\n\n    let currentPosition = getPostion(props.value);\n    return { ...state,\n      sliderCurrnetPositionFromProps: currentPosition\n    };\n  }\n\n  componentDidMount() {\n    const thumbHeight = this.sliderThumbElement.current.getBoundingClientRect().height;\n    const topOffset = this.sliderAreaElement.current.getBoundingClientRect().top;\n    const top = parseInt(window.getComputedStyle(this.sliderThumbElement.current).top);\n    const range = parseInt(window.getComputedStyle(this.sliderRangeElement.current).height);\n    this.setState(state => {\n      const _state = { ...state\n      };\n      _state.sliderCurrnetPosition = top;\n      _state.sliderRange = range;\n      _state.thumbHeight = thumbHeight;\n      _state.sliderAreaTopOffset = topOffset;\n      return _state;\n    }, () => {\n      if (this.props.value !== undefined) {\n        this.setValue(this.props.value);\n      }\n    });\n    this.sliderAreaElement.current.addEventListener('mousedown', this.mouseDownHandle.bind(this));\n  }\n\n  shouldComponentUpdate(nextProps) {\n    return nextProps.value !== this.props.value;\n  }\n\n  render() {\n    let currentPosition = this.state.sliderCurrnetPosition;\n\n    if (this.state.sliderCurrnetPositionFromProps !== currentPosition) {\n      currentPosition = this.state.sliderCurrnetPositionFromProps;\n    }\n\n    return React.createElement(\"div\", {\n      className: \"slider\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      ref: this.sliderAreaElement,\n      className: \"slider-area\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      ref: this.sliderRangeElement,\n      className: \"slider-range\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"slider-thumb\",\n      ref: this.sliderThumbElement,\n      style: (this.state.sliderCurrnetPosition !== null || this.state.sliderCurrnetPosition !== undefined) && {\n        top: currentPosition\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169\n      },\n      __self: this\n    })));\n  }\n\n}\n\nSlider.getRange = (from, to) => {\n  return {\n    from,\n    to,\n    range: from * to < 0 ? Math.abs(to) + Math.abs(from) : to - from\n  };\n};\n\nexport default Slider;","map":{"version":3,"sources":["D:/PROJEKTY/APKI/DjTruck/djtruck/src/components/Deck/PitchSlider/Slider/Slider.js"],"names":["React","Slider","Component","constructor","state","sliderRange","sliderCurrnetPosition","sliderPrevPosition","isDragged","thumbHeight","sliderAreaTopOffset","evalValue","from","to","range","getRange","props","progress","value","quantize","undefined","console","log","rest","setValue","position","setPosition","currentPosition","prevPosition","setState","onChange","mouseDownHandle","event","target","sliderAreaElement","current","sliderRangeElement","clickY","clientY","getBoundingClientRect","top","sliderCurrnetPositionFromProps","sliderThumbElement","shiftY","document","addEventListener","e","mouseMoveHandler","call","preventDefault","mouseUpHandler","removeEventListener","bind","Math","min","max","createRef","getDerivedStateFromProps","getPostion","componentDidMount","height","topOffset","parseInt","window","getComputedStyle","_state","shouldComponentUpdate","nextProps","render","abs"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport \"./slider.scss\";\r\n\r\nclass Slider extends React.Component{\r\n    constructor() {\r\n        super();\r\n\r\n        this.sliderRangeElement = React.createRef();\r\n        this.sliderThumbElement = React.createRef();\r\n        this.sliderAreaElement = React.createRef();\r\n    }\r\n\r\n        state = {\r\n        sliderRange: null,\r\n        sliderCurrnetPosition: null,\r\n        sliderPrevPosition: null,\r\n        isDragged : false,\r\n\r\n        thumbHeight: 0,\r\n        sliderAreaTopOffset : 0,\r\n    }\r\n\r\n    static getRange = (from , to) => {\r\n        return{\r\n            from,\r\n            to,\r\n            range : (from * to < 0) ?  Math.abs(to) + Math.abs(from) : to - from,\r\n        }\r\n    }\r\n\r\n    static getDerivedStateFromProps(props, state) {\r\n        const getPostion = (value) => {\r\n            const { from , range } = Slider.getRange(props.from, props.to);\r\n            const progress = (value - from)/ range;  \r\n            const position = progress * (state.sliderRange);\r\n            return (position + state.thumbHeight / 2 )\r\n        }\r\n\r\n        if(props.value > props.to || props.value < props.from){\r\n            return null;\r\n        }\r\n\r\n        let currentPosition = getPostion(props.value);\r\n        return {\r\n            ...state,\r\n            sliderCurrnetPositionFromProps: currentPosition,\r\n        }\r\n    }\r\n\r\n\r\n\r\n    evalValue = () => {\r\n        const {from , to,  range} = Slider.getRange(this.props.from, this.props.to);\r\n        const progress = (this.state.sliderCurrnetPosition - this.state.thumbHeight / 2)\r\n                         / this.state.sliderRange;\r\n\r\n        let value =  range * progress + from;\r\n        if(this.props.quantize !== undefined){\r\n            console.log(this.state.sliderCurrnetPosition)\r\n            const rest = value % this.props.quantize;\r\n            return  (value === from || value === to) ? value : value - rest;\r\n        } \r\n        return value;\r\n    }\r\n\r\n    setValue = (value) => {\r\n        const { from , range } = Slider.getRange(this.props.from, this.props.to);\r\n        const progress = (value - from)/ range;  \r\n        const position = progress * (this.state.sliderRange);\r\n        this.setPosition(position + this.state.thumbHeight / 2 )\r\n    }\r\n\r\n    setPosition = (currentPosition, prevPosition) => {\r\n\r\n        this.setState({...this.state, \r\n            sliderCurrnetPosition : currentPosition,\r\n            sliderPrevPosition : prevPosition || this.state.sliderPrevPosition,\r\n        }, ()=>{\r\n            if(this.props.onChange){\r\n                console.log(\"sending change\", this.evalValue())\r\n                this.props.onChange(this.evalValue());\r\n                console.log(\"and value is\", this.props.value)\r\n            }\r\n        });\r\n        \r\n    }\r\n\r\n    mouseDownHandle = (event) =>{\r\n        if(event.target === this.sliderAreaElement.current || event.target === this.sliderRangeElement.current){ //temporary\r\n            let clickY = event.clientY - this.sliderAreaElement.current.getBoundingClientRect().top;\r\n            let prevPosition = this.state.currentPosition;\r\n            if (this.state.sliderCurrnetPositionFromProps !== this.state.currentPosition){\r\n                prevPosition = this.state.sliderCurrnetPositionFromProps;\r\n            } \r\n            this.setPosition(clickY, prevPosition);\r\n        } else // dragging \r\n            if(event.target === this.sliderThumbElement.current){ \r\n            this.setState({...this.state, isDragged: true});\r\n            const shiftY = event.clientY - this.sliderThumbElement.current.getBoundingClientRect().top;\r\n            document.addEventListener('mousemove', e =>  this.mouseMoveHandler.call(this, e, shiftY))\r\n            document.addEventListener('dragstart', e => e.preventDefault())\r\n        }\r\n        document.addEventListener('mouseup', this.mouseUpHandler);\r\n        document.addEventListener('dragend', this.mouseUpHandler);\r\n    }\r\n\r\n    mouseUpHandler = event => {\r\n        if(this.state.isDragged){\r\n            this.setState({...this.state, isDragged: false});\r\n        } else {\r\n            this.setPosition(this.state.sliderPrevPosition);\r\n        }\r\n\r\n        document.removeEventListener('mousemove', this.mouseMoveHandler.bind(this));\r\n        document.removeEventListener('mouseup', this.mouseUpHandler);\r\n        document.removeEventListener('dragend', this.mouseUpHandler);\r\n    }\r\n\r\n    mouseMoveHandler = (event, shiftY) =>{\r\n        if(!this.state.isDragged) return;\r\n        let position = event.clientY \r\n                        - this.state.sliderAreaTopOffset \r\n                        - shiftY \r\n                        + (this.state.thumbHeight/2);\r\n\r\n        position = Math.min( Math.max(position, this.state.thumbHeight/2), \r\n                            this.state.sliderRange + this.state.thumbHeight/2 );\r\n       \r\n        this.setPosition(position);\r\n    }\r\n\r\n    componentDidMount(){\r\n        const thumbHeight = this.sliderThumbElement.current.getBoundingClientRect().height;\r\n        const topOffset = this.sliderAreaElement.current.getBoundingClientRect().top;\r\n        const top = parseInt(window.getComputedStyle(this.sliderThumbElement.current).top) ;\r\n        const range = parseInt(window.getComputedStyle(this.sliderRangeElement.current).height)\r\n\r\n\r\n        this.setState( state => {\r\n            const _state = {...state};\r\n            _state.sliderCurrnetPosition = top;\r\n            _state.sliderRange = range;\r\n            _state.thumbHeight = thumbHeight;\r\n            _state.sliderAreaTopOffset = topOffset;\r\n            return _state;\r\n        }, () => {\r\n            if(this.props.value !== undefined){\r\n                this.setValue(this.props.value);\r\n            }\r\n        })\r\n\r\n        this.sliderAreaElement.current.addEventListener('mousedown',  this.mouseDownHandle.bind(this));\r\n    }\r\n    shouldComponentUpdate(nextProps){\r\n        return (nextProps.value !== this.props.value)\r\n    }\r\n\r\n    render() {\r\n            let currentPosition = this.state.sliderCurrnetPosition;\r\n            if(this.state.sliderCurrnetPositionFromProps !== currentPosition){\r\n                currentPosition = this.state.sliderCurrnetPositionFromProps;\r\n            }\r\n    \r\n\r\n            return (\r\n                <div className=\"slider\" >\r\n                    <div ref={this.sliderAreaElement} className=\"slider-area\">\r\n                        <div ref={this.sliderRangeElement} className=\"slider-range\"/>\r\n                        <div className=\"slider-thumb\" \r\n                             ref={this.sliderThumbElement} \r\n                             style={ (this.state.sliderCurrnetPosition !== null || this.state.sliderCurrnetPosition !== undefined)\r\n                                     && {top: currentPosition}} />\r\n                    </div>\r\n                </div>\r\n            )\r\n        }\r\n}\r\n\r\nexport default Slider;"]},"metadata":{},"sourceType":"module"}