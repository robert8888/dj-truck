{"ast":null,"code":"import { ACTIONS } from \"../actions\";\nimport { put, call, takeEvery } from 'redux-saga/effects';\nimport { getApi } from \"./../apis/apiProvider\";\nimport { calcAccurateBpmAndOffset } from './../utils/bpm/analyzer';\nimport { setBpmAndOffset } from '../actions';\nexport default function* watcher() {\n  yield takeEvery(ACTIONS.CALC_BPM, calcBpmAsync);\n  yield takeEvery(ACTIONS.PUSH_TRACK, calcBpmAsync);\n}\n\nfunction* calcBpmAsync(action) {\n  const source = action.track.source;\n  const id = action.track.sourceId;\n  const api = getApi(source);\n  const url = api.getUrl(id); // console.log(action)\n\n  yield put(setBpmAndOffset(action.track._id, action.playlist, \"calculating\", null));\n  let {\n    offset,\n    bpm\n  } = yield call(calcAccurateBpmAndOffset, url);\n  yield put(setBpmAndOffset(action.track._id, action.playlist, bpm, offset));\n}","map":{"version":3,"sources":["D:/PROJEKTY/APKI/dj-truck/src/sagas/calcBpmSaga.js"],"names":["ACTIONS","put","call","takeEvery","getApi","calcAccurateBpmAndOffset","setBpmAndOffset","watcher","CALC_BPM","calcBpmAsync","PUSH_TRACK","action","source","track","id","sourceId","api","url","getUrl","_id","playlist","offset","bpm"],"mappings":"AAAA,SAASA,OAAT,QAAwB,YAAxB;AACA,SAASC,GAAT,EAAcC,IAAd,EAAoBC,SAApB,QAAqC,oBAArC;AACA,SAASC,MAAT,QAAuB,uBAAvB;AACA,SAASC,wBAAT,QAAyC,yBAAzC;AACA,SAASC,eAAT,QAAgC,YAAhC;AAEA,eAAe,UAAUC,OAAV,GAAoB;AAC/B,QAAMJ,SAAS,CAACH,OAAO,CAACQ,QAAT,EAAmBC,YAAnB,CAAf;AACA,QAAMN,SAAS,CAACH,OAAO,CAACU,UAAT,EAAqBD,YAArB,CAAf;AACH;;AAED,UAAUA,YAAV,CAAuBE,MAAvB,EAA+B;AAC3B,QAAMC,MAAM,GAAGD,MAAM,CAACE,KAAP,CAAaD,MAA5B;AACA,QAAME,EAAE,GAAGH,MAAM,CAACE,KAAP,CAAaE,QAAxB;AAEA,QAAMC,GAAG,GAAGZ,MAAM,CAACQ,MAAD,CAAlB;AACA,QAAMK,GAAG,GAAGD,GAAG,CAACE,MAAJ,CAAWJ,EAAX,CAAZ,CAL2B,CAO3B;;AACA,QAAMb,GAAG,CAACK,eAAe,CAACK,MAAM,CAACE,KAAP,CAAaM,GAAd,EAAmBR,MAAM,CAACS,QAA1B,EAAoC,aAApC,EAAmD,IAAnD,CAAhB,CAAT;AACA,MAAI;AAAEC,IAAAA,MAAF;AAAUC,IAAAA;AAAV,MAAkB,MAAMpB,IAAI,CAACG,wBAAD,EAA2BY,GAA3B,CAAhC;AACA,QAAMhB,GAAG,CAACK,eAAe,CAACK,MAAM,CAACE,KAAP,CAAaM,GAAd,EAAmBR,MAAM,CAACS,QAA1B,EAAoCE,GAApC,EAAyCD,MAAzC,CAAhB,CAAT;AAEH","sourcesContent":["import { ACTIONS } from \"../actions\";\r\nimport { put, call, takeEvery } from 'redux-saga/effects';\r\nimport { getApi } from \"./../apis/apiProvider\";\r\nimport { calcAccurateBpmAndOffset } from './../utils/bpm/analyzer';\r\nimport { setBpmAndOffset } from '../actions';\r\n\r\nexport default function* watcher() {\r\n    yield takeEvery(ACTIONS.CALC_BPM, calcBpmAsync);\r\n    yield takeEvery(ACTIONS.PUSH_TRACK, calcBpmAsync);\r\n}\r\n\r\nfunction* calcBpmAsync(action) {\r\n    const source = action.track.source;\r\n    const id = action.track.sourceId;\r\n\r\n    const api = getApi(source);\r\n    const url = api.getUrl(id);\r\n\r\n    // console.log(action)\r\n    yield put(setBpmAndOffset(action.track._id, action.playlist, \"calculating\", null))\r\n    let { offset, bpm } = yield call(calcAccurateBpmAndOffset, url);\r\n    yield put(setBpmAndOffset(action.track._id, action.playlist, bpm, offset))\r\n\r\n}\r\n\r\n"]},"metadata":{},"sourceType":"module"}