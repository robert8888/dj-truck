{"ast":null,"code":"import _regeneratorRuntime from\"D:\\\\PROJEKTY\\\\APKI\\\\dj-truck\\\\node_modules\\\\@babel\\\\runtime/regenerator\";var _marked=/*#__PURE__*/_regeneratorRuntime.mark(requestCreateComment),_marked2=/*#__PURE__*/_regeneratorRuntime.mark(handel);import{put,select,takeEvery}from\"redux-saga/effects\";import{ACTIONS,postComment,pushLog}from\"../../../actions\";import{getApi}from\"./../../../apis/apiProvider\";import{Log}from\"./../../../utils/logger/logger\";import errorParser from\"./../../../utils/serverErrorParser/errorParser\";export default function requestCreateComment(){return _regeneratorRuntime.wrap(function requestCreateComment$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return takeEvery(ACTIONS.RECS_REQ_POST_COMMENT,handel);case 2:case\"end\":return _context.stop();}}},_marked);}var getToken=function getToken(state){return state.user.token;};function handel(action){var token,_response$data,_getApi,callQuery,queries,query,response,comment;return _regeneratorRuntime.wrap(function handel$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return select(getToken);case 2:token=_context2.sent;if(token){_context2.next=5;break;}return _context2.abrupt(\"return\");case 5:_context2.prev=5;_getApi=getApi(\"UserAssets\"),callQuery=_getApi.callQuery,queries=_getApi.queries;query=queries.createCommentQl;_context2.next=10;return callQuery(query,token,action.commentData);case 10:response=_context2.sent;comment=response===null||response===void 0?void 0:(_response$data=response.data)===null||_response$data===void 0?void 0:_response$data.createComment;if(!response.errors){_context2.next=14;break;}throw new Error(\"Server response contains errors \"+errorParser(response.errors));case 14:if(comment){_context2.next=16;break;}throw new Error();case 16:_context2.next=18;return put(postComment(comment));case 18:_context2.next=20;return put(pushLog(new Log(\"Comment created in database id: \".concat(comment.id))));case 20:_context2.next=26;break;case 22:_context2.prev=22;_context2.t0=_context2[\"catch\"](5);_context2.next=26;return pushLog(Log.Error(['saga','record','comments','request craeted comment'],\"Can't create comment in database. \"+_context2.t0.message,\"Sorry. During creating comment in database occurred problem\",_context2.t0));case 26:case\"end\":return _context2.stop();}}},_marked2,null,[[5,22]]);}","map":{"version":3,"sources":["D:/PROJEKTY/APKI/dj-truck/src/sagas/records/comments/reqCreateComment.js"],"names":["requestCreateComment","handel","put","select","takeEvery","ACTIONS","postComment","pushLog","getApi","Log","errorParser","RECS_REQ_POST_COMMENT","getToken","state","user","token","action","callQuery","queries","query","createCommentQl","commentData","response","comment","data","createComment","errors","Error","id","message"],"mappings":"2JAOyBA,oB,iDAMfC,M,EAbV,OAASC,GAAT,CAAcC,MAAd,CAAsBC,SAAtB,KAAuC,oBAAvC,CACA,OAASC,OAAT,CAAkBC,WAAlB,CAA+BC,OAA/B,KAA8C,kBAA9C,CACA,OAASC,MAAT,KAAuB,6BAAvB,CACA,OAASC,GAAT,KAAoB,gCAApB,CACA,MAAOC,CAAAA,WAAP,KAAwB,gDAAxB,CAGA,cAAe,SAAUV,CAAAA,oBAAV,gJACX,MAAMI,CAAAA,SAAS,CAACC,OAAO,CAACM,qBAAT,CAAgCV,MAAhC,CAAf,CADW,sDAIf,GAAMW,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAAAC,KAAK,QAAIA,CAAAA,KAAK,CAACC,IAAN,CAAWC,KAAf,EAAtB,CAEA,QAAUd,CAAAA,MAAV,CAAiBe,MAAjB,+MACkB,MAAMb,CAAAA,MAAM,CAACS,QAAD,CAAZ,CADlB,OACUG,KADV,mBAEQA,KAFR,4FAKuCP,MAAM,CAAC,YAAD,CAL7C,CAKgBS,SALhB,SAKgBA,SALhB,CAK2BC,OAL3B,SAK2BA,OAL3B,CAOcC,KAPd,CAOsBD,OAAO,CAACE,eAP9B,mBAQyB,MAAMH,CAAAA,SAAS,CAACE,KAAD,CAAQJ,KAAR,CAAeC,MAAM,CAACK,WAAtB,CAAf,CARzB,QAQcC,QARd,gBAUcC,OAVd,CAUwBD,QAVxB,SAUwBA,QAVxB,iCAUwBA,QAAQ,CAAEE,IAVlC,yCAUwB,eAAgBC,aAVxC,KAYYH,QAAQ,CAACI,MAZrB,gCAakB,IAAIC,CAAAA,KAAJ,CAAU,mCAAqCjB,WAAW,CAACY,QAAQ,CAACI,MAAV,CAA1D,CAblB,YAgBYH,OAhBZ,gCAiBkB,IAAII,CAAAA,KAAJ,EAjBlB,2BAoBQ,MAAMzB,CAAAA,GAAG,CAACI,WAAW,CAACiB,OAAD,CAAZ,CAAT,CApBR,0BAsBQ,MAAMrB,CAAAA,GAAG,CAACK,OAAO,CAAC,GAAIE,CAAAA,GAAJ,2CAA2Cc,OAAO,CAACK,EAAnD,EAAD,CAAR,CAAT,CAtBR,+GAyBQ,MAAMrB,CAAAA,OAAO,CAACE,GAAG,CAACkB,KAAJ,CACV,CAAC,MAAD,CAAS,QAAT,CAAmB,UAAnB,CAA+B,yBAA/B,CADU,CAEV,qCAAwC,aAAME,OAFpC,CAGV,6DAHU,cAAD,CAAb,CAzBR","sourcesContent":["import { put, select, takeEvery } from \"redux-saga/effects\";\r\nimport { ACTIONS, postComment, pushLog } from \"../../../actions\";\r\nimport { getApi } from \"./../../../apis/apiProvider\";\r\nimport { Log } from \"./../../../utils/logger/logger\";\r\nimport errorParser from \"./../../../utils/serverErrorParser/errorParser\";\r\n\r\n\r\nexport default function* requestCreateComment() {\r\n    yield takeEvery(ACTIONS.RECS_REQ_POST_COMMENT, handel)\r\n}\r\n\r\nconst getToken = state => state.user.token\r\n\r\nfunction* handel(action) {\r\n    const token = yield select(getToken);\r\n    if(!token) return;\r\n\r\n    try {\r\n        const { callQuery, queries } = getApi(\"UserAssets\");\r\n\r\n        const query = queries.createCommentQl;\r\n        const response = yield callQuery(query, token, action.commentData);\r\n\r\n        const comment = response?.data?.createComment;\r\n        \r\n        if (response.errors) {\r\n            throw new Error(\"Server response contains errors \" + errorParser(response.errors));\r\n        }\r\n\r\n        if(!comment){\r\n            throw new Error()\r\n        }\r\n\r\n        yield put(postComment(comment))\r\n\r\n        yield put(pushLog(new Log(`Comment created in database id: ${comment.id}`)))\r\n        \r\n    } catch (error) {\r\n        yield pushLog(Log.Error(\r\n            ['saga', 'record', 'comments', 'request craeted comment'],\r\n            \"Can't create comment in database. \"  + error.message,\r\n            \"Sorry. During creating comment in database occurred problem\",\r\n            error\r\n        ))\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}