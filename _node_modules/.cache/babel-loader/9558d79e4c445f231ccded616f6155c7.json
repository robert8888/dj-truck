{"ast":null,"code":"import { moveTo, ACTIONS } from \"../../actions\";\nimport { takeEvery, select, put } from \"redux-saga/effects\";\nimport { showLoading, hideLoading } from 'react-redux-loading-bar';\nimport { getApi } from \"./../../apis/apiProvider\";\nimport { get } from \"lodash/object\";\nimport { generateTemplateName as generateName, findClosesDir } from \"./../../reducers/console/playlist/utils\";\nexport default function* renameSelectedRequestSaga() {\n  yield takeEvery(ACTIONS.PL_MOVE_TO_REQUEST, callApi);\n}\n\nconst getToken = state => state.user.token; // const getCurrentSelection = state => state.playList.currentSelection;\n// const getCurrent = (state, path) => get(state.playList, path);\n// const parentDirPath = (state, path) => findClosesDir(state.playList, path);\n// const parseName = (state, path, name) => generateName(state.playList, path, name);\n\n\nfunction* callApi(action) {\n  const token = yield select(getToken);\n\n  if (!token) {\n    yield put(moveTo(action.pathFrom, action.pathTo));\n    return;\n  }\n\n  try {\n    yield put(showLoading());\n    const {\n      callQuery,\n      queries\n    } = getApi(\"UserAssets\"); // const currentSelection = yield select(getCurrentSelection);\n    // const current = yield select(getCurrent, currentSelection);\n    // const parentPath = yield select(parentDirPath, currentSelection);\n    // const id = current._id;\n    // const isPlaylist = (current._type === \"playlist\");\n    // const name = yield select(parseName, parentPath, action.name)\n    // if (!id) {\n    //     throw new Error(\"Element id missing\")\n    // }\n    // let query;\n    // if (isPlaylist) {\n    //     query = queries.renameQl.renamePlaylist(id, name)\n    // } else { // dir\n    //     query = queries.renameQl.renameDir(id, name)\n    // }\n\n    let res = yield callQuery(query, token);\n\n    if (!res.erorrs) {} else {\n      throw new Error(JSON.stringify(res.errors));\n    }\n  } catch (err) {\n    console.log(\"Can't update data in database. Api call problem\");\n    console.log(err.message);\n  } finally {\n    yield put(hideLoading());\n  }\n}","map":{"version":3,"sources":["D:/PROJEKTY/APKI/dj-truck/src/sagas/playlists/moveElementToRequestSaga.js"],"names":["moveTo","ACTIONS","takeEvery","select","put","showLoading","hideLoading","getApi","get","generateTemplateName","generateName","findClosesDir","renameSelectedRequestSaga","PL_MOVE_TO_REQUEST","callApi","getToken","state","user","token","action","pathFrom","pathTo","callQuery","queries","res","query","erorrs","Error","JSON","stringify","errors","err","console","log","message"],"mappings":"AAAA,SAASA,MAAT,EAAiBC,OAAjB,QAAgC,eAAhC;AACA,SAASC,SAAT,EAAoBC,MAApB,EAA4BC,GAA5B,QAAuC,oBAAvC;AACA,SAASC,WAAT,EAAsBC,WAAtB,QAAyC,yBAAzC;AACA,SAASC,MAAT,QAAuB,0BAAvB;AACA,SAASC,GAAT,QAAoB,eAApB;AACA,SACIC,oBAAoB,IAAIC,YAD5B,EAEIC,aAFJ,QAGO,yCAHP;AAKA,eAAe,UAAUC,yBAAV,GAAsC;AACjD,QAAMV,SAAS,CAACD,OAAO,CAACY,kBAAT,EAA6BC,OAA7B,CAAf;AACH;;AAED,MAAMC,QAAQ,GAAGC,KAAK,IAAIA,KAAK,CAACC,IAAN,CAAWC,KAArC,C,CAEA;AAEA;AAEA;AAEA;;;AAEA,UAAUJ,OAAV,CAAkBK,MAAlB,EAA0B;AACtB,QAAMD,KAAK,GAAG,MAAMf,MAAM,CAACY,QAAD,CAA1B;;AACA,MAAI,CAACG,KAAL,EAAY;AACR,UAAMd,GAAG,CAACJ,MAAM,CAACmB,MAAM,CAACC,QAAR,EAAkBD,MAAM,CAACE,MAAzB,CAAP,CAAT;AACA;AACH;;AACD,MAAI;AACA,UAAMjB,GAAG,CAACC,WAAW,EAAZ,CAAT;AACA,UAAM;AAAEiB,MAAAA,SAAF;AAAaC,MAAAA;AAAb,QAAyBhB,MAAM,CAAC,YAAD,CAArC,CAFA,CAGA;AACA;AACA;AAEA;AACA;AAEA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,QAAIiB,GAAG,GAAG,MAAMF,SAAS,CAACG,KAAD,EAAQP,KAAR,CAAzB;;AACA,QAAI,CAACM,GAAG,CAACE,MAAT,EAAiB,CAEhB,CAFD,MAEO;AACH,YAAM,IAAIC,KAAJ,CAAUC,IAAI,CAACC,SAAL,CAAeL,GAAG,CAACM,MAAnB,CAAV,CAAN;AACH;AAEJ,GA9BD,CA8BE,OAAOC,GAAP,EAAY;AACVC,IAAAA,OAAO,CAACC,GAAR,CAAY,iDAAZ;AACAD,IAAAA,OAAO,CAACC,GAAR,CAAYF,GAAG,CAACG,OAAhB;AACH,GAjCD,SAiCS;AACP,UAAM9B,GAAG,CAACE,WAAW,EAAZ,CAAT;AACD;AACJ","sourcesContent":["import { moveTo, ACTIONS } from \"../../actions\";\r\nimport { takeEvery, select, put } from \"redux-saga/effects\";\r\nimport { showLoading, hideLoading } from 'react-redux-loading-bar'\r\nimport { getApi } from \"./../../apis/apiProvider\";\r\nimport { get } from \"lodash/object\";\r\nimport {\r\n    generateTemplateName as generateName,\r\n    findClosesDir\r\n} from \"./../../reducers/console/playlist/utils\"\r\n\r\nexport default function* renameSelectedRequestSaga() {\r\n    yield takeEvery(ACTIONS.PL_MOVE_TO_REQUEST, callApi)\r\n}\r\n\r\nconst getToken = state => state.user.token;\r\n\r\n// const getCurrentSelection = state => state.playList.currentSelection;\r\n\r\n// const getCurrent = (state, path) => get(state.playList, path);\r\n\r\n// const parentDirPath = (state, path) => findClosesDir(state.playList, path);\r\n\r\n// const parseName = (state, path, name) => generateName(state.playList, path, name);\r\n\r\nfunction* callApi(action) {\r\n    const token = yield select(getToken);\r\n    if (!token) {\r\n        yield put(moveTo(action.pathFrom, action.pathTo));\r\n        return;\r\n    }\r\n    try {\r\n        yield put(showLoading());\r\n        const { callQuery, queries } = getApi(\"UserAssets\");\r\n        // const currentSelection = yield select(getCurrentSelection);\r\n        // const current = yield select(getCurrent, currentSelection);\r\n        // const parentPath = yield select(parentDirPath, currentSelection);\r\n\r\n        // const id = current._id;\r\n        // const isPlaylist = (current._type === \"playlist\");\r\n\r\n        // const name = yield select(parseName, parentPath, action.name)\r\n\r\n        // if (!id) {\r\n        //     throw new Error(\"Element id missing\")\r\n        // }\r\n\r\n        // let query;\r\n        // if (isPlaylist) {\r\n        //     query = queries.renameQl.renamePlaylist(id, name)\r\n        // } else { // dir\r\n        //     query = queries.renameQl.renameDir(id, name)\r\n        // }\r\n\r\n        let res = yield callQuery(query, token);\r\n        if (!res.erorrs) {\r\n           \r\n        } else {\r\n            throw new Error(JSON.stringify(res.errors))\r\n        }\r\n\r\n    } catch (err) {\r\n        console.log(\"Can't update data in database. Api call problem\");\r\n        console.log(err.message);\r\n    } finally{\r\n      yield put(hideLoading())\r\n    }\r\n}\r\n\r\n"]},"metadata":{},"sourceType":"module"}