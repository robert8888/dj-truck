{"ast":null,"code":"import _wrapRegExp from\"D:\\\\PROJEKTY\\\\APKI\\\\dj-truck\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/wrapRegExp\";import _slicedToArray from\"D:\\\\PROJEKTY\\\\APKI\\\\dj-truck\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useCallback,useEffect}from\"react\";import{connect}from\"react-redux\";import{Link,useLocation}from\"react-router-dom\";import UUIDClass from\"uuidjs\";import{reqUserProfile}from\"./../../../../actions\";import{useFormatRelative}from\"./../../Hooks/useFormatDate\";import Edit from\"./Edit/Edit\";import\"./user-profile.scss\";var UserProfile=function UserProfile(_ref){var nickname=_ref.nickname,profile=_ref.profile,reqProfile=_ref.reqProfile,withGeneres=_ref.withGeneres,editable=_ref.editable,_ref$onChange=_ref.onChange,onChange=_ref$onChange===void 0?function(ifEmpty){return null;}:_ref$onChange;var location=useLocation();var _useFormatRelative=useFormatRelative(),_useFormatRelative2=_slicedToArray(_useFormatRelative,1),formatRelative=_useFormatRelative2[0];useEffect(function(){if(nickname&&!profile||profile.user.nickname!==nickname){reqProfile(nickname);}},[nickname,profile,reqProfile]);var parsePirctureUrl=useCallback(function(url){if(url.startsWith(\"https://platform-lookaside.fbsbx.com\")){var asid=url.match(_wrapRegExp(/asid=([0-9]+)/,{asid:1})).groups.asid;url=\"https://graph.facebook.com/v2.5/\".concat(asid,\"/picture?type=large\");}return url;},[]);var linkToGenere=useCallback(function(genere){var pathname=location.pathname,search=location.search;search=search.replace(/\\??&?generes=[^&]+/g,\"\");return pathname+search+(search?\"&\":\"?\")+\"generes=\"+genere;},[location]);if(!profile||!nickname){return null;}return React.createElement(\"div\",{className:\"user-profile\"},React.createElement(\"main\",null,React.createElement(\"div\",{className:\"user-picture\"},React.createElement(Edit,{active:editable,type:\"image\",onChange:onChange.bind(null,'picture')},React.createElement(\"img\",{src:parsePirctureUrl(profile.user.picture),alt:\"user avatar\"}))),React.createElement(\"section\",null,React.createElement(\"div\",{className:\"user-nickname\"},React.createElement(Edit,{active:editable,type:\"text\",onChange:onChange.bind(null,'nickname')},React.createElement(\"h4\",null,profile.user.nickname))),React.createElement(\"div\",{className:\"user-joined\"},React.createElement(\"h5\",null,formatRelative(profile.user.createdAt,{timezone:true}))),React.createElement(\"div\",{className:\"user-record-stat\"},React.createElement(\"span\",null,\"\".concat(profile.records,\" records\")),React.createElement(\"span\",null,\"\".concat(~~(profile.recordsTime/(60*1000)),\" min\"))))),React.createElement(\"aside\",null,React.createElement(\"div\",{className:\"user-description\"},React.createElement(Edit,{active:editable,type:\"textarea\",onChange:onChange.bind(null,'description')},React.createElement(\"p\",null,profile.description))),withGeneres&&React.createElement(\"div\",{className:\"generes\"},React.createElement(\"ul\",null,profile.generes&&profile.generes.length&&profile.generes.map(function(genereWrapper){return React.createElement(\"li\",{key:UUIDClass.genV1()},React.createElement(Link,{to:linkToGenere(genereWrapper.genere.name)},\"\".concat(genereWrapper.genere.name,\" - \").concat(genereWrapper.occurrence)));})))));};var mapStateToProps=function mapStateToProps(state){return{profile:state.profile.current};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{reqProfile:function reqProfile(nickname){return dispatch(reqUserProfile(nickname));}};};export default connect(mapStateToProps,mapDispatchToProps)(UserProfile);","map":{"version":3,"sources":["D:/PROJEKTY/APKI/dj-truck/src/pages/common/components/UserProfile/UserProfile.js"],"names":["React","useCallback","useEffect","connect","Link","useLocation","UUIDClass","reqUserProfile","useFormatRelative","Edit","UserProfile","nickname","profile","reqProfile","withGeneres","editable","onChange","ifEmpty","location","formatRelative","user","parsePirctureUrl","url","startsWith","asid","match","groups","linkToGenere","genere","pathname","search","replace","bind","picture","createdAt","timezone","records","recordsTime","description","generes","length","map","genereWrapper","genV1","name","occurrence","mapStateToProps","state","current","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React, { useCallback, useEffect } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { Link, useLocation } from \"react-router-dom\";\r\nimport UUIDClass from \"uuidjs\";\r\nimport { reqUserProfile } from \"./../../../../actions\";\r\nimport { useFormatRelative } from \"./../../Hooks/useFormatDate\";\r\nimport Edit from \"./Edit/Edit\";\r\nimport \"./user-profile.scss\";\r\n\r\nconst UserProfile = ({ nickname, profile, reqProfile, withGeneres, editable , onChange = ifEmpty => null }) => {\r\n    const location = useLocation();\r\n    const [formatRelative] = useFormatRelative();\r\n\r\n    useEffect(() => {\r\n        if ((nickname && !profile) || profile.user.nickname !== nickname) {\r\n            reqProfile(nickname);\r\n        }\r\n    }, [nickname, profile, reqProfile])\r\n\r\n    const parsePirctureUrl = useCallback((url) => {\r\n        if (url.startsWith(\"https://platform-lookaside.fbsbx.com\")) {\r\n            const asid = url.match(/asid=(?<asid>\\d+)/).groups.asid;\r\n            url = `https://graph.facebook.com/v2.5/${asid}/picture?type=large`\r\n        }\r\n        return url\r\n    }, [])\r\n\r\n    const linkToGenere = useCallback((genere)=>{\r\n        let {pathname, search} = location;\r\n        search = search.replace(/\\??&?generes=[^&]+/g, \"\")\r\n        return pathname + search + ((search) ? \"&\" : \"?\") + \"generes=\" + genere;\r\n    },[location])\r\n\r\n    if (!profile || !nickname) {\r\n        return null;\r\n    }\r\n\r\n    return (\r\n        <div className=\"user-profile\">\r\n            <main>\r\n            <div className=\"user-picture\">\r\n                <Edit active={editable} type=\"image\" onChange={onChange.bind(null, 'picture')}>\r\n                    <img src={parsePirctureUrl(profile.user.picture)} alt=\"user avatar\" />\r\n                </Edit>\r\n            </div>\r\n            <section>\r\n                <div className=\"user-nickname\" >\r\n                    <Edit active={editable} type=\"text\" onChange={onChange.bind(null, 'nickname')} >\r\n                        <h4>{profile.user.nickname}</h4>\r\n                    </Edit>\r\n                </div>\r\n                <div className=\"user-joined\">\r\n                        <h5>{formatRelative(profile.user.createdAt, {timezone :true})}</h5>\r\n                </div>\r\n                <div className=\"user-record-stat\">\r\n                    <span>{`${profile.records} records`}</span>\r\n                    <span>{`${~~(profile.recordsTime / (60 * 1000)) } min`}</span>\r\n                </div>\r\n            </section>\r\n            </main>\r\n            <aside>\r\n            <div className=\"user-description\">\r\n                <Edit active={editable} type=\"textarea\" onChange={onChange.bind(null, 'description')}>\r\n                    <p>{profile.description}</p>\r\n                </Edit>\r\n            </div>\r\n           {withGeneres && \r\n           <div className=\"generes\">\r\n                    <ul>\r\n                        {profile.generes && profile.generes.length &&\r\n                            profile.generes.map( genereWrapper => (\r\n                                <li key={UUIDClass.genV1()}>\r\n                                    <Link to={linkToGenere(genereWrapper.genere.name)}>\r\n                                        {`${genereWrapper.genere.name} - ${genereWrapper.occurrence}`}\r\n                                    </Link>\r\n                                </li>\r\n                            ))\r\n                        }\r\n                    </ul>\r\n            </div>\t}\r\n            </aside>\r\n\r\n        </div>\r\n    )\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n    profile: state.profile.current\r\n})\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n    reqProfile: (nickname) => dispatch(reqUserProfile(nickname))\r\n})\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(UserProfile);\r\n\r\n"]},"metadata":{},"sourceType":"module"}