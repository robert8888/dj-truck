{"ast":null,"code":"var _jsxFileName = \"D:\\\\PROJEKTY\\\\APKI\\\\DjTruck\\\\djtruck\\\\src\\\\pages\\\\app\\\\components\\\\PlayListExplorer\\\\Explorer\\\\ExplorerTree\\\\ExplorerTree.js\";\nimport React, { useCallback, useState, useRef, Fragment } from \"react\";\nimport { connect } from \"react-redux\";\nimport ExplorerContextMenu from \"./ContextMenu/ExplorerContextMenu\";\nimport { ContextMenuTrigger } from \"react-contextmenu\";\nimport { toggleDir as toggleDirAction, setSelection, setCurrentPlaylist, renameSelected, deleteSelected } from \"./../../../../../../actions\";\nimport { isEmpty, sortObj } from \"./../../../../../../utils/objects/helpers\";\nimport UUID from \"uuidjs\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport ClassName from \"classnames\";\nimport { faFolder, faFile, faAngleRight, faAngleDown } from \"@fortawesome/free-solid-svg-icons\";\nimport { useDoubleClick } from \"./useDoubleClick\";\nimport \"./explorer-tree.scss\";\n\nconst ExplorerTree = props => {\n  const [renameMode, setRenameMode] = useState(false);\n  const renameInputRef = useRef();\n  const propToggleDir = props.toggleDir;\n  const toggleDir = useCallback(path => {\n    propToggleDir(path);\n  }, [propToggleDir]);\n  const propSetSelection = props.setSelection;\n  const setSelection = useCallback(path => {\n    propSetSelection(path);\n  }, [propSetSelection]);\n  const propRenameSelected = props.renameSelected;\n  const rename = useCallback(() => {\n    propRenameSelected(renameInputRef.current.value);\n    setRenameMode(false);\n  }, [setRenameMode, propRenameSelected]);\n  const propDeleteSelected = props.deleteSelected;\n  const deleteSelected = useCallback(() => {\n    propDeleteSelected();\n  }, [propDeleteSelected]);\n  const renameInput = useCallback(name => {\n    return React.createElement(\"input\", {\n      type: \"text\",\n      className: \"rename-input\",\n      defaultValue: name,\n      ref: renameInputRef,\n      onBlur: rename.bind(null),\n      onKeyPress: event => {\n        if (event.key === \"Enter\") rename();\n      },\n      autoFocus: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 55\n      },\n      __self: this\n    });\n  });\n  const [dirClickHandler] = useDoubleClick({\n    clickHandler: setSelection,\n    doubleClickHandler: toggleDir\n  });\n  const getDirElement = useCallback((name, path, open, empty) => {\n    let currentSelected = false;\n\n    if ([...path, name].join(\"\") === props.currentSelection.join(\"\")) {\n      currentSelected = true;\n    }\n\n    const liClassList = ClassName(\"list-item item-dir\", {\n      \"item-dir--empty\": empty\n    }, {\n      \"item--selected\": currentSelected\n    });\n    let content = name;\n\n    if (currentSelected && renameMode) {\n      content = renameInput(name);\n    }\n\n    return React.createElement(\"li\", {\n      onClick: !renameMode ? fileClickHandler.bind(null, [...path, name]) : null,\n      onContextMenu: setSelection.bind(null, [...path, name]),\n      className: liClassList,\n      \"data-path\": path.join(\"/\"),\n      key: UUID.genV1(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88\n      },\n      __self: this\n    }, !empty && React.createElement(\"button\", {\n      className: \"btn-dir \" + (open ? \"btn-dir--expand\" : \"btn-dir--colapse\"),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95\n      },\n      __self: this\n    }, React.createElement(FontAwesomeIcon, {\n      className: \"icon\",\n      icon: open ? faAngleDown : faAngleRight,\n      onClick: toggleDir.bind(null, [...path, name]),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97\n      },\n      __self: this\n    })), React.createElement(FontAwesomeIcon, {\n      className: \"icon icon-dir\",\n      icon: faFolder,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102\n      },\n      __self: this\n    }), content);\n  });\n  const [fileClickHandler] = useDoubleClick({\n    clickHandler: setSelection,\n    doubleClickHandler: props.setCurrentPlaylist\n  });\n  const getFileElement = useCallback((name, path) => {\n    let currentSelected = false;\n\n    if ([...path, name].join(\"\") === props.currentSelection.join(\"\")) {\n      currentSelected = true;\n    }\n\n    const liClassList = ClassName(\"list-item item-file\", {\n      \"item--selected\": currentSelected\n    });\n    let content = name;\n\n    if (currentSelected && renameMode) {\n      content = renameInput(name);\n    }\n\n    return React.createElement(\"li\", {\n      className: liClassList,\n      onClick: !renameMode ? fileClickHandler.bind(null, [...path, name]) : null,\n      onContextMenu: setSelection.bind(null, [...path, name]),\n      \"data-path\": path.join(\"/\"),\n      key: UUID.genV1(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127\n      },\n      __self: this\n    }, React.createElement(FontAwesomeIcon, {\n      className: \"icon icon-file\",\n      icon: faFile,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133\n      },\n      __self: this\n    }), content);\n  });\n  const renderDirElements = useCallback((name, content, path) => {\n    content = sortObj(content);\n\n    if (content instanceof Array) {\n      return getFileElement(name, path);\n    } else {\n      if (content._open === true) {\n        return React.createElement(Fragment, {\n          key: UUID.genV1(),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 146\n          },\n          __self: this\n        }, getDirElement(name, path, true), renderDir(content, [...path, name]));\n      } else {\n        if (isEmpty(content)) {\n          return getDirElement(name, path, false, true);\n        }\n\n        return getDirElement(name, path, false);\n      }\n    }\n  });\n  const renderDir = useCallback((dir, path) => {\n    return React.createElement(\"ul\", {\n      className: \"list-dir dir-content\",\n      key: UUID.generate(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163\n      },\n      __self: this\n    }, Object.entries(dir).map(([name, content]) => {\n      if (name === \"_open\") {\n        return null;\n      }\n\n      return renderDirElements(name, content, path);\n    }));\n  });\n  return React.createElement(Fragment, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177\n    },\n    __self: this\n  }, React.createElement(ContextMenuTrigger, {\n    id: \"explorer_context_menu\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"explorer-tree\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179\n    },\n    __self: this\n  }, renderDir(props.root, ['root']))), React.createElement(ExplorerContextMenu, {\n    id: \"explorer_context_menu\",\n    items: {\n      \"Rename\": setRenameMode.bind(null, true),\n      \"Delete\": null\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184\n    },\n    __self: this\n  }));\n};\n\nconst mapStateToProps = state => ({\n  root: state.playList.root,\n  currentSelection: state.playList.currentSelection\n});\n\nconst mapDispatchToProps = dispatch => ({\n  toggleDir: path => dispatch(toggleDirAction(path)),\n  setSelection: path => dispatch(setSelection(path)),\n  setCurrentPlaylist: path => dispatch(setCurrentPlaylist(path)),\n  renameSelected: newName => dispatch(renameSelected(newName)),\n  deleteSelected: dispatch(deleteSelected())\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ExplorerTree);","map":{"version":3,"sources":["D:/PROJEKTY/APKI/DjTruck/djtruck/src/pages/app/components/PlayListExplorer/Explorer/ExplorerTree/ExplorerTree.js"],"names":["React","useCallback","useState","useRef","Fragment","connect","ExplorerContextMenu","ContextMenuTrigger","toggleDir","toggleDirAction","setSelection","setCurrentPlaylist","renameSelected","deleteSelected","isEmpty","sortObj","UUID","FontAwesomeIcon","ClassName","faFolder","faFile","faAngleRight","faAngleDown","useDoubleClick","ExplorerTree","props","renameMode","setRenameMode","renameInputRef","propToggleDir","path","propSetSelection","propRenameSelected","rename","current","value","propDeleteSelected","renameInput","name","bind","event","key","dirClickHandler","clickHandler","doubleClickHandler","getDirElement","open","empty","currentSelected","join","currentSelection","liClassList","content","fileClickHandler","genV1","getFileElement","renderDirElements","Array","_open","renderDir","dir","generate","Object","entries","map","root","mapStateToProps","state","playList","mapDispatchToProps","dispatch","newName"],"mappings":"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","sourcesContent":["import React, { useCallback, useState, useRef, Fragment } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport ExplorerContextMenu from \"./ContextMenu/ExplorerContextMenu\";\r\nimport { ContextMenuTrigger } from \"react-contextmenu\";\r\n\r\nimport { \r\n    toggleDir as toggleDirAction, \r\n    setSelection, \r\n    setCurrentPlaylist, \r\n    renameSelected, \r\n    deleteSelected \r\n} from \"./../../../../../../actions\"\r\nimport { isEmpty, sortObj } from \"./../../../../../../utils/objects/helpers\";\r\nimport UUID from \"uuidjs\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport ClassName from \"classnames\";\r\nimport { \r\n    faFolder, \r\n    faFile, \r\n    faAngleRight, \r\n    faAngleDown \r\n} from \"@fortawesome/free-solid-svg-icons\";\r\nimport { useDoubleClick } from \"./useDoubleClick\";\r\nimport \"./explorer-tree.scss\";\r\n\r\nconst ExplorerTree = props => {\r\n\r\n    const [renameMode, setRenameMode] = useState(false);\r\n    const renameInputRef = useRef();\r\n\r\n    const propToggleDir = props.toggleDir;\r\n    const toggleDir = useCallback((path) => {\r\n        propToggleDir(path);\r\n    }, [propToggleDir])\r\n\r\n    const propSetSelection = props.setSelection\r\n    const setSelection = useCallback((path) => {\r\n        propSetSelection(path);\r\n    }, [propSetSelection])\r\n\r\n\r\n    const propRenameSelected = props.renameSelected\r\n    const rename = useCallback(() => {\r\n        propRenameSelected(renameInputRef.current.value)\r\n        setRenameMode(false);\r\n    }, [setRenameMode, propRenameSelected])\r\n\r\n    const propDeleteSelected = props.deleteSelected;\r\n    const deleteSelected = useCallback(()=>{\r\n        propDeleteSelected();\r\n    }, [propDeleteSelected])\r\n\r\n    const renameInput = useCallback((name) => {\r\n        return (\r\n            <input\r\n                type=\"text\"\r\n                className=\"rename-input\"\r\n                defaultValue={name}\r\n                ref={renameInputRef}\r\n                onBlur={rename.bind(null)}\r\n                onKeyPress={event => { if (event.key === \"Enter\") rename() }}\r\n                autoFocus\r\n            />\r\n        )\r\n    })\r\n\r\n    const [dirClickHandler] = useDoubleClick({\r\n        clickHandler: setSelection,\r\n        doubleClickHandler: toggleDir\r\n    })\r\n\r\n\r\n    const getDirElement = useCallback((name, path, open, empty) => {\r\n        let currentSelected = false;\r\n        if ([...path, name].join(\"\") === props.currentSelection.join(\"\")) {\r\n            currentSelected = true;\r\n        }\r\n        const liClassList = ClassName(\r\n            \"list-item item-dir\",\r\n            { \"item-dir--empty\": empty },\r\n            { \"item--selected\": currentSelected }\r\n        )\r\n        let content = name;\r\n        if (currentSelected && renameMode) {\r\n            content = renameInput(name)\r\n        }\r\n        return (\r\n            <li\r\n                onClick={((!renameMode) ? fileClickHandler.bind(null, [...path, name]) : null)}\r\n                onContextMenu={setSelection.bind(null, [...path, name])}\r\n                className={liClassList}\r\n                data-path={path.join(\"/\")}\r\n                key={UUID.genV1()}>\r\n                {!empty &&\r\n                    <button\r\n                        className={\"btn-dir \" + ((open) ? \"btn-dir--expand\" : \"btn-dir--colapse\")}>\r\n                        <FontAwesomeIcon\r\n                            className=\"icon\"\r\n                            icon={(open) ? faAngleDown : faAngleRight}\r\n                            onClick={toggleDir.bind(null, [...path, name])} />\r\n                    </button>}\r\n                <FontAwesomeIcon className=\"icon icon-dir\" icon={faFolder} />\r\n                {content}\r\n            </li>\r\n        )\r\n    })\r\n\r\n    const [fileClickHandler] = useDoubleClick({\r\n        clickHandler: setSelection,\r\n        doubleClickHandler: props.setCurrentPlaylist\r\n    })\r\n\r\n    const getFileElement = useCallback((name, path) => {\r\n        let currentSelected = false;\r\n        if ([...path, name].join(\"\") === props.currentSelection.join(\"\")) {\r\n            currentSelected = true;\r\n        }\r\n        const liClassList = ClassName(\r\n            \"list-item item-file\",\r\n            { \"item--selected\": currentSelected }\r\n        )\r\n        let content = name;\r\n        if (currentSelected && renameMode) {\r\n            content = renameInput(name)\r\n        }\r\n        return (\r\n            <li\r\n                className={liClassList}\r\n                onClick={((!renameMode) ? fileClickHandler.bind(null, [...path, name]) : null)}\r\n                onContextMenu={setSelection.bind(null, [...path, name])}\r\n                data-path={path.join(\"/\")}\r\n                key={UUID.genV1()}>\r\n                <FontAwesomeIcon className=\"icon icon-file\" icon={faFile} />\r\n                {content}\r\n            </li>\r\n        );\r\n    })\r\n\r\n    const renderDirElements = useCallback((name, content, path) => {\r\n        content = sortObj(content);\r\n        if (content instanceof Array) {\r\n            return getFileElement(name, path)\r\n        } else {\r\n            if (content._open === true) {\r\n                return (\r\n                    <Fragment key={UUID.genV1()}>\r\n                        {getDirElement(name, path, true)}\r\n                        {renderDir(content, [...path, name])}\r\n                    </Fragment>\r\n                )\r\n            } else {\r\n                if (isEmpty(content)) {\r\n                    return getDirElement(name, path, false, true)\r\n                }\r\n                return getDirElement(name, path, false)\r\n            }\r\n        }\r\n    })\r\n\r\n\r\n    const renderDir = useCallback((dir, path) => {\r\n        return (\r\n            <ul className=\"list-dir dir-content\" key={UUID.generate()}>\r\n                {\r\n                    Object.entries(dir).map(([name, content]) => {\r\n                        if (name === \"_open\") {\r\n                            return null;\r\n                        }\r\n                        return renderDirElements(name, content, path);\r\n                    })\r\n                }\r\n            </ul>\r\n        )\r\n    })\r\n\r\n    return (\r\n        <Fragment>\r\n            <ContextMenuTrigger id=\"explorer_context_menu\">\r\n                <div className=\"explorer-tree\">\r\n                    {renderDir(props.root, ['root'])}\r\n                </div>\r\n            </ContextMenuTrigger>\r\n\r\n            <ExplorerContextMenu\r\n                id=\"explorer_context_menu\"\r\n                items={{\r\n                    \"Rename\": setRenameMode.bind(null, true),\r\n                    \"Delete\": null\r\n                }} />\r\n        </Fragment>\r\n    )\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n    root: state.playList.root,\r\n    currentSelection: state.playList.currentSelection\r\n})\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n    toggleDir: path => dispatch(toggleDirAction(path)),\r\n    setSelection: path => dispatch(setSelection(path)),\r\n    setCurrentPlaylist: path => dispatch(setCurrentPlaylist(path)),\r\n    renameSelected: newName => dispatch(renameSelected(newName)),\r\n    deleteSelected: dispatch(deleteSelected())\r\n})\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(ExplorerTree);"]},"metadata":{},"sourceType":"module"}