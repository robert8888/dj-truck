{"ast":null,"code":"import Effect from \"../effect\";\nimport { toRange } from \"./../../../../../../../utils/math/argRanges\";\nexport default class Flanger extends Effect {\n  static defaultParams() {\n    return {\n      params: {\n        time: {\n          // div by  100\n          min: 0,\n          max: 100,\n          defaultValue: 45,\n          type: \"float\",\n          description: \"time\"\n        },\n        speed: {\n          // div by 10\n          min: 5,\n          max: 50,\n          defaultValue: 14,\n          type: \"float\",\n          description: \"speed\"\n        },\n        depth: {\n          // div by 20 000\n          min: 10,\n          max: 100,\n          defaultValue: 19,\n          type: \"float\",\n          description: \"depth\"\n        },\n        feedback: {\n          // div by 100\n          min: 0,\n          max: 80,\n          defaultValue: 8,\n          type: \"float\",\n          description: \"fb\"\n        }\n      }\n    };\n  }\n\n  constructor(context, params) {\n    super();\n    this._context = context;\n\n    this._buildNodes();\n\n    this._initParams(params);\n  }\n\n  _initParams(params) {\n    const defaultP = Flanger.defaultParams().params;\n    this.time = params.time || defaultP.time.defaultValue;\n    this.speed = params.speed || defaultP.speed.defaultValue;\n    this.depth = params.depth || defaultP.depth.defaultValue;\n    this.feedback = params.feedback || defaultP.feedback.defaultValue;\n  }\n\n  _buildNodes() {\n    this.inputNode = this._context.createGain();\n    this.outputNode = this._context.createGain();\n    this.inputFeedbackNode = this._context.createGain();\n    this.wetGainNode = this._context.createGain(); //this.dryGainNode = this._context.createGain();\n\n    this.delayNode = this._context.createDelay();\n    this.oscillatorNode = this._context.createOscillator();\n    this.gainNode = this._context.createGain();\n    this.feedbackNode = this._context.createGain();\n    this.oscillatorNode.type = 'sine';\n    this.inputNode.connect(this.inputFeedbackNode); // this.inputNode.connect(this.dryGainNode);\n\n    this.inputFeedbackNode.connect(this.delayNode);\n    this.inputFeedbackNode.connect(this.wetGainNode);\n    this.delayNode.connect(this.wetGainNode);\n    this.delayNode.connect(this.feedbackNode);\n    this.feedbackNode.connect(this.inputFeedbackNode);\n    this.oscillatorNode.connect(this.gainNode);\n    this.gainNode.connect(this.delayNode.delayTime); //this.dryGainNode.connect(this.outputNode);\n\n    this.wetGainNode.connect(this.outputNode);\n    this.oscillatorNode.start(0);\n    this.outputNode.gain.value = 0.4;\n  }\n\n  connect(input, dest) {\n    input.connect(this.inputNode);\n    this.outputNode.connect(dest);\n  }\n\n  disconnect() {\n    this.outputNode.disconnect();\n  }\n\n  _valueToRange(value, name) {\n    let param = Flanger.defaultParams().params[name];\n    return toRange(value, param.min, param.max);\n  }\n\n  get name() {\n    \"flanger\";\n  }\n\n  get time() {\n    return this._time;\n  }\n\n  set time(value) {\n    value = this._valueToRange(value, \"time\");\n    this._time = value;\n    this.delayNode.delayTime.setTargetAtTime(value / 100, this._context.currentTime, 0.01);\n  }\n\n  get speed() {\n    return this._speed;\n  }\n\n  set speed(value) {\n    value = this._valueToRange(value, \"speed\");\n    this._speed = value;\n    this.oscillatorNode.frequency.value = value / 10;\n  }\n\n  get depth() {\n    return this._depth;\n  }\n\n  set depth(value) {\n    value = this._valueToRange(value, \"depth\");\n    this._depth = value;\n    this.gainNode.gain.setTargetAtTime(value / 20000, this._context.currentTime, 0.01);\n  }\n\n  get feedback() {\n    return this._feedback;\n  }\n\n  set feedback(value) {\n    value = this._valueToRange(value, \"feedback\");\n    this._feedback = value;\n    this.feedbackNode.gain.setTargetAtTime(value / 10, this._context.currentTime, 0.01);\n  }\n\n}","map":{"version":3,"sources":["D:/PROJEKTY/APKI/DjTruck/djtruck/src/pages/app/core/console/effector/effects/flanger/flanger.js"],"names":["Effect","toRange","Flanger","defaultParams","params","time","min","max","defaultValue","type","description","speed","depth","feedback","constructor","context","_context","_buildNodes","_initParams","defaultP","inputNode","createGain","outputNode","inputFeedbackNode","wetGainNode","delayNode","createDelay","oscillatorNode","createOscillator","gainNode","feedbackNode","connect","delayTime","start","gain","value","input","dest","disconnect","_valueToRange","name","param","_time","setTargetAtTime","currentTime","_speed","frequency","_depth","_feedback"],"mappings":"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","sourcesContent":["import Effect from \"../effect\";\r\nimport {toRange} from \"./../../../../../../../utils/math/argRanges\";\r\n\r\nexport default class Flanger extends Effect {\r\n\r\n    static defaultParams() {\r\n        return {\r\n            params: {\r\n                time: { // div by  100\r\n                    min: 0,\r\n                    max: 100,\r\n                    defaultValue: 45,\r\n                    type: \"float\",\r\n                    description: \"time\"\r\n                },\r\n                speed: { // div by 10\r\n                    min: 5,\r\n                    max: 50,\r\n                    defaultValue: 14,\r\n                    type: \"float\",\r\n                    description: \"speed\"\r\n                },\r\n                depth: {// div by 20 000\r\n                    min: 10,\r\n                    max: 100,\r\n                    defaultValue: 19,\r\n                    type: \"float\",\r\n                    description : \"depth\"\r\n                },\r\n                feedback : { // div by 100\r\n                    min: 0,\r\n                    max: 80,\r\n                    defaultValue: 8,\r\n                    type: \"float\",\r\n                    description : \"fb\"\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    constructor(context, params){\r\n        super();\r\n        this._context = context;\r\n\r\n        this._buildNodes();\r\n        this._initParams(params);\r\n    }\r\n\r\n    _initParams(params){\r\n        const defaultP = Flanger.defaultParams().params;\r\n        this.time = params.time || defaultP.time.defaultValue;\r\n        this.speed = params.speed || defaultP.speed.defaultValue;\r\n        this.depth = params.depth || defaultP.depth.defaultValue;\r\n        this.feedback = params.feedback || defaultP.feedback.defaultValue;\r\n    }\r\n\r\n    _buildNodes(){\r\n        this.inputNode = this._context.createGain();\r\n        this.outputNode = this._context.createGain();\r\n        this.inputFeedbackNode = this._context.createGain();\r\n        this.wetGainNode = this._context.createGain();\r\n        //this.dryGainNode = this._context.createGain();\r\n        this.delayNode = this._context.createDelay();\r\n        this.oscillatorNode = this._context.createOscillator();\r\n        this.gainNode = this._context.createGain();\r\n        this.feedbackNode = this._context.createGain();\r\n        this.oscillatorNode.type = 'sine';\r\n    \r\n        this.inputNode.connect(this.inputFeedbackNode);\r\n       // this.inputNode.connect(this.dryGainNode);\r\n    \r\n        this.inputFeedbackNode.connect(this.delayNode);\r\n        this.inputFeedbackNode.connect(this.wetGainNode);\r\n    \r\n        this.delayNode.connect(this.wetGainNode);\r\n        this.delayNode.connect(this.feedbackNode);\r\n    \r\n        this.feedbackNode.connect(this.inputFeedbackNode);\r\n    \r\n        this.oscillatorNode.connect(this.gainNode);\r\n        this.gainNode.connect(this.delayNode.delayTime);\r\n    \r\n        //this.dryGainNode.connect(this.outputNode);\r\n        this.wetGainNode.connect(this.outputNode);\r\n        \r\n    \r\n        this.oscillatorNode.start(0);\r\n        this.outputNode.gain.value = 0.4;\r\n    }\r\n\r\n\r\n    connect(input, dest){\r\n        input.connect(this.inputNode);\r\n        this.outputNode.connect(dest);\r\n    }\r\n\r\n    disconnect(){\r\n        this.outputNode.disconnect();\r\n    }\r\n\r\n    _valueToRange(value, name){\r\n        let param = Flanger.defaultParams().params[name];\r\n        return toRange(value, param.min, param.max);\r\n    }\r\n\r\n    get name(){\r\n        \"flanger\"\r\n    }\r\n\r\n    get time(){\r\n        return this._time;\r\n    }\r\n\r\n    set time(value){\r\n        value = this._valueToRange(value, \"time\")\r\n        this._time = value;\r\n        this.delayNode.delayTime.setTargetAtTime( value / 100 , this._context.currentTime, 0.01);\r\n    }\r\n\r\n    get speed(){\r\n        return this._speed;\r\n    }\r\n\r\n    set speed(value){\r\n        value = this._valueToRange(value, \"speed\");\r\n        this._speed= value;\r\n        this.oscillatorNode.frequency.value = value / 10;\r\n    }\r\n\r\n    get depth(){\r\n        return this._depth;\r\n    }\r\n\r\n    set depth(value){\r\n        value = this._valueToRange(value, \"depth\");\r\n        this._depth = value;\r\n        this.gainNode.gain.setTargetAtTime(value / 20000, this._context.currentTime, 0.01);\r\n    }\r\n\r\n    get feedback(){\r\n        return this._feedback;\r\n    }\r\n\r\n    set feedback(value){\r\n        value = this._valueToRange(value, \"feedback\");\r\n        this._feedback = value;\r\n        this.feedbackNode.gain.setTargetAtTime(value/ 10, this._context.currentTime, 0.01)\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}