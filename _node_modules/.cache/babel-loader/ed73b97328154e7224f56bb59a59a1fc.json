{"ast":null,"code":"import { call, put, select, takeEvery } from \"redux-saga/effects\";\nimport { ACTIONS, pushToTracklist, updateEndTime } from \"../../../actions\";\nimport RECORD_STATE from \"./../../../reducers/console/recorder/stateDef\";\nexport default function* interceptLoadtrack() {\n  yield takeEvery(ACTIONS.LOAD_TRACK, handel);\n}\n\nconst getTracklist = state => state.recorder.tracklist;\n\nconst isRecording = state => state.recorder.recordingState === RECORD_STATE.RECORDING;\n\nfunction* finishUnfinished(tracklist, channel) {\n  const unfinished = tracklist.find(track => track.channel === channel && track.start && !track.end);\n  if (!unfinished) return;\n  yield put(updateEndTime(unfinished.id));\n}\n\nfunction* handel(action) {\n  const channel = action.destination;\n  const track = action.track;\n  const recording = yield select(isRecording);\n  if (!recording) return;\n  const tracklist = yield select(getTracklist);\n  yield call(finishUnfinished, tracklist, channel);\n  yield put(pushToTracklist({\n    id: track.id,\n    channel,\n    start: null,\n    end: null\n  }));\n}","map":{"version":3,"sources":["D:/PROJEKTY/APKI/dj-truck/src/sagas/recorder/tracklist/loadtrack.js"],"names":["call","put","select","takeEvery","ACTIONS","pushToTracklist","updateEndTime","RECORD_STATE","interceptLoadtrack","LOAD_TRACK","handel","getTracklist","state","recorder","tracklist","isRecording","recordingState","RECORDING","finishUnfinished","channel","unfinished","find","track","start","end","id","action","destination","recording"],"mappings":"AAAA,SAASA,IAAT,EAAeC,GAAf,EAAoBC,MAApB,EAA4BC,SAA5B,QAA6C,oBAA7C;AACA,SAASC,OAAT,EAAkBC,eAAlB,EAAmCC,aAAnC,QAAwD,kBAAxD;AACA,OAAOC,YAAP,MAAyB,+CAAzB;AAGA,eAAe,UAAUC,kBAAV,GAA+B;AAC1C,QAAML,SAAS,CAACC,OAAO,CAACK,UAAT,EAAqBC,MAArB,CAAf;AACH;;AAED,MAAMC,YAAY,GAAGC,KAAK,IAAIA,KAAK,CAACC,QAAN,CAAeC,SAA7C;;AAEA,MAAMC,WAAW,GAAGH,KAAK,IAAIA,KAAK,CAACC,QAAN,CAAeG,cAAf,KAAkCT,YAAY,CAACU,SAA5E;;AAEA,UAAWC,gBAAX,CAA4BJ,SAA5B,EAAwCK,OAAxC,EAAgD;AAC5C,QAAMC,UAAU,GAAGN,SAAS,CAACO,IAAV,CAAeC,KAAK,IAClCA,KAAK,CAACH,OAAN,KAAkBA,OAAlB,IAA6BG,KAAK,CAACC,KAAnC,IAA4C,CAACD,KAAK,CAACE,GADrC,CAAnB;AAGA,MAAG,CAACJ,UAAJ,EAAgB;AAEhB,QAAMnB,GAAG,CAACK,aAAa,CAACc,UAAU,CAACK,EAAZ,CAAd,CAAT;AACH;;AAED,UAAUf,MAAV,CAAiBgB,MAAjB,EAAwB;AACpB,QAAMP,OAAO,GAAGO,MAAM,CAACC,WAAvB;AACA,QAAML,KAAK,GAAGI,MAAM,CAACJ,KAArB;AAEA,QAAMM,SAAS,GAAG,MAAM1B,MAAM,CAACa,WAAD,CAA9B;AACA,MAAG,CAACa,SAAJ,EAAe;AAEf,QAAMd,SAAS,GAAG,MAAMZ,MAAM,CAACS,YAAD,CAA9B;AACA,QAAMX,IAAI,CAACkB,gBAAD,EAAmBJ,SAAnB,EAA8BK,OAA9B,CAAV;AAEA,QAAMlB,GAAG,CAACI,eAAe,CAAC;AACtBoB,IAAAA,EAAE,EAAEH,KAAK,CAACG,EADY;AAEtBN,IAAAA,OAFsB;AAGtBI,IAAAA,KAAK,EAAE,IAHe;AAItBC,IAAAA,GAAG,EAAE;AAJiB,GAAD,CAAhB,CAAT;AAOH","sourcesContent":["import { call, put, select, takeEvery } from \"redux-saga/effects\";\r\nimport { ACTIONS, pushToTracklist, updateEndTime } from \"../../../actions\";\r\nimport RECORD_STATE from \"./../../../reducers/console/recorder/stateDef\";\r\n\r\n\r\nexport default function* interceptLoadtrack() {\r\n    yield takeEvery(ACTIONS.LOAD_TRACK, handel)\r\n}\r\n\r\nconst getTracklist = state => state.recorder.tracklist;\r\n\r\nconst isRecording = state => state.recorder.recordingState === RECORD_STATE.RECORDING; \r\n\r\nfunction * finishUnfinished(tracklist , channel){\r\n    const unfinished = tracklist.find(track => \r\n        (track.channel === channel && track.start && !track.end)\r\n    )\r\n    if(!unfinished) return; \r\n\r\n    yield put(updateEndTime(unfinished.id))\r\n}\r\n\r\nfunction* handel(action){\r\n    const channel = action.destination;\r\n    const track = action.track;\r\n    \r\n    const recording = yield select(isRecording);\r\n    if(!recording) return;\r\n\r\n    const tracklist = yield select(getTracklist);\r\n    yield call(finishUnfinished, tracklist, channel);\r\n\r\n    yield put(pushToTracklist({\r\n        id: track.id,\r\n        channel,\r\n        start: null,\r\n        end: null,\r\n    }))\r\n\r\n}"]},"metadata":{},"sourceType":"module"}