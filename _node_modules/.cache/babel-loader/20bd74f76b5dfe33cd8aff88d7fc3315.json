{"ast":null,"code":"import _wrapRegExp from \"D:\\\\PROJEKTY\\\\APKI\\\\dj-truck\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/wrapRegExp\";\nvar _jsxFileName = \"D:\\\\PROJEKTY\\\\APKI\\\\dj-truck\\\\src\\\\pages\\\\common\\\\components\\\\UserProfile\\\\UserProfile.js\";\nimport React, { useMemo, useEffect, useCallback } from \"react\";\nimport { connect } from \"react-redux\";\nimport { Link, useLocation } from \"react-router-dom\";\nimport { reqUserProfile } from \"./../../../../actions\";\nimport { useFormatRelative } from \"./../../Hooks/useFormatDate\";\nimport Edit from \"./Edit/Edit\";\nimport \"./user-profile.scss\";\nimport UUIDClass from \"uuidjs\";\n\nconst UserProfile = ({\n  nickname,\n  profile,\n  reqProfile,\n  withGeneres,\n  editable,\n  onChange = ifEmpty => null\n}) => {\n  const location = useLocation();\n  const [formatRelative] = useFormatRelative();\n  useEffect(() => {\n    if (nickname && !profile || profile.user.nickname !== nickname) {\n      reqProfile(nickname);\n    }\n  }, [nickname, profile, reqProfile]);\n  const parsePirctureUrl = useCallback(url => {\n    if (url.startsWith(\"https://platform-lookaside.fbsbx.com\")) {\n      const asid = url.match(_wrapRegExp(/asid=([0-9]+)/, {\n        asid: 1\n      })).groups.asid;\n      url = `https://graph.facebook.com/v2.5/${asid}/picture?type=large`;\n    }\n\n    return url;\n  }, []);\n  const linkToGenere = useCallback(genere => {\n    let {\n      pathname,\n      search\n    } = location;\n    search = search.replace(/\\??\\&?generes=[^&]+/g, \"\");\n    return pathname + search + (search ? \"&\" : \"?\") + \"generes=\" + genere;\n  }, [location]);\n\n  if (!profile || !nickname) {\n    return null;\n  }\n\n  return React.createElement(\"div\", {\n    className: \"user-profile\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 39\n    },\n    __self: this\n  }, React.createElement(\"main\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 40\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"user-picture\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 41\n    },\n    __self: this\n  }, React.createElement(Edit, {\n    active: editable,\n    type: \"image\",\n    onChange: onChange.bind('picture'),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 42\n    },\n    __self: this\n  }, React.createElement(\"img\", {\n    src: parsePirctureUrl(profile.user.picture),\n    alt: \"User picture\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 43\n    },\n    __self: this\n  }))), React.createElement(\"section\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 46\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"user-nickname\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 47\n    },\n    __self: this\n  }, React.createElement(Edit, {\n    active: editable,\n    type: \"text\",\n    onChange: onChange.bind('nickname'),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 48\n    },\n    __self: this\n  }, React.createElement(\"h4\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 49\n    },\n    __self: this\n  }, profile.user.nickname))), React.createElement(\"div\", {\n    className: \"user-joined\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 52\n    },\n    __self: this\n  }, React.createElement(\"h5\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53\n    },\n    __self: this\n  }, formatRelative(profile.user.createdAt, {\n    timezone: true\n  }))), React.createElement(\"div\", {\n    className: \"user-record-stat\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55\n    },\n    __self: this\n  }, React.createElement(\"span\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56\n    },\n    __self: this\n  }, `${profile.records} records`), React.createElement(\"span\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57\n    },\n    __self: this\n  }, `${~~(profile.recordsTime / (60 * 1000))} min`)))), React.createElement(\"aside\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"user-description\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62\n    },\n    __self: this\n  }, React.createElement(Edit, {\n    active: editable,\n    type: \"textarea\",\n    onChange: onChange.bind('description'),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63\n    },\n    __self: this\n  }, React.createElement(\"p\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64\n    },\n    __self: this\n  }, profile.description))), withGeneres && React.createElement(\"div\", {\n    className: \"generes\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68\n    },\n    __self: this\n  }, React.createElement(\"ul\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69\n    },\n    __self: this\n  }, profile.generes && profile.generes.length && profile.generes.map(genereWrapper => React.createElement(\"li\", {\n    key: UUIDClass.genV1(),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72\n    },\n    __self: this\n  }, React.createElement(Link, {\n    to: linkToGenere(genereWrapper.genere.name),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73\n    },\n    __self: this\n  }, `${genereWrapper.genere.name} - ${genereWrapper.occurrence}`)))))));\n};\n\nconst mapStateToProps = state => ({\n  profile: state.profile.current\n});\n\nconst mapDispatchToProps = dispatch => ({\n  reqProfile: nickname => dispatch(reqUserProfile(nickname))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(UserProfile);","map":{"version":3,"sources":["D:/PROJEKTY/APKI/dj-truck/src/pages/common/components/UserProfile/UserProfile.js"],"names":["React","useMemo","useEffect","useCallback","connect","Link","useLocation","reqUserProfile","useFormatRelative","Edit","UUIDClass","UserProfile","nickname","profile","reqProfile","withGeneres","editable","onChange","ifEmpty","location","formatRelative","user","parsePirctureUrl","url","startsWith","asid","match","groups","linkToGenere","genere","pathname","search","replace","bind","picture","createdAt","timezone","records","recordsTime","description","generes","length","map","genereWrapper","genV1","name","occurrence","mapStateToProps","state","current","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React, { useMemo, useEffect, useCallback } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { Link, useLocation } from \"react-router-dom\";\r\nimport { reqUserProfile } from \"./../../../../actions\";\r\nimport {useFormatRelative} from \"./../../Hooks/useFormatDate\"\r\nimport Edit from \"./Edit/Edit\";\r\nimport \"./user-profile.scss\"\r\nimport UUIDClass from \"uuidjs\";\r\n\r\nconst UserProfile = ({ nickname, profile, reqProfile, withGeneres, editable , onChange = ifEmpty => null }) => {\r\n    const location = useLocation();\r\n    const [formatRelative] = useFormatRelative();\r\n\r\n    useEffect(() => {\r\n        if (nickname && !profile || profile.user.nickname !== nickname) {\r\n            reqProfile(nickname);\r\n        }\r\n    }, [nickname, profile, reqProfile])\r\n\r\n    const parsePirctureUrl = useCallback((url) => {\r\n        if (url.startsWith(\"https://platform-lookaside.fbsbx.com\")) {\r\n            const asid = url.match(/asid=(?<asid>\\d+)/).groups.asid;\r\n            url = `https://graph.facebook.com/v2.5/${asid}/picture?type=large`\r\n        }\r\n        return url\r\n    }, [])\r\n\r\n    const linkToGenere = useCallback((genere)=>{\r\n        let {pathname, search} = location;\r\n        search = search.replace(/\\??\\&?generes=[^&]+/g, \"\")\r\n        return pathname + search + ((search) ? \"&\" : \"?\") + \"generes=\" + genere;\r\n    },[location])\r\n\r\n    if (!profile || !nickname) {\r\n        return null;\r\n    }\r\n\r\n    return (\r\n        <div className=\"user-profile\">\r\n            <main>\r\n            <div className=\"user-picture\">\r\n                <Edit active={editable} type=\"image\" onChange={onChange.bind('picture')}>\r\n                    <img src={parsePirctureUrl(profile.user.picture)} alt=\"User picture\" />\r\n                </Edit>\r\n            </div>\r\n            <section>\r\n                <div className=\"user-nickname\" >\r\n                    <Edit active={editable} type=\"text\" onChange={onChange.bind('nickname')} >\r\n                        <h4>{profile.user.nickname}</h4>\r\n                    </Edit>\r\n                </div>\r\n                <div className=\"user-joined\">\r\n                        <h5>{formatRelative(profile.user.createdAt, {timezone :true})}</h5>\r\n                </div>\r\n                <div className=\"user-record-stat\">\r\n                    <span>{`${profile.records} records`}</span>\r\n                    <span>{`${~~(profile.recordsTime / (60 * 1000)) } min`}</span>\r\n                </div>\r\n            </section>\r\n            </main>\r\n            <aside>\r\n            <div className=\"user-description\">\r\n                <Edit active={editable} type=\"textarea\" onChange={onChange.bind('description')}>\r\n                    <p>{profile.description}</p>\r\n                </Edit>\r\n            </div>\r\n           {withGeneres && \r\n           <div className=\"generes\">\r\n                    <ul>\r\n                        {profile.generes && profile.generes.length &&\r\n                            profile.generes.map( genereWrapper => (\r\n                                <li key={UUIDClass.genV1()}>\r\n                                    <Link to={linkToGenere(genereWrapper.genere.name)}>\r\n                                        {`${genereWrapper.genere.name} - ${genereWrapper.occurrence}`}\r\n                                    </Link>\r\n                                </li>\r\n                            ))\r\n                        }\r\n                    </ul>\r\n            </div>\t}\r\n            </aside>\r\n\r\n        </div>\r\n    )\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n    profile: state.profile.current\r\n})\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n    reqProfile: (nickname) => dispatch(reqUserProfile(nickname))\r\n})\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(UserProfile);\r\n\r\n"]},"metadata":{},"sourceType":"module"}