{"ast":null,"code":"import _slicedToArray from\"D:\\\\PROJEKTY\\\\APKI\\\\dj-truck\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import queryString from\"query-string\";import React,{useCallback,useEffect,useMemo,useState}from\"react\";import{Dropdown,DropdownButton}from\"react-bootstrap\";import{connect}from\"react-redux\";import{useHistory,useLocation,useParams}from\"react-router-dom\";import{reqRecs,setFooterType}from\"./../../actions\";import{useAuth0}from\"./../../auth0/react-auth0-spa\";import Pagin from\"./../common/components/Pagin/Pagin\";import PlayerControls from\"./../common/components/PlayerControls/PlayerControls\";import RecordsList from\"./../common/components/RecordList/RecordList\";import RecordSearch from\"./../common/components/RecordSearch/RecordSearch\";import UserProfile from\"./../common/components/UserProfile/UserProfile\";import{usePlayer}from\"./../common/Hooks/usePlayer\";import useRecordSearchUrl from\"./../common/Hooks/useRecordSearchURL\";import\"./user-records.scss\";var UserRecords=React.memo(function(_ref){var setFooter=_ref.setFooter,requestList=_ref.requestList,userId=_ref.userId,isCurrentUser=_ref.isCurrentUser,recordsList=_ref.recordsList,countAll=_ref.countAll;///-----------Turn of footer--------------------\nuseEffect(function(){setFooter(\"player\");},[setFooter]);//--------------------------------\nvar _usePlayer=usePlayer(),_usePlayer2=_slicedToArray(_usePlayer,2),controls=_usePlayer2[0],player=_usePlayer2[1];//-------------------------\nvar _useAuth=useAuth0(),loading=_useAuth.loading,isAuthenticated=_useAuth.isAuthenticated;var _useState=useState(\"Records\"),_useState2=_slicedToArray(_useState,2),pageTitle=_useState2[0],setPageTitle=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),displaySearch=_useState4[0],setSearchDisplaing=_useState4[1];var _useRecordSearchUrl=useRecordSearchUrl(),_useRecordSearchUrl2=_slicedToArray(_useRecordSearchUrl,1),getSerachUrl=_useRecordSearchUrl2[0];var history=useHistory();var _useParams=useParams(),nickname=_useParams.user,generes=_useParams.generes;var queryStr=useLocation().search;var _useMemo=useMemo(function(){var values=queryString.parse(queryStr);return{pageSize:+values.pageSize,page:+values.page,preloaded:values.preloaded,current:values.current,searchOpt:values.searchOpt,_generes:values.generes,search:values.search};},[queryStr]),pageSize=_useMemo.pageSize,page=_useMemo.page,preloaded=_useMemo.preloaded,searchOpt=_useMemo.searchOpt,_generes=_useMemo._generes,searchQuery=_useMemo.search;var _useState5=useState(20),_useState6=_slicedToArray(_useState5,2),_pageSize=_useState6[0],setPageSize=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),_page=_useState8[0],setPage=_useState8[1];useEffect(function(){if(preloaded&&recordsList.length>0||loading){return;}if(isAuthenticated&&!userId){return;}var pg=page||0;var pgSize=pageSize||_pageSize;var searchConsole=true;var where={};if(searchQuery){where.query=searchQuery;if(searchOpt){var opt=searchOpt.split(',');where.queryOpt=opt;}setPageTitle(\"Search: \"+searchQuery);}if(generes){where.genereNames=generes.split(\",\");}if(_generes){where.genereNames=_generes.split(\",\");}if(nickname){where.nickname=nickname;setPageTitle(nickname+\" user records\");searchConsole=false;}else if(userId&&isCurrentUser){where.userId=userId;setPageTitle(\"Your records\");searchConsole=false;}setSearchDisplaing(searchConsole);requestList(pgSize,pg,where);setPageSize(pgSize);setPage(pg);},[userId,requestList,_pageSize,page,pageSize,preloaded,setPageTitle,searchQuery,generes,_generes,loading,isAuthenticated,isCurrentUser,nickname,searchOpt,recordsList.length]);var getNextPageUrl=useCallback(function(page,pageSize){var url=window.location.pathname;url+='?pageSize='+pageSize;url+='&page='+page;var search=window.location.search;search=search.replace(/pageSize=\\d+/,'');search=search.replace(/&page=\\d+/,'');search=search.replace('?','&');url+=search;url=url.replace(/&{2,}/g,\"&\");return url;},[]);var changePageSize=useCallback(function(pageSize){history.push(getNextPageUrl(_page,pageSize));},[history,_page,getNextPageUrl]);var goToPage=useCallback(function(page){history.push(getNextPageUrl(page,_pageSize));},[history,_pageSize,getNextPageUrl]);var onSearch=useCallback(function(queryStr,searchOpt){if(!queryStr){history.push(\"/records\");}var url=getSerachUrl(queryStr,{searchOpt:searchOpt,searchParams:{generes:[generes,_generes]}});history.push(url);},[history,getSerachUrl,_generes,generes]);return React.createElement(\"div\",{className:\"user-records\"},nickname&&React.createElement(UserProfile,{nickname:nickname,withGeneres:true}),displaySearch&&React.createElement(RecordSearch,{title:\"Dj Truck Records\",onSearch:onSearch}),React.createElement(\"div\",{className:\"user-records-top-bar\"},React.createElement(\"h2\",{className:\"title\"},pageTitle),React.createElement(DropdownButton,{alignRight:true,className:\"btn-pagger\",title:_pageSize+\" on page \"},React.createElement(Dropdown.Item,{onClick:changePageSize.bind(null,10)},\" 10 \"),React.createElement(Dropdown.Item,{onClick:changePageSize.bind(null,20)},\" 20 \"),React.createElement(Dropdown.Item,{onClick:changePageSize.bind(null,30)},\" 30 \"),React.createElement(Dropdown.Item,{onClick:changePageSize.bind(null,50)},\" 50 \"),React.createElement(Dropdown.Item,{onClick:changePageSize.bind(null,75)},\" 75 \"),React.createElement(Dropdown.Item,{onClick:changePageSize.bind(null,100)},\" 100 \"))),React.createElement(RecordsList,{list:recordsList,controls:controls,player:player}),React.createElement(Pagin,{current:_page,call:goToPage,all:Math.floor(countAll/_pageSize)}),React.createElement(PlayerControls,{list:recordsList,controls:controls,player:player}));});var mapStateToProps=function mapStateToProps(state){return{recordsList:state.records.list,countAll:state.records.countAll,userId:state.user.dbId,userNickname:state.user.nickname};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{requestList:function requestList(pageSize,page,where){return dispatch(reqRecs(pageSize,page,where));},setFooter:function setFooter(type){return dispatch(setFooterType(type));}};};export default connect(mapStateToProps,mapDispatchToProps)(UserRecords);","map":{"version":3,"sources":["D:/PROJEKTY/APKI/dj-truck/src/pages/userRecords/UserRecords.js"],"names":["queryString","React","useCallback","useEffect","useMemo","useState","Dropdown","DropdownButton","connect","useHistory","useLocation","useParams","reqRecs","setFooterType","useAuth0","Pagin","PlayerControls","RecordsList","RecordSearch","UserProfile","usePlayer","useRecordSearchUrl","UserRecords","memo","setFooter","requestList","userId","isCurrentUser","recordsList","countAll","controls","player","loading","isAuthenticated","pageTitle","setPageTitle","displaySearch","setSearchDisplaing","getSerachUrl","history","nickname","user","generes","queryStr","search","values","parse","pageSize","page","preloaded","current","searchOpt","_generes","searchQuery","_pageSize","setPageSize","_page","setPage","length","pg","pgSize","searchConsole","where","query","opt","split","queryOpt","genereNames","getNextPageUrl","url","window","location","pathname","replace","changePageSize","push","goToPage","onSearch","searchParams","bind","Math","floor","mapStateToProps","state","records","list","dbId","userNickname","mapDispatchToProps","dispatch","type"],"mappings":"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","sourcesContent":["import queryString from \"query-string\";\r\nimport React, { useCallback, useEffect, useMemo, useState } from \"react\";\r\nimport { Dropdown, DropdownButton } from \"react-bootstrap\";\r\nimport { connect } from \"react-redux\";\r\nimport { useHistory, useLocation, useParams } from \"react-router-dom\";\r\nimport { reqRecs, setFooterType } from \"./../../actions\";\r\nimport { useAuth0 } from \"./../../auth0/react-auth0-spa\";\r\nimport Pagin from \"./../common/components/Pagin/Pagin\";\r\nimport PlayerControls from \"./../common/components/PlayerControls/PlayerControls\";\r\nimport RecordsList from \"./../common/components/RecordList/RecordList\";\r\nimport RecordSearch from \"./../common/components/RecordSearch/RecordSearch\";\r\nimport UserProfile from \"./../common/components/UserProfile/UserProfile\";\r\nimport { usePlayer } from \"./../common/Hooks/usePlayer\";\r\nimport useRecordSearchUrl from \"./../common/Hooks/useRecordSearchURL\";\r\nimport \"./user-records.scss\";\r\n\r\nconst UserRecords = React.memo(({\r\n    setFooter,\r\n    requestList,\r\n    userId,\r\n    isCurrentUser,\r\n   // searchQuery,\r\n    recordsList,\r\n    countAll }) => {\r\n    ///-----------Turn of footer--------------------\r\n\r\n    useEffect(() => {\r\n        setFooter(\"player\")\r\n    }, [setFooter])\r\n    //--------------------------------\r\n\r\n    const [controls, player] = usePlayer();\r\n    //-------------------------\r\n    const { loading, isAuthenticated } = useAuth0();\r\n    const [pageTitle, setPageTitle] = useState(\"Records\");\r\n    const [displaySearch, setSearchDisplaing] = useState(false);\r\n    const [getSerachUrl] = useRecordSearchUrl();\r\n    const history = useHistory();\r\n    const { user: nickname, generes } = useParams();\r\n\r\n\r\n    const queryStr = useLocation().search;\r\n    let { pageSize, page, preloaded, searchOpt, _generes , search:searchQuery} = useMemo(() => {\r\n        const values = queryString.parse(queryStr)\r\n        return {\r\n            pageSize: +values.pageSize,\r\n            page: +values.page,\r\n            preloaded: values.preloaded,\r\n            current: values.current,\r\n            searchOpt: values.searchOpt,\r\n            _generes: values.generes,\r\n            search: values.search\r\n        }\r\n    }, [queryStr])\r\n\r\n    const [_pageSize, setPageSize] = useState(20);\r\n    const [_page, setPage] = useState(0);\r\n\r\n\r\n    useEffect(() => {\r\n        if ((preloaded && recordsList.length > 0) || loading) { return }\r\n\r\n        if (isAuthenticated && !userId) { return }\r\n        let pg = page || 0;\r\n        let pgSize = pageSize || _pageSize;\r\n\r\n        let searchConsole = true;\r\n\r\n        const where = {};\r\n        if (searchQuery) {\r\n            where.query = searchQuery;\r\n            if (searchOpt) {\r\n                let opt = searchOpt.split(',');\r\n                where.queryOpt = opt;\r\n            }\r\n            setPageTitle(\"Search: \" + searchQuery)\r\n\r\n        }\r\n\r\n        if (generes) {\r\n            where.genereNames = generes.split(\",\");\r\n        }\r\n         \r\n        if(_generes){\r\n            where.genereNames = _generes.split(\",\")\r\n        }\r\n\r\n        if (nickname) {\r\n            where.nickname = nickname;\r\n            setPageTitle(nickname + \" user records\")\r\n            searchConsole = false;\r\n        } else if (userId && isCurrentUser) {\r\n            where.userId = userId;\r\n            setPageTitle(\"Your records\")\r\n            searchConsole = false;\r\n        }\r\n        \r\n\r\n        setSearchDisplaing(searchConsole);\r\n\r\n        requestList(pgSize, pg, where);\r\n        setPageSize(pgSize);\r\n        setPage(pg)\r\n\r\n    }, [userId,\r\n        requestList,\r\n        _pageSize,\r\n        page,\r\n        pageSize,\r\n        preloaded,\r\n        setPageTitle,\r\n        searchQuery,\r\n        generes,\r\n        _generes,\r\n        loading,\r\n        isAuthenticated,\r\n        isCurrentUser,\r\n        nickname,\r\n        searchOpt,\r\n        recordsList.length,\r\n    ])\r\n\r\n    const getNextPageUrl = useCallback((page, pageSize) => {\r\n        let url = window.location.pathname;\r\n        url += '?pageSize=' + pageSize;\r\n        url += '&page=' + page;\r\n        let search = window.location.search;\r\n        search = search.replace(/pageSize=\\d+/, '');\r\n        search = search.replace(/&page=\\d+/, '');\r\n        search = search.replace('?', '&');\r\n        url += search;\r\n        url = url.replace(/&{2,}/g, \"&\");\r\n        return url;\r\n    }, [])\r\n\r\n    const changePageSize = useCallback((pageSize) => {\r\n        history.push(getNextPageUrl(_page, pageSize));\r\n    }, [history, _page, getNextPageUrl])\r\n\r\n    const goToPage = useCallback((page) => {\r\n        history.push(getNextPageUrl(page, _pageSize))\r\n    }, [history, _pageSize, getNextPageUrl])\r\n\r\n    const onSearch = useCallback((queryStr, searchOpt) => {\r\n        if(!queryStr){\r\n            history.push(\"/records\")\r\n        }\r\n        const url = getSerachUrl(queryStr, {\r\n            searchOpt,\r\n            searchParams: { generes: [generes, _generes] }\r\n        })\r\n\r\n        history.push(url);\r\n    }, [history, getSerachUrl, _generes, generes])\r\n\r\n    \r\n    return (\r\n        <div className=\"user-records\">\r\n            {nickname && <UserProfile nickname={nickname} withGeneres/>}\r\n            {displaySearch && <RecordSearch title=\"Dj Truck Records\" onSearch={onSearch} />}\r\n            <div className=\"user-records-top-bar\">\r\n                <h2 className=\"title\">{pageTitle}</h2>\r\n                <DropdownButton\r\n                    alignRight\r\n                    className=\"btn-pagger\"\r\n                    title={_pageSize + \" on page \"}>\r\n                    <Dropdown.Item onClick={changePageSize.bind(null, 10)}> 10 </Dropdown.Item>\r\n                    <Dropdown.Item onClick={changePageSize.bind(null, 20)}> 20 </Dropdown.Item>\r\n                    <Dropdown.Item onClick={changePageSize.bind(null, 30)}> 30 </Dropdown.Item>\r\n                    <Dropdown.Item onClick={changePageSize.bind(null, 50)}> 50 </Dropdown.Item>\r\n                    <Dropdown.Item onClick={changePageSize.bind(null, 75)}> 75 </Dropdown.Item>\r\n                    <Dropdown.Item onClick={changePageSize.bind(null, 100)}> 100 </Dropdown.Item>\r\n                </DropdownButton>\r\n            </div>\r\n\r\n            <RecordsList\r\n                list={recordsList}\r\n                controls={controls}\r\n                player={player} />\r\n            <Pagin\r\n                current={_page}\r\n                call={goToPage}\r\n                all={Math.floor(countAll / _pageSize)} />\r\n            <PlayerControls\r\n                list={recordsList}\r\n                controls={controls}\r\n                player={player} />\r\n        </div>\r\n    )\r\n    \r\n\r\n\r\n})\r\n\r\nconst mapStateToProps = state => ({\r\n    recordsList: state.records.list,\r\n    countAll: state.records.countAll,\r\n    userId: state.user.dbId,\r\n    userNickname: state.user.nickname,\r\n})\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n    requestList: (pageSize, page, where) => dispatch(reqRecs(pageSize, page, where)),\r\n    setFooter : (type) => dispatch(setFooterType(type))\r\n})\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(UserRecords)\r\n"]},"metadata":{},"sourceType":"module"}