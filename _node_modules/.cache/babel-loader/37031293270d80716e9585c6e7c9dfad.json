{"ast":null,"code":"var _jsxFileName = \"D:\\\\PROJEKTY\\\\APKI\\\\dj-truck\\\\src\\\\pages\\\\common\\\\components\\\\Carousel-slider\\\\Slider.js\";\nimport React, { useCallback, useEffect, useRef, useState } from \"react\";\nimport UUID from \"uuidjs\";\nimport style from \"./slider.scss\";\n\nconst rmLast = (arr, direction) => {\n  let last = arr.length - 1;\n  let _arr = [...arr];\n\n  while (last >= 0) {\n    if (direction === \"next\" && arr[last] < 0) break;\n    if (direction === \"prev\" && arr[last] > 0) break;\n\n    _arr.pop();\n\n    last--;\n  }\n\n  return _arr;\n};\n\nconst sumLastSameDirection = arr => {\n  let _arr = [...arr];\n\n  if (arr[arr.length - 1] * arr[arr.length - 2] > 0) {\n    let last = _arr.pop();\n\n    let prev = _arr.pop();\n\n    _arr.push(last + prev);\n  }\n\n  return _arr;\n};\n\nconst Slider = ({\n  slides: initSlides,\n  next: nextHandle,\n  prev: prevHandle,\n  minSlideWidth = style.minSlideWidth\n}) => {\n  const slider = useRef();\n  const [_containerRect, setContainerRect] = useState(null);\n  const [slideWidth, setSlideWidth] = useState(null);\n  const [visibleSlides, setVisibleSlides] = useState(null);\n  const [slides, setSlides] = useState([...initSlides, ...initSlides, ...initSlides]);\n  const [isTransitionActive, setTransitionActive] = useState(false);\n  const [actionQueue, setActionQueue] = useState([]);\n  const shift = useRef();\n  const translate = useRef();\n  const containerRect = useCallback(() => {\n    if (!slider.current) return 0;\n    let rect = _containerRect;\n\n    if (!rect) {\n      rect = slider.current.parentElement.getBoundingClientRect();\n      setContainerRect(rect);\n    }\n\n    return rect;\n  }, [_containerRect, setContainerRect]);\n  const setTransition = useCallback(value => {\n    if (!slider.current) return;\n\n    if (value) {\n      slider.current.classList.add(\"slider-transition--active\");\n      return;\n    }\n\n    slider.current.classList.remove(\"slider-transition--active\");\n  }, [slider]);\n  useEffect(() => {\n    const transitionEnd = () => setTransitionActive(false);\n\n    window.addEventListener(\"transitionend\", transitionEnd);\n    window.addEventListener(\"mozTransitionEnd\", transitionEnd);\n    window.addEventListener(\"webkitTransitionEnd\", transitionEnd);\n    window.addEventListener(\"oTransitionEnd\", transitionEnd);\n    return () => {\n      window.removeEventListener(\"transitionend\", transitionEnd);\n      window.removeEventListener(\"mozTransitionEnd\", transitionEnd);\n      window.removeEventListener(\"webkitTransitionEnd\", transitionEnd);\n      window.removeEventListener(\"oTransitionEnd\", transitionEnd);\n    };\n  }, [setTransitionActive]);\n  const setTranslate = useCallback(target => {\n    if (!slider.current) return;\n    slider.current.style.transform = `translateX(${target}px)`;\n    translate.current = target;\n  }, [slider, translate]);\n  const setPosition = useCallback(position => {\n    if (!slider.current) return;\n    setTranslate(position * slideWidth);\n    setTransitionActive(true);\n  }, [slider, slideWidth, setTransitionActive, setTranslate]);\n  useEffect(() => {\n    shift.current = -initSlides.length;\n    setPosition(shift.current);\n  }, [slideWidth, setPosition, shift, initSlides]);\n  useEffect(() => {\n    const resetSize = () => setContainerRect(null);\n\n    window.addEventListener(\"resize\", resetSize);\n    return () => window.removeEventListener(\"resize\", resetSize);\n  }, [setContainerRect]);\n  useEffect(() => {\n    if (!containerRect() || !minSlideWidth || !slider.current) return;\n    const containerWidth = containerRect().width;\n    const visibleSlides = ~~(containerWidth / parseInt(minSlideWidth));\n    const slideWidth = containerWidth / visibleSlides;\n    setSlideWidth(slideWidth);\n    setVisibleSlides(visibleSlides);\n    slider.current.style.width = slideWidth * slider.current.children.length + \"px\";\n  }, [containerRect, minSlideWidth, setSlideWidth, setVisibleSlides]);\n  const appendSlides = useCallback(amount => {\n    setSlides(slides => {\n      const _slides = [...slides];\n\n      for (let i = 0; i < amount; i++) {\n        const slide = _slides.shift();\n\n        _slides.push(slide);\n      }\n\n      return _slides;\n    });\n  }, [setSlides]);\n  const prependSlides = useCallback(amount => {\n    setSlides(slides => {\n      const _slides = [...slides];\n\n      for (let i = 0; i < amount; i++) {\n        const slide = _slides.pop();\n\n        _slides.unshift(slide);\n      }\n\n      return _slides;\n    });\n  }, [setSlides]);\n  const balance = useCallback(() => {}, []);\n  const action = useCallback(() => {\n    if (!actionQueue.length) return;\n    const queue = actionQueue;\n    const direction = queue.shift();\n    setTransition(false);\n    direction > 0 ? appendSlides(direction) : prependSlides(Math.abs(direction));\n    setPosition(shift.current + direction);\n    setTimeout(() => {\n      setTransition(true);\n      setPosition(shift.current);\n      setActionQueue(queue);\n    }, 0);\n  }, [setTransition, setPosition, actionQueue, setActionQueue]);\n  useEffect(() => {\n    if (!isTransitionActive) {\n      action();\n    }\n  }, [isTransitionActive, actionQueue]);\n  const next = useCallback(() => {\n    setActionQueue(queue => {\n      const _queue = rmLast(queue, \"prev\");\n\n      return sumLastSameDirection([..._queue, 1]);\n    });\n  }, [setActionQueue]);\n  useEffect(() => nextHandle && nextHandle(next), [next, nextHandle]);\n  const prev = useCallback(() => {\n    setActionQueue(queue => {\n      const _queue = rmLast(queue, \"next\");\n\n      return sumLastSameDirection([..._queue, -1]);\n    });\n  }, [setActionQueue]);\n  useEffect(() => prevHandle && prevHandle(prev), [prev, prevHandle]);\n  const endDraging = useCallback(() => {\n    shift.current = Math.round(translate.current / slideWidth);\n    setPosition(shift.current);\n  }, [translate, setTranslate, shift, slideWidth]);\n  const mouseMove = useCallback((shiftX, event) => {\n    setTranslate(event.clientX - shiftX);\n  }, [setTranslate]);\n  const mouseDown = useCallback(event => {\n    const sliderContainer = event.target.closest(\".carousel-slider-container\");\n    const rect = sliderContainer.getBoundingClientRect();\n    const shiftX = event.clientX - rect.left - shift.current * slideWidth;\n    const mouseMoveWithArgs = mouseMove.bind(null, shiftX);\n\n    const mouseUp = () => {\n      window.removeEventListener(\"mousemove\", mouseMoveWithArgs);\n      window.removeEventListener(\"mouseup\", mouseUp);\n      setTransition(true);\n      endDraging();\n    };\n\n    window.addEventListener(\"mousemove\", mouseMoveWithArgs);\n    window.addEventListener(\"mouseup\", mouseUp);\n    setTransition(false);\n  }, [setTransition, shift, slideWidth, endDraging]);\n  console.log(\"sift\", shift.current);\n  return React.createElement(\"div\", {\n    className: \"carousel-slider-container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201\n    },\n    __self: this\n  }, React.createElement(\"ul\", {\n    className: \"carousel-slider\",\n    ref: slider,\n    onMouseDown: mouseDown,\n    onDrag: e => e.preventDefault(),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202\n    },\n    __self: this\n  }, slides && slides instanceof Array && slides.map(slide => React.createElement(\"li\", {\n    key: UUID.genV1(),\n    className: \"slide\",\n    style: {\n      width: minSlideWidth || \"initial\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204\n    },\n    __self: this\n  }, slide))));\n};\n\nexport default Slider;","map":{"version":3,"sources":["D:/PROJEKTY/APKI/dj-truck/src/pages/common/components/Carousel-slider/Slider.js"],"names":["React","useCallback","useEffect","useRef","useState","UUID","style","rmLast","arr","direction","last","length","_arr","pop","sumLastSameDirection","prev","push","Slider","slides","initSlides","next","nextHandle","prevHandle","minSlideWidth","slider","_containerRect","setContainerRect","slideWidth","setSlideWidth","visibleSlides","setVisibleSlides","setSlides","isTransitionActive","setTransitionActive","actionQueue","setActionQueue","shift","translate","containerRect","current","rect","parentElement","getBoundingClientRect","setTransition","value","classList","add","remove","transitionEnd","window","addEventListener","removeEventListener","setTranslate","target","transform","setPosition","position","resetSize","containerWidth","width","parseInt","children","appendSlides","amount","_slides","i","slide","prependSlides","unshift","balance","action","queue","Math","abs","setTimeout","_queue","endDraging","round","mouseMove","shiftX","event","clientX","mouseDown","sliderContainer","closest","left","mouseMoveWithArgs","bind","mouseUp","console","log","e","preventDefault","Array","map","genV1"],"mappings":"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","sourcesContent":["import React, {useCallback, useEffect, useRef, useState} from \"react\";\r\nimport UUID from \"uuidjs\";\r\nimport style from \"./slider.scss\"\r\n\r\nconst rmLast = (arr, direction) => {\r\n    let last = arr.length - 1;\r\n    let _arr = [...arr];\r\n    while (last >= 0) {\r\n        if (direction === \"next\" && arr[last] < 0) break;\r\n        if (direction === \"prev\" && arr[last] > 0) break;\r\n        _arr.pop();\r\n        last--;\r\n    }\r\n    return _arr;\r\n}\r\n\r\nconst sumLastSameDirection = arr => {\r\n    let _arr = [...arr];\r\n    if (arr[arr.length - 1] * arr[arr.length - 2] > 0) {\r\n        let last = _arr.pop();\r\n        let prev = _arr.pop();\r\n        _arr.push(last + prev);\r\n    }\r\n    return _arr;\r\n}\r\n\r\nconst Slider = ({slides: initSlides, next: nextHandle, prev: prevHandle, minSlideWidth = style.minSlideWidth}) => {\r\n    const slider = useRef();\r\n    const [_containerRect, setContainerRect] = useState(null);\r\n    const [slideWidth, setSlideWidth] = useState(null);\r\n    const [visibleSlides, setVisibleSlides] = useState(null);\r\n    const [slides, setSlides] = useState([...initSlides, ...initSlides, ...initSlides]);\r\n    const [isTransitionActive, setTransitionActive] = useState(false);\r\n    const [actionQueue, setActionQueue] = useState([]);\r\n    const shift = useRef();\r\n    const translate = useRef();\r\n\r\n    const containerRect = useCallback(() => {\r\n        if (!slider.current) return 0;\r\n        let rect = _containerRect\r\n        if (!rect) {\r\n            rect = slider.current.parentElement.getBoundingClientRect()\r\n            setContainerRect(rect);\r\n        }\r\n        return rect;\r\n    }, [_containerRect, setContainerRect])\r\n\r\n    const setTransition = useCallback(value => {\r\n        if (!slider.current) return;\r\n        if (value) {\r\n            slider.current.classList.add(\"slider-transition--active\")\r\n            return\r\n        }\r\n        slider.current.classList.remove(\"slider-transition--active\")\r\n    }, [slider])\r\n\r\n\r\n    useEffect(() => {\r\n        const transitionEnd = () => setTransitionActive(false);\r\n        window.addEventListener(\"transitionend\", transitionEnd);\r\n        window.addEventListener(\"mozTransitionEnd\", transitionEnd);\r\n        window.addEventListener(\"webkitTransitionEnd\", transitionEnd);\r\n        window.addEventListener(\"oTransitionEnd\", transitionEnd);\r\n        return () => {\r\n            window.removeEventListener(\"transitionend\", transitionEnd);\r\n            window.removeEventListener(\"mozTransitionEnd\", transitionEnd);\r\n            window.removeEventListener(\"webkitTransitionEnd\", transitionEnd);\r\n            window.removeEventListener(\"oTransitionEnd\", transitionEnd);\r\n        }\r\n    }, [setTransitionActive])\r\n\r\n    const setTranslate = useCallback(target => {\r\n        if (!slider.current) return;\r\n        slider.current.style.transform = `translateX(${target}px)`\r\n        translate.current = target;\r\n    }, [slider, translate])\r\n\r\n    const setPosition = useCallback(position => {\r\n        if (!slider.current) return;\r\n        setTranslate(position * slideWidth)\r\n        setTransitionActive(true);\r\n    }, [slider, slideWidth, setTransitionActive, setTranslate])\r\n\r\n\r\n    useEffect(() => {\r\n        shift.current = -initSlides.length;\r\n        setPosition(shift.current);\r\n    }, [slideWidth, setPosition, shift, initSlides])\r\n\r\n    useEffect(() => {\r\n        const resetSize = () => setContainerRect(null);\r\n        window.addEventListener(\"resize\", resetSize);\r\n        return () => window.removeEventListener(\"resize\", resetSize);\r\n    }, [setContainerRect])\r\n\r\n    useEffect(() => {\r\n        if (!containerRect() || !minSlideWidth || !slider.current) return;\r\n        const containerWidth = containerRect().width;\r\n        const visibleSlides = ~~(containerWidth / parseInt(minSlideWidth));\r\n        const slideWidth = containerWidth / visibleSlides\r\n        setSlideWidth(slideWidth);\r\n        setVisibleSlides(visibleSlides);\r\n        slider.current.style.width = slideWidth * slider.current.children.length + \"px\";\r\n    }, [containerRect, minSlideWidth, setSlideWidth, setVisibleSlides]);\r\n\r\n    const appendSlides = useCallback(amount => {\r\n        setSlides(slides => {\r\n            const _slides = [...slides];\r\n            for (let i = 0; i < amount; i++) {\r\n                const slide = _slides.shift();\r\n                _slides.push(slide)\r\n            }\r\n            return _slides;\r\n        })\r\n    }, [setSlides])\r\n\r\n    const prependSlides = useCallback(amount => {\r\n        setSlides(slides => {\r\n            const _slides = [...slides];\r\n            for (let i = 0; i < amount; i++) {\r\n                const slide = _slides.pop();\r\n                _slides.unshift(slide)\r\n            }\r\n            return _slides;\r\n        })\r\n    }, [setSlides])\r\n\r\n    const balance = useCallback(() => {\r\n\r\n    }, [])\r\n\r\n    const action = useCallback(() => {\r\n        if (!actionQueue.length) return;\r\n        const queue = actionQueue;\r\n        const direction = queue.shift();\r\n        setTransition(false);\r\n        (direction > 0) ? appendSlides(direction) : prependSlides(Math.abs(direction));\r\n        setPosition(shift.current + direction);\r\n        setTimeout(() => {\r\n            setTransition(true);\r\n            setPosition(shift.current);\r\n            setActionQueue(queue)\r\n        }, 0)\r\n    }, [setTransition, setPosition, actionQueue, setActionQueue])\r\n\r\n    useEffect(() => {\r\n        if (!isTransitionActive) {\r\n            action();\r\n        }\r\n    }, [isTransitionActive, actionQueue])\r\n\r\n    const next = useCallback(() => {\r\n        setActionQueue(queue => {\r\n            const _queue = rmLast(queue, \"prev\");\r\n            return sumLastSameDirection([..._queue, 1])\r\n        })\r\n    }, [setActionQueue])\r\n\r\n    useEffect(() => nextHandle && nextHandle(next), [next, nextHandle])\r\n\r\n    const prev = useCallback(() => {\r\n        setActionQueue(queue => {\r\n            const _queue = rmLast(queue, \"next\");\r\n            return sumLastSameDirection([..._queue, -1])\r\n        })\r\n    }, [setActionQueue])\r\n\r\n    useEffect(() => prevHandle && prevHandle(prev), [prev, prevHandle])\r\n\r\n    const endDraging = useCallback(() => {\r\n        shift.current = Math.round(translate.current / slideWidth);\r\n        setPosition(shift.current);\r\n    }, [translate, setTranslate, shift, slideWidth])\r\n\r\n    const mouseMove = useCallback((shiftX, event) => {\r\n        setTranslate(event.clientX - shiftX);\r\n    }, [setTranslate])\r\n\r\n\r\n    const mouseDown = useCallback(event => {\r\n        const sliderContainer = event.target.closest(\".carousel-slider-container\");\r\n        const rect = sliderContainer.getBoundingClientRect();\r\n        const shiftX = event.clientX - rect.left - shift.current * slideWidth;\r\n        const mouseMoveWithArgs = mouseMove.bind(null, shiftX);\r\n\r\n        const mouseUp = () => {\r\n            window.removeEventListener(\"mousemove\", mouseMoveWithArgs);\r\n            window.removeEventListener(\"mouseup\", mouseUp);\r\n            setTransition(true);\r\n            endDraging();\r\n        }\r\n\r\n        window.addEventListener(\"mousemove\", mouseMoveWithArgs);\r\n        window.addEventListener(\"mouseup\", mouseUp);\r\n        setTransition(false);\r\n    }, [setTransition, shift, slideWidth, endDraging])\r\n\r\n    console.log(\"sift\" , shift.current)\r\n\r\n    return (\r\n        <div className=\"carousel-slider-container\">\r\n            <ul className=\"carousel-slider\" ref={slider} onMouseDown={mouseDown} onDrag={ e => e.preventDefault()}>\r\n                {slides && slides instanceof Array && slides.map(slide => (\r\n                    <li key={UUID.genV1()} className={\"slide\"} style={{width: minSlideWidth || \"initial\"}}>{slide}</li>\r\n                ))}\r\n            </ul>\r\n        </div>\r\n    )\r\n}\r\nexport default Slider;"]},"metadata":{},"sourceType":"module"}