{"ast":null,"code":"import _objectSpread from\"D:\\\\PROJEKTY\\\\APKI\\\\DjTruck\\\\djtruck\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"D:\\\\PROJEKTY\\\\APKI\\\\DjTruck\\\\djtruck\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"D:\\\\PROJEKTY\\\\APKI\\\\DjTruck\\\\djtruck\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"D:\\\\PROJEKTY\\\\APKI\\\\DjTruck\\\\djtruck\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"D:\\\\PROJEKTY\\\\APKI\\\\DjTruck\\\\djtruck\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";import _inherits from\"D:\\\\PROJEKTY\\\\APKI\\\\DjTruck\\\\djtruck\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import React from\"react\";import style from\"./knob.scss\";// Spec \n// witout any option Knob is standard with value from 0 to 100 and on inti value is 0\n// -initValue:number allow to set init value\n// -showValue props allows to display numeric value on knob\n// -diplayFormula : a callbac function with will be used to show value on knob\n// -scale:number allow to scale value eg. 10 give range from 0 to 10 \n// -symetric:boolean if this props is present knob havse valeu from -100 to 100 * scale \n// -unsymetric:{negative:number, positive:number} allows to set unsymetric range value : \n//  {positive : 5 } means that values bigger than 0 are divided by 5 range is from -100 to 20 * scale\n// -quantize:number switch knob to quantize mode in witch returned values are quantize to parametr \n//       eg: 2 returns value 100, 98 , 96 ... quantize:0.05 returns values 100, 99.95.... \n// -qunatize:{negative:number, positive:number} allows to set diffrent qunatizes for negative and positives values.\n// -responseFactor if is present adjust knob response on a mouse move // default= 1 eg responseFactor 2 will increase response two times\n// -alt if is present when mouse is over and knob is not draggin it will display alt value \nvar Knob=/*#__PURE__*/function(_React$Component){_inherits(Knob,_React$Component);function Knob(){var _getPrototypeOf2;var _this;_classCallCheck(this,Knob);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(Knob)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.state={value:0,position:0,// form 0 to 100\nsnapShotPostion:0,//\nrightArm:90,// form -60 to 90 - this is midle\nleftArm:90,// from 90 to 240 \ndotAngle:0,reversArm:false,//for not symetri linera gradient swap\nidDragged:false,isMouseOver:false,isActive:false};return _this;}_createClass(Knob,[{key:\"snap\",value:function snap(){this.setState(_objectSpread({},this.state,{snapShotPostion:this.state.position}));}},{key:\"normalizePostion\",value:function normalizePostion(position){if(this.props.symetric||this.props.unsymetric){return Math.min(Math.max(position,-100),100);}return Math.min(Math.max(position,0),100);}},{key:\"quantizePosition\",value:function quantizePosition(position){if(!this.props.quantize)return position;// value is quantaized \nreturn this.valueToPosition(this.evalValue(position));}},{key:\"valueToPosition\",value:function valueToPosition(value){var position=value;if(this.props.scale){position=value*100/this.props.scale;}if(this.props.unsymetric){if(this.props.unsymetric.positive&&value>0){var scale=this.props.unsymetric.positive;position=position*scale;}if(this.props.unsymetric.negative&&value<0){var _scale=this.props.unsymetric.negative;position=position*_scale;}}return position;}},{key:\"evalValue\",value:function evalValue(position){var value=position;if(this.props.scale){value=this.props.scale*position/100;}if(this.props.unsymetric){if(this.props.unsymetric.positive&&position>0){var scale=this.props.unsymetric.positive;value=value/scale;}if(this.props.unsymetric.negative&&position<0){var _scale2=this.props.unsymetric.negative;value=value/_scale2;}}if(this.props.quantize){var factor;if(typeof this.props.quantize===\"object\"){if(this.props.quantize.positive&&value>=0){factor=this.props.quantize.positive;}if(this.props.quantize.negative&&value<0){factor=this.props.quantize.negative;}}else if(typeof this.props.quantize===\"number\"){factor=this.props.quantize;}var rest=value%factor;value=value-rest;}//rounding \nreturn Math.floor(value*1000000)/1000000;}},{key:\"setPostion\",value:function setPostion(position){var _this2=this;this.setState(_objectSpread({},this.state,{position:this.normalizePostion(position)}),function(){_this2.mapPostionToArms(_this2.state.position);});this.setState(_objectSpread({},this.state,{value:this.evalValue(this.state.position)}));this.props.onChange&&this.props.onChange(this.state.value);}},{key:\"mapPostionToArms\",value:function mapPostionToArms(position){var rightArm,leftArm,dotAngle;var reversArm=false;position=this.quantizePosition(position);if(this.props.symetric||this.props.unsymetric){rightArm=88;leftArm=92;dotAngle=position*1.4;if(position<-2){rightArm=90-Math.abs(position)*1.5;leftArm=90;}else if(position>2){rightArm=90;leftArm=90+position*1.5;}}else{rightArm=-60;leftArm=-60;dotAngle=-150+position*2.95;console.log(position);leftArm+=position*3;if(position>60){reversArm=true;leftArm=-240+(position-60)*3;rightArm=-240;}}this.setState(_objectSpread({},this.state,{rightArm:rightArm,leftArm:leftArm,dotAngle:dotAngle,reversArm:reversArm}));}// -------------- events below\n},{key:\"mouseDown\",value:function mouseDown(event){var _this3=this;var startY=event.clientY;var mouseMove=this.mouseMove.bind(this,startY);this.snap();var removeListener=function removeListener(){document.body.removeEventListener('mousemove',mouseMove);document.body.removeEventListener('mouseup',removeListener);document.body.removeEventListener('mouseleave',removeListener);_this3.setState(_objectSpread({},_this3.setState,{isDragged:false}),function(){if(!_this3.state.isDragged&&!_this3.state.isMouseOver){_this3.setState(_objectSpread({},_this3.state,{isActive:false}));}});};document.body.addEventListener('mousemove',mouseMove);document.body.addEventListener('mouseup',removeListener);document.body.addEventListener('mouseleave',removeListener);this.setState(_objectSpread({},this.setState,{isDragged:true,isActive:true}));}},{key:\"mouseMove\",value:function mouseMove(startY,event){event.stopPropagation();var responsFactor=this.props.responsFactor||1;var position=this.state.snapShotPostion-(event.clientY-startY)*responsFactor;this.setPostion(position);}},{key:\"mouseEnter\",value:function mouseEnter(){var _this4=this;this.setState(_objectSpread({},this.setState,{isMouseOver:true}),function(){if(_this4.state.isDragged||_this4.state.isMouseOver){_this4.setState(_objectSpread({},_this4.state,{isActive:true}));}});}},{key:\"mouseLeve\",value:function mouseLeve(){var _this5=this;this.setState(_objectSpread({},this.setState,{isMouseOver:false}),function(){if(!_this5.state.isDragged&&!_this5.state.isMouseOver){_this5.setState(_objectSpread({},_this5.state,{isActive:false}));}});}//----------------compontent metod\n},{key:\"componentDidMount\",value:function componentDidMount(){var _this6=this;var position=this.state.position;if(this.props.initValue){position=this.valueToPosition(this.props.initValue);}this.setState(_objectSpread({},this.state,{position:position}),function(){_this6.mapPostionToArms(position);});}},{key:\"render\",value:function render(){var value=\"\";if(this.state.isMouseOver&&!this.state.isDragged&&this.props.alt){value=this.props.alt.substr(0,4).toUpperCase();}else{if(this.props.showValue){value=this.evalValue(this.state.position);}if(this.props.displayFormula){value=this.props.displayFormula(value);}}return React.createElement(\"div\",{className:\"knob \"+this.props.className,onMouseDown:this.mouseDown.bind(this),onDragStart:function onDragStart(e){return e.preventDefault();}},React.createElement(\"div\",{className:\"knob-big-circle\",style:{backgroundImage:\"linear-gradient(\"+(180+this.state.leftArm)+\"deg, \"+style.primaryDark+\" 50%, transparent 50%),\\n                                       linear-gradient(\"+(180+this.state.rightArm)+\"deg, transparent 50%, \"+style.primaryDark+\" 50%)\"}},React.createElement(\"div\",{className:\"half-circle half-right\",style:{transform:\"rotate(\"+this.state.leftArm+\"deg)\"},onMouseEnter:this.mouseEnter.bind(this),onMouseLeave:this.mouseLeve.bind(this)}),React.createElement(\"div\",{className:\"half-circle half-left \"+(this.state.reversArm?\"half--reverse\":\"\"),style:{transform:\"rotate(\"+this.state.rightArm+\"deg)\"},onMouseEnter:this.mouseEnter.bind(this),onMouseLeave:this.mouseLeve.bind(this)}),this.props.showValue&&React.createElement(\"div\",{className:\"knob-value \"+(this.state.isActive?\"knob--focus\":\"\"),onMouseEnter:this.mouseEnter.bind(this),onMouseLeave:this.mouseLeve.bind(this)},value)),React.createElement(\"div\",{className:\"knob-small-circle \"+(this.state.isActive?\"small-circle--focus\":\"\"),onMouseEnter:this.mouseEnter.bind(this),onMouseLeave:this.mouseLeve.bind(this)}),React.createElement(\"div\",{className:\"knob-dot\",style:{transform:'rotate('+this.state.dotAngle+'deg)'},onMouseEnter:this.mouseEnter.bind(this),onMouseLeave:this.mouseLeve.bind(this)}));}}]);return Knob;}(React.Component);export default Knob;","map":{"version":3,"sources":["D:/PROJEKTY/APKI/DjTruck/djtruck/src/components/common/Knob/Knob.js"],"names":["React","style","Knob","state","value","position","snapShotPostion","rightArm","leftArm","dotAngle","reversArm","idDragged","isMouseOver","isActive","setState","props","symetric","unsymetric","Math","min","max","quantize","valueToPosition","evalValue","scale","positive","negative","factor","rest","floor","normalizePostion","mapPostionToArms","onChange","quantizePosition","abs","console","log","event","startY","clientY","mouseMove","bind","snap","removeListener","document","body","removeEventListener","isDragged","addEventListener","stopPropagation","responsFactor","setPostion","initValue","alt","substr","toUpperCase","showValue","displayFormula","className","mouseDown","e","preventDefault","backgroundImage","primaryDark","transform","mouseEnter","mouseLeve","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport style from \"./knob.scss\";\r\n\r\n\r\n// Spec \r\n// witout any option Knob is standard with value from 0 to 100 and on inti value is 0\r\n// -initValue:number allow to set init value\r\n// -showValue props allows to display numeric value on knob\r\n// -diplayFormula : a callbac function with will be used to show value on knob\r\n// -scale:number allow to scale value eg. 10 give range from 0 to 10 \r\n// -symetric:boolean if this props is present knob havse valeu from -100 to 100 * scale \r\n// -unsymetric:{negative:number, positive:number} allows to set unsymetric range value : \r\n//  {positive : 5 } means that values bigger than 0 are divided by 5 range is from -100 to 20 * scale\r\n// -quantize:number switch knob to quantize mode in witch returned values are quantize to parametr \r\n//       eg: 2 returns value 100, 98 , 96 ... quantize:0.05 returns values 100, 99.95.... \r\n// -qunatize:{negative:number, positive:number} allows to set diffrent qunatizes for negative and positives values.\r\n// -responseFactor if is present adjust knob response on a mouse move // default= 1 eg responseFactor 2 will increase response two times\r\n// -alt if is present when mouse is over and knob is not draggin it will display alt value \r\n\r\nclass Knob extends React.Component{\r\n\r\n    state = {\r\n        value: 0,\r\n        position: 0, // form 0 to 100\r\n        snapShotPostion: 0,//\r\n\r\n        rightArm: 90, // form -60 to 90 - this is midle\r\n        leftArm: 90, // from 90 to 240 \r\n        dotAngle: 0,\r\n        reversArm: false,//for not symetri linera gradient swap\r\n\r\n        idDragged: false,\r\n        isMouseOver: false,\r\n        isActive: false,\r\n    }\r\n\r\n    snap(){\r\n        this.setState({...this.state, snapShotPostion: this.state.position})\r\n    }\r\n\r\n    normalizePostion(position){\r\n        if(this.props.symetric || this.props.unsymetric){\r\n            return Math.min(Math.max(position, -100), 100)\r\n        } \r\n        return Math.min(Math.max(position, 0), 100)\r\n    }\r\n\r\n    quantizePosition(position){\r\n        if(!this.props.quantize) \r\n            return position;\r\n\r\n         // value is quantaized \r\n         return this.valueToPosition(this.evalValue(position));\r\n\r\n    }\r\n\r\n    valueToPosition(value){\r\n        let position = value;\r\n        if(this.props.scale){\r\n            position = value * 100 / this.props.scale;\r\n        }\r\n\r\n\r\n        if(this.props.unsymetric){\r\n            if(this.props.unsymetric.positive && value > 0 ){\r\n                let scale = this.props.unsymetric.positive;\r\n                position = position * scale;\r\n            } \r\n            if(this.props.unsymetric.negative &&  value < 0){\r\n                let scale = this.props.unsymetric.negative;\r\n                position = position * scale;\r\n            }\r\n        }\r\n        return position;\r\n    }\r\n\r\n    evalValue(position){\r\n        let value = position;\r\n        \r\n        if(this.props.scale){\r\n            value = this.props.scale * position / 100 ;\r\n        } \r\n        \r\n        if(this.props.unsymetric){\r\n            if(this.props.unsymetric.positive && position > 0 ){\r\n                let scale = this.props.unsymetric.positive;\r\n                value = value / scale;\r\n            } \r\n            if(this.props.unsymetric.negative && position < 0){\r\n                let scale = this.props.unsymetric.negative;\r\n                value = value / scale;\r\n            }\r\n        }\r\n\r\n        if(this.props.quantize){\r\n            let factor; \r\n            if(typeof this.props.quantize === \"object\"){\r\n                if(this.props.quantize.positive && value >= 0 ){\r\n                    factor = this.props.quantize.positive;\r\n                } if(this.props.quantize.negative && value < 0){\r\n                    factor = this.props.quantize.negative;\r\n                }\r\n            } else if (typeof this.props.quantize === \"number\") {\r\n                factor = this.props.quantize;\r\n            }\r\n\r\n            const rest = value % factor;\r\n            value = value - rest;\r\n        }\r\n\r\n        //rounding \r\n        return Math.floor(value * 1000000) / 1000000;\r\n    }\r\n\r\n    setPostion(position){\r\n        this.setState({...this.state, position: this.normalizePostion(position)}, ()=>{\r\n            this.mapPostionToArms(this.state.position);\r\n        })\r\n\r\n        this.setState({...this.state, value: this.evalValue(this.state.position)});\r\n        (this.props.onChange && this.props.onChange(this.state.value))\r\n    }\r\n\r\n\r\n    mapPostionToArms(position){\r\n        let rightArm, leftArm, dotAngle;\r\n        let reversArm = false;\r\n        position = this.quantizePosition(position); \r\n\r\n        if(this.props.symetric || this.props.unsymetric){\r\n            rightArm = 88;\r\n            leftArm = 92; \r\n            dotAngle = position * 1.4;     \r\n            \r\n            if(position < -2 ) {\r\n                rightArm = 90 - Math.abs(position) * 1.5;\r\n                leftArm = 90;\r\n            } else if(position > 2 ){\r\n                rightArm = 90;\r\n                leftArm = 90 + position * 1.5;\r\n            }\r\n        } else {\r\n            rightArm = -60;\r\n            leftArm = -60; \r\n            dotAngle = -150 + position * 2.95;\r\n            console.log(position)\r\n            leftArm += position * 3;\r\n            if(position > 60) {\r\n                reversArm = true;\r\n                leftArm =  -240 + (position - 60) * 3;\r\n                rightArm =  -240 ;\r\n            }\r\n\r\n        }\r\n\r\n        this.setState({...this.state, rightArm, leftArm, dotAngle, reversArm});\r\n    }\r\n\r\n    // -------------- events below\r\n\r\n    mouseDown(event){\r\n        const startY = event.clientY;\r\n        let mouseMove = this.mouseMove.bind(this, startY);\r\n        this.snap();\r\n\r\n        const removeListener = () =>{\r\n            document.body.removeEventListener('mousemove', mouseMove);\r\n            document.body.removeEventListener('mouseup', removeListener);\r\n            document.body.removeEventListener('mouseleave', removeListener);\r\n            this.setState({...this.setState, isDragged: false}, ()=>{\r\n                if(!this.state.isDragged &&  !this.state.isMouseOver){\r\n                    this.setState({...this.state, isActive: false})\r\n                }\r\n            })\r\n            \r\n        }\r\n\r\n        document.body.addEventListener('mousemove', mouseMove)\r\n        document.body.addEventListener('mouseup', removeListener);\r\n        document.body.addEventListener('mouseleave', removeListener);\r\n        this.setState({...this.setState, isDragged: true, isActive:true})\r\n    }\r\n\r\n    mouseMove(startY, event){\r\n        event.stopPropagation();\r\n        let responsFactor = this.props.responsFactor || 1;\r\n        let position = this.state.snapShotPostion - (event.clientY  - startY) * responsFactor;\r\n        this.setPostion(position);\r\n    }\r\n\r\n    mouseEnter(){\r\n        this.setState({...this.setState, isMouseOver: true}, ()=>{\r\n            if(this.state.isDragged ||  this.state.isMouseOver){\r\n                this.setState({...this.state, isActive: true})\r\n            }\r\n        });\r\n    }\r\n\r\n    mouseLeve(){\r\n        this.setState({...this.setState, isMouseOver: false}, ()=>{\r\n            if(!this.state.isDragged &&  !this.state.isMouseOver){\r\n                this.setState({...this.state, isActive: false})\r\n            }\r\n        });\r\n    }\r\n\r\n    //----------------compontent metod\r\n    componentDidMount(){\r\n        let position = this.state.position;\r\n        if(this.props.initValue){\r\n            position = this.valueToPosition(this.props.initValue)\r\n        }\r\n        this.setState({...this.state, position : position}, ()=>{\r\n            this.mapPostionToArms(position);\r\n        })\r\n\r\n    }\r\n\r\n    render(){\r\n        let value = \"\"\r\n        if(this.state.isMouseOver && !this.state.isDragged && this.props.alt){\r\n            value = this.props.alt.substr(0,4).toUpperCase();\r\n        } else {\r\n            if(this.props.showValue){\r\n                value = this.evalValue(this.state.position)\r\n            }\r\n            if(this.props.displayFormula){\r\n                value = this.props.displayFormula(value);\r\n            }\r\n        }\r\n\r\n        \r\n        return (\r\n            <div className={\"knob \" + this.props.className}\r\n                onMouseDown={this.mouseDown.bind(this)}\r\n                onDragStart={ e => e.preventDefault()}>\r\n                <div className=\"knob-big-circle\" style={{\r\n                    backgroundImage : `linear-gradient(`+ (180 + this.state.leftArm)  +`deg, `+style.primaryDark+` 50%, transparent 50%),\r\n                                       linear-gradient(`+ (180 + this.state.rightArm) +`deg, transparent 50%, `+style.primaryDark+` 50%)`\r\n                }}>\r\n                    <div className=\"half-circle half-right\"\r\n                         style={{transform: `rotate(`+ this.state.leftArm +`deg)`}}\r\n                         onMouseEnter={ this.mouseEnter.bind(this)}\r\n                         onMouseLeave={ this.mouseLeve.bind(this)}/>\r\n                    <div className={\"half-circle half-left \" + ((this.state.reversArm) ?\"half--reverse\" : \"\" )}\r\n                         style={{transform: `rotate(`+ this.state.rightArm +`deg)`}}\r\n                         onMouseEnter={ this.mouseEnter.bind(this)}\r\n                         onMouseLeave={ this.mouseLeve.bind(this)}/>\r\n\r\n                    {( this.props.showValue && <div className={\"knob-value \" + ((this.state.isActive) ? \"knob--focus\" : \"\")}\r\n                        onMouseEnter={ this.mouseEnter.bind(this)}\r\n                        onMouseLeave={ this.mouseLeve.bind(this)}>\r\n                        { value }\r\n                    </div>)}\r\n                </div>\r\n                <div \r\n                    className={\"knob-small-circle \" + ((this.state.isActive) ? \"small-circle--focus\" : \"\")}\r\n                    onMouseEnter={ this.mouseEnter.bind(this) }\r\n                    onMouseLeave={ this.mouseLeve.bind(this) }\r\n                    />\r\n                <div className=\"knob-dot\"\r\n                    style={{transform: 'rotate('+ this.state.dotAngle + 'deg)'}}\r\n                    onMouseEnter={ this.mouseEnter.bind(this) }\r\n                    onMouseLeave={ this.mouseLeve.bind(this) }/>\r\n\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\n\r\nexport default Knob;"]},"metadata":{},"sourceType":"module"}