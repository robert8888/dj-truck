{"ast":null,"code":"var _jsxFileName = \"D:\\\\PROJEKTY\\\\APKI\\\\dj-truck\\\\src\\\\pages\\\\introduction\\\\Menu\\\\Menu.js\";\nimport React, { useCallback, useEffect, useMemo, useState } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { set } from \"lodash/object\";\nimport UUID from \"uuidjs\";\nimport \"./menu.scss\";\nimport usePath from \"../Hooks/usePath\";\n\nconst getMarkups = () => require.context('./../markups', true, /\\.*.md$/).keys();\n\nconst Menu = () => {\n  const [markups, setMarkups] = useState();\n  const [structure, setStructure] = useState();\n  const [currentPath] = usePath();\n  const escapeNumberRegex = useMemo(() => /^\\d?\\./, []);\n  useEffect(() => {\n    setMarkups(getMarkups());\n  }, [setMarkups]);\n  useEffect(() => {\n    if (!markups) return;\n    let _structure = {};\n    markups.forEach(item => {\n      let path = item.substr(2, item.length).split(\"/\").map(part => part.replace(\".md\", \"\"));\n      set(_structure, path, item);\n    });\n    setStructure(_structure);\n  }, [markups, setStructure]);\n  const target = useCallback(path => \"/introduction/\" + path.map(slug => slug.replace(escapeNumberRegex, \"\")).join(\"/\"), [escapeNumberRegex]);\n  const name = useCallback(path => path.map(slug => slug.replace(escapeNumberRegex, \"\")).join('-').replace(\" \", \"-\"), [escapeNumberRegex]);\n  const renderListItem = useCallback((path, slug) => {\n    return React.createElement(\"li\", {\n      key: UUID.genV1(),\n      className: \"menu__item menu__\" + name([...path, slug]),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 42\n      },\n      __self: this\n    }, React.createElement(Link, {\n      to: target([...path, slug]),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 44\n      },\n      __self: this\n    }, slug.replace(escapeNumberRegex, \"\")));\n  }, [name, escapeNumberRegex, target]);\n  const renderSublistItem = useCallback((path, slug, sublist, renderList) => {\n    return React.createElement(\"li\", {\n      key: UUID.genV1(),\n      className: \"menu__item menu__item--catalog menu__\" + name([...path, slug]),\n      onClick: e => {\n        e.stopPropagation();\n        e.target.closest(\"li\").classList.toggle(\"menu__item--open\");\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 53\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 59\n      },\n      __self: this\n    }, React.createElement(\"h6\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 60\n      },\n      __self: this\n    }, slug.replace(escapeNumberRegex, \"\")), React.createElement(\"i\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 63\n      },\n      __self: this\n    })), renderList(sublist, [...path, slug]));\n  }, [name, escapeNumberRegex]);\n  const renderList = useCallback((list, path = []) => {\n    const items = Object.entries(list).map(([key, value]) => {\n      if (typeof value === \"string\") {\n        return renderListItem(path, key);\n      } else if (typeof value === \"object\") {\n        return renderSublistItem(path, key, value, renderList);\n      }\n\n      return null;\n    });\n    return React.createElement(\"ul\", {\n      key: UUID.genV1(),\n      className: \"menu__list menu__list--depth-\" + path.length,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81\n      },\n      __self: this\n    }, items);\n  }, [renderSublistItem, renderListItem]);\n  const content = useMemo(() => {\n    if (!structure) return null;\n    return renderList(structure, []);\n  }, [structure, renderList()]);\n  useEffect(() => {\n    if (!content) return;\n    let current = [];\n\n    for (let i = 0; i < currentPath.length; i++) {\n      const selector = \".menu__\" + currentPath.slice(0, i + 1).join(\"-\").replace(\" \", \"-\");\n      current = current.concat(document.querySelector(selector) || []);\n    }\n\n    current.forEach(element => {\n      if (element.classList.contains(\"menu__item--catalog\")) {\n        element.classList.add(\"menu__item--open\");\n      }\n\n      element.classList.add(\"menu__item--current\");\n    });\n    return () => {\n      current.forEach(element => element.classList.remove(\"menu__item--current\"));\n    };\n  }, [content, currentPath]);\n  return React.createElement(\"aside\", {\n    className: \"introduction__menu\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112\n    },\n    __self: this\n  }, React.createElement(\"nav\", {\n    className: \"menu\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113\n    },\n    __self: this\n  }, content));\n};\n\nexport default Menu;","map":{"version":3,"sources":["D:/PROJEKTY/APKI/dj-truck/src/pages/introduction/Menu/Menu.js"],"names":["React","useCallback","useEffect","useMemo","useState","Link","set","UUID","usePath","getMarkups","require","context","keys","Menu","markups","setMarkups","structure","setStructure","currentPath","escapeNumberRegex","_structure","forEach","item","path","substr","length","split","map","part","replace","target","slug","join","name","renderListItem","genV1","renderSublistItem","sublist","renderList","e","stopPropagation","closest","classList","toggle","list","items","Object","entries","key","value","content","current","i","selector","slice","concat","document","querySelector","element","contains","add","remove"],"mappings":"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","sourcesContent":["import React, {useCallback, useEffect, useMemo, useState} from \"react\";\r\nimport {Link} from \"react-router-dom\";\r\nimport {set} from \"lodash/object\";\r\nimport UUID from \"uuidjs\";\r\nimport \"./menu.scss\"\r\nimport usePath from \"../Hooks/usePath\";\r\n\r\nconst getMarkups = () => require.context('./../markups', true, /\\.*.md$/).keys();\r\n\r\nconst Menu = () => {\r\n    const [markups, setMarkups] = useState();\r\n    const [structure, setStructure] = useState();\r\n    const [currentPath] = usePath();\r\n\r\n    const escapeNumberRegex = useMemo(() => /^\\d?\\./, [])\r\n\r\n    useEffect(() => {\r\n        setMarkups(getMarkups())\r\n    }, [setMarkups])\r\n\r\n    useEffect(() => {\r\n        if (!markups) return;\r\n        let _structure = {};\r\n        markups.forEach(item => {\r\n            let path = item.substr(2, item.length).split(\"/\")\r\n                .map(part => part.replace(\".md\", \"\"))\r\n            set(_structure, path, item)\r\n        });\r\n        setStructure(_structure);\r\n    }, [markups, setStructure])\r\n\r\n    const target = useCallback(path =>\r\n        \"/introduction/\" + path.map( slug => slug.replace(escapeNumberRegex, \"\")).join(\"/\")\r\n        , [escapeNumberRegex])\r\n\r\n    const name = useCallback( path =>\r\n        path.map( slug => slug.replace(escapeNumberRegex, \"\")).join('-').replace(\" \", \"-\")\r\n    , [escapeNumberRegex])\r\n\r\n    const renderListItem = useCallback((path, slug)=>{\r\n        return (\r\n            <li key={UUID.genV1()}\r\n                className={\"menu__item menu__\" + name([...path, slug])}>\r\n                <Link to={target([...path, slug])}>\r\n                    {slug.replace(escapeNumberRegex, \"\")}\r\n                </Link>\r\n            </li>\r\n        )\r\n    }, [name, escapeNumberRegex, target])\r\n\r\n    const renderSublistItem = useCallback((path, slug, sublist,  renderList) => {\r\n        return (\r\n            <li key={UUID.genV1()}\r\n                className={\"menu__item menu__item--catalog menu__\" + name([...path, slug])}\r\n                onClick={ e =>{\r\n                    e.stopPropagation();\r\n                    e.target.closest(\"li\").classList.toggle(\"menu__item--open\");\r\n                }}>\r\n                <div>\r\n                    <h6>\r\n                        {slug.replace(escapeNumberRegex, \"\")}\r\n                    </h6>\r\n                    <i/>\r\n                </div>\r\n                {renderList(sublist, [...path, slug])}\r\n            </li>\r\n        )\r\n    },[name, escapeNumberRegex])\r\n\r\n    const renderList = useCallback((list, path = []) => {\r\n        const items = Object.entries(list).map(([key, value]) => {\r\n            if (typeof value === \"string\") {\r\n                return renderListItem(path, key);\r\n            } else if (typeof value === \"object\") {\r\n                return renderSublistItem(path, key, value,  renderList);\r\n            }\r\n            return null;\r\n        });\r\n\r\n        return (\r\n             <ul key={UUID.genV1()}\r\n                 className={\"menu__list menu__list--depth-\" + path.length}>\r\n                    {items}\r\n             </ul>\r\n        )\r\n    }, [renderSublistItem, renderListItem])\r\n\r\n    const content = useMemo(()=>{\r\n        if(!structure) return null;\r\n        return renderList(structure, [])\r\n    }, [structure, renderList()])\r\n\r\n    useEffect(()=>{\r\n        if(!content) return;\r\n        let current = [];\r\n        for(let i= 0; i < currentPath.length; i++){\r\n            const selector = \".menu__\" + currentPath.slice(0, i + 1 ).join(\"-\").replace(\" \", \"-\")\r\n            current = current.concat(document.querySelector(selector)||[]);\r\n        }\r\n        current.forEach( element => {\r\n            if(element.classList.contains(\"menu__item--catalog\")){\r\n                element.classList.add(\"menu__item--open\")\r\n            }\r\n            element.classList.add(\"menu__item--current\")\r\n        });\r\n        return () => {\r\n            current.forEach( element => element.classList.remove(\"menu__item--current\"))\r\n        }\r\n    }, [content, currentPath])\r\n\r\n    return (\r\n        <aside className=\"introduction__menu\">\r\n            <nav className=\"menu\">\r\n                {content}\r\n            </nav>\r\n        </aside>\r\n    )\r\n}\r\n\r\nexport default Menu;"]},"metadata":{},"sourceType":"module"}