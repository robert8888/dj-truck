{"ast":null,"code":"import _regeneratorRuntime from\"D:\\\\PROJEKTY\\\\APKI\\\\dj-truck\\\\node_modules\\\\@babel\\\\runtime/regenerator\";var _marked=/*#__PURE__*/_regeneratorRuntime.mark(renameSelectedRequestSaga),_marked2=/*#__PURE__*/_regeneratorRuntime.mark(handel),_marked3=/*#__PURE__*/_regeneratorRuntime.mark(sendDataToApi);import{fork,put,select,takeEvery}from\"redux-saga/effects\";import{ACTIONS,pushLog}from\"../../actions\";import{getApi}from\"./../../apis/apiProvider\";import{Log}from\"./../../utils/logger/logger\";import errorParser from\"./../../utils/serverErrorParser/errorParser\";export default function renameSelectedRequestSaga(){return _regeneratorRuntime.wrap(function renameSelectedRequestSaga$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return takeEvery(ACTIONS.PL_SET_BPM_AND_OFFSET,handel);case 2:case\"end\":return _context.stop();}}},_marked);}function handel(action){return _regeneratorRuntime.wrap(function handel$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(typeof action.bpm===\"number\")){_context2.next=3;break;}_context2.next=3;return fork(sendDataToApi,action);case 3:case\"end\":return _context2.stop();}}},_marked2);}var getToken=function getToken(state){return state.user.token;};function sendDataToApi(action){var path,token,_getApi,callQuery,queries,variables,response;return _regeneratorRuntime.wrap(function sendDataToApi$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:path=['saga','playlist','request updated bpm and offset'];_context3.next=3;return select(getToken);case 3:token=_context3.sent;if(!token){_context3.next=21;break;}_context3.prev=5;_getApi=getApi(\"UserAssets\"),callQuery=_getApi.callQuery,queries=_getApi.queries;variables={id:action.id,bpm:action.bpm,offset:action.offset};_context3.next=10;return callQuery(queries.updateTrackQl,token,variables);case 10:response=_context3.sent;if(!response.errors){_context3.next=13;break;}throw new Error('Server response contains errors '+errorParser(response.errors));case 13:_context3.next=15;return put(pushLog(new Log(\"Track bpm and offset updated id:\"+action.id,path)));case 15:_context3.next=21;break;case 17:_context3.prev=17;_context3.t0=_context3[\"catch\"](5);_context3.next=21;return put(pushLog(Log.Error(path,\"Can't update bpm and offset\"+_context3.t0.message,\"Sorry. During process of updating track bpm occurred a problem\",_context3.t0)));case 21:case\"end\":return _context3.stop();}}},_marked3,null,[[5,17]]);}","map":{"version":3,"sources":["D:/PROJEKTY/APKI/dj-truck/src/sagas/playlists/reqUpdateBpmSaga.js"],"names":["renameSelectedRequestSaga","handel","sendDataToApi","fork","put","select","takeEvery","ACTIONS","pushLog","getApi","Log","errorParser","PL_SET_BPM_AND_OFFSET","action","bpm","getToken","state","user","token","path","callQuery","queries","variables","id","offset","updateTrackQl","response","errors","Error","message"],"mappings":"2JAMyBA,yB,iDAIfC,M,iDAQAC,a,EAlBV,OAASC,IAAT,CAAeC,GAAf,CAAoBC,MAApB,CAA4BC,SAA5B,KAA6C,oBAA7C,CACA,OAASC,OAAT,CAAkBC,OAAlB,KAAiC,eAAjC,CACA,OAASC,MAAT,KAAuB,0BAAvB,CACA,OAASC,GAAT,KAAoB,6BAApB,CACA,MAAOC,CAAAA,WAAP,KAAwB,6CAAxB,CAEA,cAAe,SAAUX,CAAAA,yBAAV,qJACX,MAAMM,CAAAA,SAAS,CAACC,OAAO,CAACK,qBAAT,CAAgCX,MAAhC,CAAf,CADW,sDAIf,QAAUA,CAAAA,MAAV,CAAiBY,MAAjB,yHACO,MAAOA,CAAAA,MAAM,CAACC,GAAd,GAAsB,QAD7B,4CAEQ,MAAMX,CAAAA,IAAI,CAACD,aAAD,CAAgBW,MAAhB,CAAV,CAFR,wDAMA,GAAME,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAAAC,KAAK,QAAIA,CAAAA,KAAK,CAACC,IAAN,CAAWC,KAAf,EAAtB,CAEA,QAAUhB,CAAAA,aAAV,CAAwBW,MAAxB,uLACUM,IADV,CACiB,CAAC,MAAD,CAAS,UAAT,CAAqB,gCAArB,CADjB,kBAEkB,MAAMd,CAAAA,MAAM,CAACU,QAAD,CAAZ,CAFlB,OAEUG,KAFV,oBAGOA,KAHP,oDAK4CT,MAAM,CAAC,YAAD,CALlD,CAKoBW,SALpB,SAKoBA,SALpB,CAKgCC,OALhC,SAKgCA,OALhC,CAMkBC,SANlB,CAM8B,CACdC,EAAE,CAAEV,MAAM,CAACU,EADG,CAEdT,GAAG,CAAED,MAAM,CAACC,GAFE,CAGdU,MAAM,CAAEX,MAAM,CAACW,MAHD,CAN9B,mBAY6B,MAAMJ,CAAAA,SAAS,CAACC,OAAO,CAACI,aAAT,CAAwBP,KAAxB,CAA+BI,SAA/B,CAAf,CAZ7B,QAYkBI,QAZlB,oBAaeA,QAAQ,CAACC,MAbxB,gCAcsB,IAAIC,CAAAA,KAAJ,CAAU,mCAAoCjB,WAAW,CAACe,QAAQ,CAACC,MAAV,CAAzD,CAdtB,2BAiBY,MAAMvB,CAAAA,GAAG,CAACI,OAAO,CAAC,GAAIE,CAAAA,GAAJ,CAAQ,mCAAqCG,MAAM,CAACU,EAApD,CAAwDJ,IAAxD,CAAD,CAAR,CAAT,CAjBZ,+GAmBY,MAAMf,CAAAA,GAAG,CAACI,OAAO,CAACE,GAAG,CAACkB,KAAJ,CACdT,IADc,CAEd,8BAAgC,aAAMU,OAFxB,CAGd,gEAHc,cAAD,CAAR,CAAT,CAnBZ","sourcesContent":["import { fork, put, select, takeEvery } from \"redux-saga/effects\";\r\nimport { ACTIONS, pushLog } from \"../../actions\";\r\nimport { getApi } from \"./../../apis/apiProvider\";\r\nimport { Log } from \"./../../utils/logger/logger\";\r\nimport errorParser from \"./../../utils/serverErrorParser/errorParser\";\r\n\r\nexport default function* renameSelectedRequestSaga() {\r\n    yield takeEvery(ACTIONS.PL_SET_BPM_AND_OFFSET, handel)\r\n}\r\n\r\nfunction* handel(action){\r\n    if(typeof action.bpm === \"number\"){\r\n        yield fork(sendDataToApi, action)\r\n    }\r\n}\r\n\r\nconst getToken = state => state.user.token;\r\n\r\nfunction* sendDataToApi(action) {\r\n    const path = ['saga', 'playlist', 'request updated bpm and offset']\r\n    const token = yield select(getToken);\r\n    if(token){\r\n        try{\r\n            const { callQuery , queries } = getApi(\"UserAssets\");\r\n            const variables = {\r\n                id: action.id,\r\n                bpm: action.bpm,\r\n                offset: action.offset\r\n            };\r\n            \r\n            const response = yield callQuery(queries.updateTrackQl, token, variables);\r\n            if(response.errors){\r\n                throw new Error('Server response contains errors '+ errorParser(response.errors))\r\n            }\r\n            \r\n            yield put(pushLog(new Log(\"Track bpm and offset updated id:\" + action.id, path)))\r\n        } catch (error){\r\n            yield put(pushLog(Log.Error(\r\n                path,\r\n                \"Can't update bpm and offset\" + error.message,\r\n                \"Sorry. During process of updating track bpm occurred a problem\",\r\n                error\r\n            )))\r\n        }\r\n    }\r\n}\r\n\r\n"]},"metadata":{},"sourceType":"module"}