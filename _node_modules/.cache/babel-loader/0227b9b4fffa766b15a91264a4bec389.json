{"ast":null,"code":"var _jsxFileName = \"D:\\\\PROJEKTY\\\\APKI\\\\dj-truck\\\\src\\\\pages\\\\userRecords\\\\UserRecords.js\";\nimport React, { useEffect, useContext, useState, useRef, useCallback, useMemo } from \"react\";\nimport { connect } from \"react-redux\";\nimport { reqRecOfUser } from \"./../../actions\";\nimport RecordsList from \"./../common/components/RecordList/RecordList\";\nimport { useRecordPlayer } from \"./../common/Hooks/useRecordPlayer\";\nimport PlayerControls from \"./../common/components/PlayerControls/PlayerControls\";\nimport LayoutContext from \"./../common/Layout/LayoutContext\";\nimport Pagin from \"./../common/components/Pagin/Pagin\";\nimport { DropdownButton, Dropdown } from \"react-bootstrap\";\nimport { useParams, useHistory, useLocation } from \"react-router-dom\";\nimport queryString from \"query-string\";\nimport \"./user-records.scss\";\n\nconst UserRecords = ({\n  requestList,\n  userId,\n  userNickname,\n  recordsList,\n  countAll\n}) => {\n  const [controls, player] = useRecordPlayer(); //-------------------------\n\n  const [pageTitle, setPageTitle] = useState(\"Records\");\n  const history = useHistory();\n  const {\n    user,\n    generes\n  } = useParams();\n  const queryStr = useLocation().search;\n  let {\n    pageSize,\n    page,\n    preloaded,\n    current\n  } = useMemo(() => {\n    const values = queryString.parse(queryStr);\n    return {\n      pageSize: +values.pageSize,\n      page: +values.page,\n      preloaded: values.preloaded,\n      current: values.current\n    };\n  }, [queryStr]);\n  const [_pageSize, setPageSize] = useState(20);\n  const [_page, setPage] = useState(0);\n  useEffect(() => {\n    if (preloaded && recordsList.length > 0) {\n      return;\n    }\n\n    if (current && userNickname) {\n      history.push(window.location.pathname + \"/\" + userNickname);\n    }\n\n    let pg = page || 0;\n    let pgSize = pageSize || _pageSize;\n    const where = {};\n\n    if (generes) {\n      where.genereNames = generes.split(\",\");\n    } else {\n      if (user) {\n        where.nickname = user;\n        setPageTitle(user + \" user records\");\n      } else if (userId) {\n        where.userId = userId;\n        setPageTitle(\"Your records\");\n      }\n    }\n\n    requestList(pgSize, pg, where);\n    setPageSize(pgSize);\n    setPage(pg);\n  }, [userId, requestList, _pageSize, page, pageSize, preloaded, setPageTitle, generes]);\n  const layoutContext = useContext(LayoutContext);\n  useEffect(() => {\n    layoutContext.setFooter(false);\n  }, [layoutContext]);\n  const changeTo = useCallback(pageSize => {\n    if (!userId) {\n      return;\n    }\n\n    history.push(window.location.pathname + '?pageSize=' + pageSize + \"&page=\" + _page);\n  }, [history, _page, userId, requestList]);\n  const goTo = useCallback(page => {\n    if (!userId) {\n      return;\n    }\n\n    history.push(window.location.pathname + '?pageSize=' + _pageSize + \"&page=\" + page);\n  }, [history, userId, _pageSize]);\n  return React.createElement(\"div\", {\n    className: \"user-records\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"user-records-top-bar\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89\n    },\n    __self: this\n  }, React.createElement(\"h2\", {\n    className: \"title\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90\n    },\n    __self: this\n  }, pageTitle), React.createElement(DropdownButton, {\n    alignRight: true,\n    className: \"btn-pagger\",\n    title: _pageSize + \" on page \",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91\n    },\n    __self: this\n  }, React.createElement(Dropdown.Item, {\n    onClick: changeTo.bind(null, 10),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95\n    },\n    __self: this\n  }, \" 10 \"), React.createElement(Dropdown.Item, {\n    onClick: changeTo.bind(null, 20),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96\n    },\n    __self: this\n  }, \" 20 \"), React.createElement(Dropdown.Item, {\n    onClick: changeTo.bind(null, 30),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97\n    },\n    __self: this\n  }, \" 30 \"), React.createElement(Dropdown.Item, {\n    onClick: changeTo.bind(null, 50),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98\n    },\n    __self: this\n  }, \" 50 \"), React.createElement(Dropdown.Item, {\n    onClick: changeTo.bind(null, 75),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99\n    },\n    __self: this\n  }, \" 75 \"), React.createElement(Dropdown.Item, {\n    onClick: changeTo.bind(null, 100),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100\n    },\n    __self: this\n  }, \" 100 \"))), React.createElement(RecordsList, {\n    list: recordsList,\n    controls: controls,\n    player: player,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104\n    },\n    __self: this\n  }), React.createElement(Pagin, {\n    current: _page,\n    call: goTo,\n    all: Math.floor(countAll / _pageSize),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108\n    },\n    __self: this\n  }), React.createElement(PlayerControls, {\n    list: recordsList,\n    controls: controls,\n    player: player,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112\n    },\n    __self: this\n  }));\n};\n\nconst mapStateToProps = state => ({\n  recordsList: state.records.list,\n  countAll: state.records.countAll,\n  userId: state.user.dbId,\n  userNickname: state.user.nickname\n});\n\nconst mapDispatchToProps = dispatch => ({\n  requestList: (pageSize, page, where) => dispatch(reqRecOfUser(pageSize, page, where))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(UserRecords);","map":{"version":3,"sources":["D:/PROJEKTY/APKI/dj-truck/src/pages/userRecords/UserRecords.js"],"names":["React","useEffect","useContext","useState","useRef","useCallback","useMemo","connect","reqRecOfUser","RecordsList","useRecordPlayer","PlayerControls","LayoutContext","Pagin","DropdownButton","Dropdown","useParams","useHistory","useLocation","queryString","UserRecords","requestList","userId","userNickname","recordsList","countAll","controls","player","pageTitle","setPageTitle","history","user","generes","queryStr","search","pageSize","page","preloaded","current","values","parse","_pageSize","setPageSize","_page","setPage","length","push","window","location","pathname","pg","pgSize","where","genereNames","split","nickname","layoutContext","setFooter","changeTo","goTo","bind","Math","floor","mapStateToProps","state","records","list","dbId","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React, { useEffect, useContext, useState, useRef, useCallback, useMemo } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { reqRecOfUser } from \"./../../actions\"\r\nimport RecordsList from \"./../common/components/RecordList/RecordList\";\r\nimport { useRecordPlayer } from \"./../common/Hooks/useRecordPlayer\";\r\nimport PlayerControls from \"./../common/components/PlayerControls/PlayerControls\";\r\nimport LayoutContext from \"./../common/Layout/LayoutContext\";\r\nimport Pagin from \"./../common/components/Pagin/Pagin\";\r\nimport { DropdownButton, Dropdown } from \"react-bootstrap\";\r\nimport { useParams, useHistory, useLocation } from \"react-router-dom\";\r\nimport queryString from \"query-string\";\r\nimport \"./user-records.scss\"\r\n\r\nconst UserRecords = ({ requestList, userId, userNickname, recordsList, countAll }) => {\r\n    const [controls, player] = useRecordPlayer();\r\n    //-------------------------\r\n    const [pageTitle, setPageTitle] = useState(\"Records\")\r\n    const history = useHistory();\r\n    const { user, generes } = useParams();\r\n    \r\n\r\n    const queryStr = useLocation().search;\r\n    let { pageSize, page, preloaded, current } = useMemo(() => {\r\n        const values = queryString.parse(queryStr)\r\n        return {\r\n            pageSize: +values.pageSize,\r\n            page: +values.page,\r\n            preloaded: values.preloaded,\r\n            current: values.current,\r\n        }\r\n    }, [queryStr])\r\n    const [_pageSize, setPageSize] = useState(20);\r\n    const [_page, setPage] = useState(0);\r\n\r\n\r\n    useEffect(() => {\r\n        if (preloaded && recordsList.length > 0) { return }\r\n\r\n        if(current && userNickname){\r\n            history.push(window.location.pathname + \"/\"+  userNickname)\r\n        }\r\n\r\n        let pg = page || 0;\r\n        let pgSize = pageSize || _pageSize;\r\n\r\n        const where = {};\r\n       \r\n        \r\n        if(generes){\r\n            where.genereNames = generes.split(\",\");\r\n        } else {\r\n            if (user) {\r\n                where.nickname = user;\r\n                setPageTitle(user + \" user records\")\r\n            } else if (userId) {\r\n                where.userId = userId;\r\n                setPageTitle(\"Your records\")\r\n            } \r\n        }\r\n\r\n        requestList(pgSize, pg, where);\r\n        setPageSize(pgSize);\r\n        setPage(pg)\r\n\r\n    }, [userId, requestList, _pageSize, page, pageSize, preloaded, setPageTitle, generes])\r\n\r\n    const layoutContext = useContext(LayoutContext);\r\n\r\n    useEffect(() => {\r\n        layoutContext.setFooter(false);\r\n    }, [layoutContext])\r\n\r\n    const changeTo = useCallback((pageSize) => {\r\n        if (!userId) {\r\n            return;\r\n        }\r\n        history.push( window.location.pathname + '?pageSize=' + pageSize + \"&page=\" + _page);\r\n    }, [history, _page, userId, requestList])\r\n\r\n    const goTo = useCallback((page) => {\r\n        if (!userId) {\r\n            return;\r\n        }\r\n        history.push( window.location.pathname + '?pageSize=' + _pageSize + \"&page=\" + page);\r\n    }, [history, userId, _pageSize])\r\n\r\n    return (\r\n        <div className=\"user-records\">\r\n            <div className=\"user-records-top-bar\">\r\n                <h2 className=\"title\">{pageTitle}</h2>\r\n                <DropdownButton\r\n                    alignRight\r\n                    className=\"btn-pagger\"\r\n                    title={_pageSize + \" on page \"}>\r\n                    <Dropdown.Item onClick={changeTo.bind(null, 10)}> 10 </Dropdown.Item>\r\n                    <Dropdown.Item onClick={changeTo.bind(null, 20)}> 20 </Dropdown.Item>\r\n                    <Dropdown.Item onClick={changeTo.bind(null, 30)}> 30 </Dropdown.Item>\r\n                    <Dropdown.Item onClick={changeTo.bind(null, 50)}> 50 </Dropdown.Item>\r\n                    <Dropdown.Item onClick={changeTo.bind(null, 75)}> 75 </Dropdown.Item>\r\n                    <Dropdown.Item onClick={changeTo.bind(null, 100)}> 100 </Dropdown.Item>\r\n                </DropdownButton>\r\n            </div>\r\n\r\n            <RecordsList\r\n                list={recordsList}\r\n                controls={controls}\r\n                player={player} />\r\n            <Pagin\r\n                current={_page}\r\n                call={goTo}\r\n                all={Math.floor(countAll / _pageSize)} />\r\n            <PlayerControls\r\n                list={recordsList}\r\n                controls={controls}\r\n                player={player} />\r\n        </div>\r\n    )\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n    recordsList: state.records.list,\r\n    countAll: state.records.countAll,\r\n    userId: state.user.dbId,\r\n    userNickname: state.user.nickname,\r\n})\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n    requestList: (pageSize, page, where) => dispatch(reqRecOfUser(pageSize, page, where))\r\n})\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(UserRecords)\r\n"]},"metadata":{},"sourceType":"module"}