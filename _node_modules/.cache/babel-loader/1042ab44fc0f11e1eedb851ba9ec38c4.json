{"ast":null,"code":"import { put, select, takeEvery } from \"redux-saga/effects\";\nimport { ACTIONS, pushDirContent, pushLog } from \"../../actions\";\nimport { getApi } from \"./../../apis/apiProvider\";\nimport { Log } from \"./../../utils/logger/logger\";\nexport default function* rootDirRequestSaga() {\n  yield takeEvery(ACTIONS.PL_ROOT_REQUEST, callApi);\n}\n\nconst getToken = state => state.user.token;\n\nfunction* callApi() {\n  const path = ['saga', 'playlist', 'request read root dir'];\n  const token = yield select(getToken);\n\n  if (!token) {\n    return;\n  }\n\n  try {\n    const {\n      callQuery,\n      queries\n    } = getApi(\"UserAssets\");\n    let response = yield callQuery(queries.loadRootContentQl, token);\n\n    if (response.errors) {\n      throw new Error('Server response contains errors ' + errorParser(response.errors));\n    }\n\n    const isRoot = true;\n    yield put(pushDirContent(response.data.root, isRoot));\n    yield put(pushLog(new Log(\"Root dir readed from database\", path)));\n  } catch (error) {\n    yield put(pushLog(Log.Error(path, \"Can't read root dir\" + error.message, \"Sorry. During process reding root directory occurred a problem\", error)));\n  }\n}","map":{"version":3,"sources":["D:/PROJEKTY/APKI/dj-truck/src/sagas/playlists/reqRootDirSaga.js"],"names":["put","select","takeEvery","ACTIONS","pushDirContent","pushLog","getApi","Log","rootDirRequestSaga","PL_ROOT_REQUEST","callApi","getToken","state","user","token","path","callQuery","queries","response","loadRootContentQl","errors","Error","errorParser","isRoot","data","root","error","message"],"mappings":"AAAA,SAASA,GAAT,EAAcC,MAAd,EAAsBC,SAAtB,QAAuC,oBAAvC;AACA,SAASC,OAAT,EAAkBC,cAAlB,EAAkCC,OAAlC,QAAiD,eAAjD;AACA,SAASC,MAAT,QAAuB,0BAAvB;AACA,SAASC,GAAT,QAAoB,6BAApB;AAGA,eAAe,UAAUC,kBAAV,GAA+B;AAC1C,QAAMN,SAAS,CAACC,OAAO,CAACM,eAAT,EAA0BC,OAA1B,CAAf;AACH;;AAED,MAAMC,QAAQ,GAAGC,KAAK,IAAIA,KAAK,CAACC,IAAN,CAAWC,KAArC;;AAEA,UAAUJ,OAAV,GAAoB;AAChB,QAAMK,IAAI,GAAG,CAAC,MAAD,EAAS,UAAT,EAAqB,uBAArB,CAAb;AACA,QAAMD,KAAK,GAAG,MAAMb,MAAM,CAACU,QAAD,CAA1B;;AACA,MAAI,CAACG,KAAL,EAAY;AACR;AACH;;AACD,MAAI;AACA,UAAM;AAAEE,MAAAA,SAAF;AAAaC,MAAAA;AAAb,QAAyBX,MAAM,CAAC,YAAD,CAArC;AACA,QAAIY,QAAQ,GAAG,MAAMF,SAAS,CAACC,OAAO,CAACE,iBAAT,EAA4BL,KAA5B,CAA9B;;AAEA,QAAGI,QAAQ,CAACE,MAAZ,EAAmB;AACf,YAAM,IAAIC,KAAJ,CAAU,qCAAoCC,WAAW,CAACJ,QAAQ,CAACE,MAAV,CAAzD,CAAN;AACH;;AAED,UAAMG,MAAM,GAAG,IAAf;AACA,UAAMvB,GAAG,CAACI,cAAc,CAACc,QAAQ,CAACM,IAAT,CAAcC,IAAf,EAAqBF,MAArB,CAAf,CAAT;AAEA,UAAMvB,GAAG,CAACK,OAAO,CAAC,IAAIE,GAAJ,CAAQ,+BAAR,EAAyCQ,IAAzC,CAAD,CAAR,CAAT;AACH,GAZD,CAYE,OAAOW,KAAP,EAAc;AACZ,UAAM1B,GAAG,CAACK,OAAO,CAACE,GAAG,CAACc,KAAJ,CACdN,IADc,EAEd,wBAAwBW,KAAK,CAACC,OAFhB,EAGd,gEAHc,EAIdD,KAJc,CAAD,CAAR,CAAT;AAMH;AAEJ","sourcesContent":["import { put, select, takeEvery } from \"redux-saga/effects\";\r\nimport { ACTIONS, pushDirContent, pushLog } from \"../../actions\";\r\nimport { getApi } from \"./../../apis/apiProvider\";\r\nimport { Log } from \"./../../utils/logger/logger\";\r\n\r\n\r\nexport default function* rootDirRequestSaga() {\r\n    yield takeEvery(ACTIONS.PL_ROOT_REQUEST, callApi)\r\n}\r\n\r\nconst getToken = state => state.user.token;\r\n\r\nfunction* callApi() {\r\n    const path = ['saga', 'playlist', 'request read root dir']\r\n    const token = yield select(getToken);\r\n    if (!token) {\r\n        return;\r\n    }\r\n    try {\r\n        const { callQuery, queries } = getApi(\"UserAssets\");\r\n        let response = yield callQuery(queries.loadRootContentQl, token);\r\n\r\n        if(response.errors){\r\n            throw new Error('Server response contains errors '+ errorParser(response.errors))\r\n        }\r\n        \r\n        const isRoot = true;\r\n        yield put(pushDirContent(response.data.root, isRoot));\r\n\r\n        yield put(pushLog(new Log(\"Root dir readed from database\", path)))\r\n    } catch (error) {\r\n        yield put(pushLog(Log.Error(\r\n            path,\r\n            \"Can't read root dir\" + error.message,\r\n            \"Sorry. During process reding root directory occurred a problem\",\r\n            error\r\n        )))\r\n    }\r\n\r\n}\r\n\r\n"]},"metadata":{},"sourceType":"module"}