{"ast":null,"code":"import _classCallCheck from\"D:\\\\PROJEKTY\\\\APKI\\\\dj-truck\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"D:\\\\PROJEKTY\\\\APKI\\\\dj-truck\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"D:\\\\PROJEKTY\\\\APKI\\\\dj-truck\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"D:\\\\PROJEKTY\\\\APKI\\\\dj-truck\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";import _inherits from\"D:\\\\PROJEKTY\\\\APKI\\\\dj-truck\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import classNames from\"classnames\";import React,{Fragment}from\"react\";import{Col,Container,Row}from\"react-bootstrap\";import{connect}from\"react-redux\";import LoadingBar from'react-redux-loading-bar';import{toRange}from\"./../../../../utils/math/argRanges\";import\"./header.scss\";import NavBar from\"./NavBar/NabBar\";var Header=/*#__PURE__*/function(_React$Component){_inherits(Header,_React$Component);function Header(){var _this;_classCallCheck(this,Header);_this=_possibleConstructorReturn(this,_getPrototypeOf(Header).call(this));_this.barState={barElement:React.createRef(null),barElementHeight:0,translateY:0,shiftTranslateY:0,stickiState:false};_this.scrollState={prevScrollDirection:null,// \"up\" or \"down\",\nprevScrollPosition:0,snapPosition:null};return _this;}_createClass(Header,[{key:\"startWatching\",value:function startWatching(){window.addEventListener('scroll',this.scrollWatching.bind(this));}},{key:\"stopWatching\",value:function stopWatching(){window.removeEventListener('scroll',this.scrollWatching.bind(this));}},{key:\"scrollWatching\",value:function scrollWatching(_){var setTranslate=setTranslateFun.bind(this);var changeStickiClass=changeStickiClassFun.bind(this);var scrollDirection=window.scrollY-this.scrollState.prevScrollPosition<0?\"up\":\"down\";if(scrollDirection!==this.scrollState.prevScrollDirection){this.scrollState.snapPosition=window.scrollY;this.barState.shiftTranslateY=this.barState.translateY;// \nif(scrollDirection===\"up\"&&window.scrollY>this.barState.barElementHeight){changeStickiClass(\"add\");// this has to be set afater refreshing so is added simply flag that is used only in this place\nif(!this.firstFlag){this.barState.shiftTranslateY=-this.barState.barElementHeight;this.firstFlag=true;}}}this.scrollState.prevScrollPosition=window.scrollY;this.scrollState.prevScrollDirection=scrollDirection;if(window.scrollY===0){//  console.log(\"set on int\")\nsetTranslate(0);}else if(this.barState.stickiState){if(scrollDirection===\"up\"){var y=this.scrollState.snapPosition-window.scrollY+this.barState.shiftTranslateY;setTranslate(y);}else if(scrollDirection===\"down\"){var _y=window.scrollY-this.scrollState.snapPosition-this.barState.shiftTranslateY;if(_y<1.5*this.barState.barElementHeight){setTranslate(-_y);}else{changeStickiClass(\"remove\");}}}function setTranslateFun(tY){changeStickiClassFun.call(this,\"add\");tY=toRange(tY,-this.barState.barElementHeight,0);this.barState.barElement.current.style.transform=\"translateY(\".concat(tY,\"px)\");this.barState.translateY=tY;}function changeStickiClassFun(action){if(action===\"add\"){this.barState.barElement.current.classList.add(\"bar--sticki\");this.barState.stickiState=true;}else if(action===\"remove\"){this.barState.barElement.current.classList.remove(\"bar--sticki\");this.barState.stickiState=false;}}}},{key:\"updateState\",value:function updateState(prevProps){if(this.props.sticki){this.startWatching();}else{this.stopWatching();}}},{key:\"componentDidMount\",value:function componentDidMount(){this.updateState();this.barState.barElementHeight=this.barState.barElement.current.getBoundingClientRect().height;}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps){this.updateState(prevProps);}},{key:\"render\",value:function render(){return React.createElement(Fragment,null,React.createElement(LoadingBar,{className:\"loading-bar\"}),React.createElement(\"header\",{className:classNames(\"top-bar\",{\"bar--hidden\":this.props.hidden,\"bar--dissabled\":this.props.dissabled}),ref:this.barState.barElement},React.createElement(Container,{className:\"app layout container-xl\"},React.createElement(Row,null,React.createElement(Col,null,React.createElement(NavBar,{className:\"navigation-bar\"}))))));}}]);return Header;}(React.Component);var mapStateToProps=function mapStateToProps(state){return{sticki:state.layout.header.sticki,hidden:state.layout.header.hidden,disabled:state.layout.header.disabled};};export default connect(mapStateToProps)(Header);","map":{"version":3,"sources":["D:/PROJEKTY/APKI/dj-truck/src/pages/common/Layout/Header/Header.js"],"names":["classNames","React","Fragment","Col","Container","Row","connect","LoadingBar","toRange","NavBar","Header","barState","barElement","createRef","barElementHeight","translateY","shiftTranslateY","stickiState","scrollState","prevScrollDirection","prevScrollPosition","snapPosition","window","addEventListener","scrollWatching","bind","removeEventListener","_","setTranslate","setTranslateFun","changeStickiClass","changeStickiClassFun","scrollDirection","scrollY","firstFlag","y","tY","call","current","style","transform","action","classList","add","remove","prevProps","props","sticki","startWatching","stopWatching","updateState","getBoundingClientRect","height","hidden","dissabled","Component","mapStateToProps","state","layout","header","disabled"],"mappings":"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","sourcesContent":["import classNames from \"classnames\";\r\nimport React, { Fragment } from \"react\";\r\nimport { Col, Container, Row } from \"react-bootstrap\";\r\nimport { connect } from \"react-redux\";\r\nimport LoadingBar from 'react-redux-loading-bar';\r\nimport { toRange } from \"./../../../../utils/math/argRanges\";\r\nimport \"./header.scss\";\r\nimport NavBar from \"./NavBar/NabBar\";\r\n\r\nclass Header extends React.Component {\r\n  constructor() {\r\n    super();\r\n\r\n    this.barState = {\r\n      barElement: React.createRef(null),\r\n      barElementHeight: 0,\r\n      translateY: 0,\r\n      shiftTranslateY: 0,\r\n      stickiState: false,\r\n    }\r\n    this.scrollState = {\r\n      prevScrollDirection: null, // \"up\" or \"down\",\r\n      prevScrollPosition: 0,\r\n      snapPosition: null,\r\n    }\r\n  }\r\n\r\n  startWatching() {\r\n    window.addEventListener('scroll', this.scrollWatching.bind(this))\r\n  }\r\n\r\n  stopWatching() {\r\n    window.removeEventListener('scroll', this.scrollWatching.bind(this))\r\n  }\r\n\r\n  scrollWatching(_) {\r\n    const setTranslate = setTranslateFun.bind(this);\r\n    const changeStickiClass = changeStickiClassFun.bind(this)\r\n\r\n    const scrollDirection =\r\n      (window.scrollY - this.scrollState.prevScrollPosition < 0) ? \"up\" : \"down\";\r\n\r\n    if (scrollDirection !== this.scrollState.prevScrollDirection) {\r\n      this.scrollState.snapPosition = window.scrollY;\r\n      this.barState.shiftTranslateY = this.barState.translateY;\r\n      // \r\n      if ((scrollDirection === \"up\") && (window.scrollY > this.barState.barElementHeight)) {\r\n        changeStickiClass(\"add\");\r\n        // this has to be set afater refreshing so is added simply flag that is used only in this place\r\n        if(!this.firstFlag){\r\n          this.barState.shiftTranslateY = -this.barState.barElementHeight;\r\n          this.firstFlag = true;\r\n        }\r\n      }\r\n    }\r\n\r\n    this.scrollState.prevScrollPosition = window.scrollY;\r\n    this.scrollState.prevScrollDirection = scrollDirection;\r\n\r\n    if (window.scrollY === 0) {\r\n    //  console.log(\"set on int\")\r\n      setTranslate(0);\r\n    } else if (this.barState.stickiState) {\r\n      if (scrollDirection === \"up\") {\r\n        let y = this.scrollState.snapPosition - window.scrollY + this.barState.shiftTranslateY;\r\n        setTranslate(y);\r\n      } else if (scrollDirection === \"down\") {\r\n        let y = window.scrollY - this.scrollState.snapPosition - this.barState.shiftTranslateY;\r\n        if (y < 1.5 * this.barState.barElementHeight) {\r\n          setTranslate(-y);\r\n        } else {\r\n          changeStickiClass(\"remove\");\r\n        }\r\n      }\r\n    }\r\n\r\n\r\n\r\n    function setTranslateFun(tY) {\r\n      changeStickiClassFun.call(this, \"add\")\r\n      tY = toRange(tY, -this.barState.barElementHeight, 0);\r\n      this.barState.barElement.current.style.transform = `translateY(${tY}px)`;\r\n      this.barState.translateY = tY;\r\n    }\r\n    function changeStickiClassFun(action) {\r\n      if (action === \"add\") {\r\n        this.barState.barElement.current.classList.add(\"bar--sticki\");\r\n        this.barState.stickiState = true;\r\n      } else if (action === \"remove\") {\r\n        this.barState.barElement.current.classList.remove(\"bar--sticki\");\r\n        this.barState.stickiState = false;\r\n      }\r\n    }\r\n  }\r\n\r\n  updateState(prevProps) {\r\n    if (this.props.sticki) {\r\n      this.startWatching();\r\n    } else {\r\n      this.stopWatching();\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.updateState();\r\n    this.barState.barElementHeight =\r\n      this.barState.barElement.current.getBoundingClientRect().height;\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    this.updateState(prevProps);\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Fragment>\r\n        <LoadingBar className=\"loading-bar\" />\r\n        <header\r\n          className={classNames(\"top-bar\", {\r\n            \"bar--hidden\": this.props.hidden,\r\n            \"bar--dissabled\": this.props.dissabled\r\n          })}\r\n          ref={this.barState.barElement}>\r\n          <Container className=\"app layout container-xl\" >\r\n            <Row>\r\n              <Col>\r\n                <NavBar className=\"navigation-bar\" />\r\n              </Col>\r\n            </Row>\r\n          </Container>\r\n        </header>\r\n      </Fragment>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n  sticki: state.layout.header.sticki,\r\n  hidden: state.layout.header.hidden,\r\n  disabled: state.layout.header.disabled,\r\n})\r\n\r\nexport default connect(mapStateToProps)(Header);"]},"metadata":{},"sourceType":"module"}